<template>
  <require from="./dashboard.css"></require>
  <require from="../components/webdavfilepanel"></require>
  <require from="../components/fileeditor"></require>
  <h3>Repository Dashboard</h3>
  <p>You are logged as visiting scientist.
    You can view your datasets available after your visit.
    To review Visit Proposal, go to Instruct <a target="_blank"
                                                href="https://www.structuralbiology.eu/dashboard?t=instruct"
                                                class="w3-button w3-round-small w3-small">Dashboard</a>
    To submit new proposal, go to Instruct
    <a target="_blank" href="https://www.structuralbiology.eu/submit-proposal/step1/new"
       class="w3-button  w3-round-small w3-small">Submission</a>.
  </p>


    <h4>Select<span show.bind="! showProposals">ed</span> project visit/proposal:</h4>

    <table class="w3-table-all">
      <tr>
        <th>id</th>
        <th>name</th>
        <th>summary</th>
      </tr>
      <tr show.bind="showProposals" class="au-animate" repeat.for="project of projects">
        <td>${project.id}</td>
        <td><a class="w3-hover-green" route-href="route: projectdetail; params.bind: {projectid:project.id}">${project.projectName}</a>
        </td>
        <td>${project.summary} (${project.datasets})</td>
      </tr>
      <tr show.bind="! showProposals" title="click to show all projects" class="w3-hover-green">
        <td>${selectedProject.id}</td>
        <td ><a class="w3-hover-green" route-href="route: dashboard">
          ${selectedProject.projectName}
        </td>
        <td>${selectedProject.summary}</td>
      </tr>
    </table>
    <h4>Select<span show.bind="! showDatasets">ed</span> dataset to narrow files:</h4>

      <table class="w3-table-all">
        <thead>
        <tr>
          <th>date</th>
          <th>Summary</th>
          <th>i</th>
        </tr>
        </thead>
        <tbody>
        <tr show.bind="showDatasets" class="w3-hover-green" repeat.for="item of alldatasets">
          <td>${item.date}</td>
          <td><a class="w3-hover-green" route-href="route: datasetdetail; params.bind: {datasetid:item.id}">${item.summary}</a></td>
          <td>${item.info}</td>
          <td>${item.projectId}</td>
        </tr>
        <tr if.bind="! showDatasets" class="w3-hover-green">
          <td>${selectedDataset.date}</td>
          <td>${selectedDataset.summary}</td>
          <td>${selectedDataset.info}</td>
          <td>${selectedDataset.projectId}</td>
        </tr>
        </tbody>
      </table>

    <h4>Files:</h4>
    <div show.bind="! showDatasets" class="w3-half">
      <webdavfilepanel></webdavfilepanel>
    </div>
    <div show.bind="! showDatasets" class="w3-half">
      <div class="w3-margin-left">
        <fileeditor></fileeditor>
      </div>
    </div>

  <p>&nbsp;</p>
</template>
