{"version":3,"sources":["app.js","environment.js","main.js","repositoryapp.js","repositorymain.js","staffapp.js","staffmain.js","components/ariaapi.js","components/ariaapixhr.js","components/csrfheaderinterceptor.js","components/datasettable.js","components/fileeditor.js","components/htable.js","components/importaria.js","components/messages.js","components/nmrapi.js","components/projectapi.js","components/projecttable.js","components/searchbydate.js","components/staffuserinfo.js","components/userinfo.js","components/webdavfilepanel.js","pickerclient/pickerclient.js","resources/icopy.js","resources/index.js","resources/iupload.js","scientist/createdataset.js","scientist/dashboard.js","scientist/dashboarddetail.js","scientist/datasetdetail.js","scientist/projectdetail.js","scientist/repositorytovf.js","staff/dashboard.js","staff/dataupload.js","staff/repositorystaff.js","staff/upconfirm.js","staff/upselectdata.js","staff/upselectdataset.js","staff/upselectuser.js"],"names":["App","configureRouter","config","router","title","login","debug","testing","configure","Promise","warnings","wForgottenReturn","aurelia","use","standardConfiguration","feature","start","then","setRoot","Repositoryapp","map","route","name","moduleId","nav","Staffapp","Ariaapi","httpclient","rejectErrorResponses","withDefaults","credentials","headers","proposallisturl","proposalurl","accesstokenserviceurl","accesstoken","attached","console","log","created","getProposal","fetch","response","json","proposal","data","catch","error","getAriaLink","getAccessToken","code","state","getProposalList","access_token","method","body","aria_response_format","proposallist","inject","pid","get","JSON","parse","proposallistwrapper","proposals","Csrfheaderinterceptor","TOKEN_HEADER","latestCsrfToken","has","request","indexOf","add","Datasettable","pa","ea","alldatasets","subscribe","filterSelectedDataset","msg","id","filterProjectDatasets","addDataset","dataset","selectedDatasetId","selectedProjectId","bind","userid","getDatasets","datasets","getSelectedDataset","filterProjectDatasets2","selectDataset","selectedDataset","publish","deselectDataset","projectId","filter","i","length","setSelectedProject","dataseturl","webdavurl","deleteDataset","e","splice","push","CodeMirror","Fileeditor","nmrapi","client","selectFile","file","isimage","filename","showtable","codemirror","fromTextArea","cmTextarea","lineNumbers","mode","lineWrapping","refresh","ht2","Handsontable","filetable","rowHeaders","colHeaders","autoWrapRow","stretchH","autoResizeColumn","that","imageurl","endsWith","response2","clone","blob","bindata","convert","data2","text","setValue","alert","table","window","setTimeout","render","htable","ht","idtable","Importaria","ariaapi","ariaurl","showspinner","linkdata","url","Webdavresource","Editfile","Uploaddir","Selectedproject","project","FilterProject","FilterDatasetByProject","FilterDataset","FilterProjectByDataset","Selecteddataset","Preselecteddataset","datasetid","Preselecteddatasets","Adddataset","Addproject","Nmrapi","handsontable","arrayBuffer","fileReader","FileReader","addEventListener","uint8Array","Uint8Array","result","indexbindata","uint82","raw","Float32Array","buffer","ri","updateSettings","readAsArrayBuffer","ProjectApi","apiurl","projecturl","dataurl","copytaskurl","userinfourl","staffuserinfourl","usersurl","projects","withBaseUrl","selecttedDataset","authurl","apiavailable","location","pathname","startsWith","statusText","filestoupload","selectedUser","getUserProjects","getProjects","Id","userprojecturl","resolve","getSelectedProject","getUserDatasets","userdataurl","setSelectedDataset","submitDataset","submitProject","getUsers","getUserInfo","reject","getStaffUserInfo","copytask","src","dest","sourceurl","Projecttable","selectedProject","filterSelectedProposal","addProposal","selectProject","deselectProject","pr","unshift","Searchbydate","Staffuserinfo","projectapi","showuserinfo","userinfo","Userinfo","Webdavfilepanel","setwebdav","webdavpath","dirs","files","atached","DOMParser","parseFromString","str","filesDOM","getElementsByTagName","fileitem","getFirstElementByTagName","filedate","filesize","filetype","item","replace","date","nicedate","formatdate","Date","isdir","size","nicesize","type","tag","elements","textContent","newdir","pop","diff","sec","Math","floor","min","d","getDate","getMonth","getFullYear","getHours","getMinutes","component","slice","join","Pickerclient","href","href2","vfurl","th2","receiveMessage","filepicker","detached","removeEventListener","openfilewindow","popup","open","opendirwindow","Icopy","port","hrefid","value","protocol","hostname","copyclipboard","inputElement","select","document","execCommand","globalResources","Iupload","uploadhref","event","hreffull","dettached","openwindow","uploadtovf","Createdataset","datasetname","datasetinfo","datasetsummary","datasetprojectid","submitted","submit","info","summary","submitteditem","generate","random","getParams","query","test","split","reduce","params","param","key","decodeURIComponent","Dashboard","importingaria","importariastatus","importariaerror","selectedProposal","search","substring","accessToken","error_description","list","selectProposal","p","detail","selectedFields","Object","keys","fields","sort","a","b","isNaN","importProposal","projectName","shareable","Dashboarddetail","activate","routeConfig","navigationInstruction","projectid","filterProject","filterDataset","Datasetdetail","deselectProposal","Projectdetail","Repositorytovf","uploadfiles","uploaddir","selectingfiles","setuploaddir","copyinprogress","selectedUploadDir","selectitem","submitfiles","unsubmitfiles","deleteitem","indexremoved","selectItemToUpload","removeItemToUpload","dropped","dataTransfer","stopPropagation","preventDefault","dragged","appendFiles","target","appendDir","submitUpload","copy","Dataupload","Repositorystaff","visitors","selectinguser","selectedvisitor","selectvisitor","visitor","deselectvisitor","Upconfirm","status","uploadFiles","Upselectdata","filesuploaded","Upselectdataset","ro","navigate","Upselectuser","selectUser","user"],"mappings":";;;;;;;;;;;;;MAAaA,cAAAA;;;;;kBAEXC,2CAAgBC,QAAQC,QAAQ;AAC9BD,aAAOE,KAAP,GAAe,6BAAf;AACD;;kBAEDC,yBAAQ,CAEP;;;;;;;;;;;oBCRY;AACbC,WAAO,IADM;AAEbC,aAAS;AAFI;;;;;;;;UCOCC,YAAAA;;AANhBC,UAAQP,MAAR,CAAe;AACbQ,cAAU;AACRC,wBAAkB;AADV;AADG,GAAf;;AAMO,WAASH,SAAT,CAAmBI,OAAnB,EAA4B;AACjCA,YAAQC,GAAR,CACGC,qBADH,GAEGC,OAFH,CAEW,WAFX;AAGAH,YAAQI,KAAR,GAAgBC,IAAhB,CAAqB;AAAA,aAAML,QAAQM,OAAR,EAAN;AAAA,KAArB;AAEC;;;;;;;;;;;;;;;MCbUC,wBAAAA;;;;;4BAEXlB,2CAAgBC,QAAQC,QAAQ;AAC9BD,aAAOE,KAAP,GAAe,6BAAf;;AAEAF,aAAOkB,GAAP,CAAW,CACT,EAACC,OAAO,CAAC,EAAD,EAAK,WAAL,CAAR,EAA2BC,MAAM,WAAjC,EAA8CC,UAAU,qBAAxD,EAA+EC,KAAK,IAApF,EAA0FpB,OAAO,mBAAjG,EADS,EAET,EAACiB,OAAO,+BAAR,EAAyCC,MAAM,eAA/C,EAAgEC,UAAU,2BAA1E,EAFS,EAGT,EAACF,OAAO,+BAAR,EAAyCC,MAAM,eAA/C,EAAgEC,UAAU,2BAA1E,EAHS,EAIT,EAACF,OAAO,eAAR,EAAyBC,MAAM,eAA/B,EAAgDC,UAAU,yBAA1D,EAAqFC,KAAK,IAA1F,EAAgGpB,OAAO,sBAAvG,EAJS,EAKT,EAACiB,OAAO,gBAAR,EAA0BC,MAAM,gBAAhC,EAAkDC,UAAU,0BAA5D,EAAwFC,KAAK,IAA7F,EAAmGpB,OAAO,0BAA1G,EALS,CAAX;AAOA,WAAKD,MAAL,GAAcA,MAAd;AACD;;4BAEDE,yBAAQ,CAEP;;;;;;;;;;;UCVaG,YAAAA;;AANhBC,UAAQP,MAAR,CAAe;AACbQ,cAAU;AACRC,wBAAkB;AADV;AADG,GAAf;;AAMO,WAASH,SAAT,CAAmBI,OAAnB,EAA4B;AACjCA,YAAQC,GAAR,CACGC,qBADH,GAEGC,OAFH,CAEW,WAFX;AAGAH,YAAQI,KAAR,GAAgBC,IAAhB,CAAqB;AAAA,aAAML,QAAQM,OAAR,CAAgB,eAAhB,CAAN;AAAA,KAArB;AACD;;;;;;;;;;;;;;;MCZYO,mBAAAA;;;;;uBAEXxB,2CAAgBC,QAAQC,QAAQ;AAC9BD,aAAOE,KAAP,GAAe,6BAAf;AACAF,aAAOkB,GAAP,CAAW,CACT,EAACC,OAAO,CAAC,EAAD,EAAK,WAAL,CAAR,EAA2BC,MAAM,WAAjC,EAA8CC,UAAU,iBAAxD,EAA2EC,KAAK,IAAhF,EAAsFpB,OAAO,iBAA7F,EADS,EAET,EAACiB,OAAO,cAAR,EAAwBC,MAAM,cAA9B,EAA8CC,UAAU,oBAAxD,EAA8EC,KAAK,IAAnF,EAAyFpB,OAAO,8BAAhG,EAFS,EAGT,EAACiB,OAAO,iBAAR,EAA2BC,MAAM,iBAAjC,EAAoDC,UAAU,uBAA9D,EAAuFC,KAAK,IAA5F,EAAkGpB,OAAO,uCAAzG,EAHS,EAIT,EAACiB,OAAO,cAAR,EAAwBC,MAAM,cAA9B,EAA8CC,UAAU,oBAAxD,EAA8EC,KAAK,IAAnF,EAAyFpB,OAAO,sBAAhG,EAJS,EAKT,EAACiB,OAAO,WAAR,EAAqBC,MAAM,WAA3B,EAAwCC,UAAU,iBAAlD,EAAqEC,KAAK,IAA1E,EAAgFpB,OAAO,uBAAvF,EALS,CAAX;AAOA,WAAKD,MAAL,GAAcA,MAAd;AAED;;;;;;;;;;;UCPaK,YAAAA;AANhBC,UAAQP,MAAR,CAAe;AACbQ,cAAU;AACRC,wBAAkB;AADV;AADG,GAAf;;AAMO,WAASH,SAAT,CAAmBI,OAAnB,EAA4B;AACjCA,YAAQC,GAAR,CACGC,qBADH,GAEGC,OAFH,CAEW,WAFX;AAGAH,YAAQI,KAAR,GAAgBC,IAAhB,CAAqB;AAAA,aAAML,QAAQM,OAAR,CAAgB,UAAhB,CAAN;AAAA,KAArB;AACD;;;;;;;;;;;;;;;;;;MCPYQ,kBAAAA;AAGX,qBAAYC,UAAZ,EAAwB;AAAA;;AACtB,WAAKA,UAAL,GAAgBA,UAAhB;AACA,WAAKA,UAAL,CAAgBnB,SAAhB,CAA0B,kBAAU;AAClCN,eACG0B,oBADH,GAEGC,YAFH,CAEgB;AACZC,uBAAa,aADD;AAEZC,mBAAS;;AAEP,sBAAU,kBAFH;AAGP,4BAAgB;AAHT;AAFG,SAFhB;AAUD,OAXD;;AAaA,WAAKC,eAAL,GAAuB,wDAAvB;AACA,WAAKC,WAAL,GAAmB,oDAAnB;AACA,WAAKC,qBAAL,GAA2B,2BAA3B;AACA,WAAKC,WAAL,GAAiB,IAAjB;AACD;;sBAEDC,+BAAW;AACTC,cAAQC,GAAR,CAAY,oBAAZ;AACD;;sBAEDC,6BAAU;AACRF,cAAQC,GAAR,CAAY,mBAAZ;AACD;;sBAEDE,qCAAc;AAAA;;AACV,aAAO,KAAKb,UAAL,CAAgBc,KAAhB,CAAsB,KAAKR,WAA3B,EACJhB,IADI,CACC;AAAA,eAAYyB,SAASC,IAAT,EAAZ;AAAA,OADD,EAEJ1B,IAFI,CAEC,gBAAQ;AACZ,cAAK2B,QAAL,GAAcC,IAAd;AACA,eAAOA,IAAP;AACD,OALI,EAMJC,KANI,CAME,iBAAS;AACdT,gBAAQC,GAAR,CAAYS,KAAZ;AACD,OARI,CAAP;AASH;;sBAEDC,qCAAc;AACZ,aAAO,KAAKrB,UAAL,CAAgBc,KAAhB,CAAsB,KAAKP,qBAA3B,EACJjB,IADI,CACC;AAAA,eAAYyB,SAASC,IAAT,EAAZ;AAAA,OADD,EAEJ1B,IAFI,CAEC,gBAAQ;AACZ,eAAO4B,IAAP;AACD,OAJI,EAKJC,KALI,CAKE,iBAAS;AACdT,gBAAQC,GAAR,CAAYS,KAAZ;AACD,OAPI,CAAP;AAQD;;sBAEDE,yCAAeC,MAAKC,OAAM;AAAA;;AACxBd,cAAQC,GAAR,CAAY,0BAAZ;AACA,aAAO,KAAKX,UAAL,CAAgBc,KAAhB,CAAsB,KAAKP,qBAAL,GAA2B,QAA3B,GAAoCgB,IAApC,GAAyC,SAAzC,GAAmDC,KAAzE,EACJlC,IADI,CACC;AAAA,eAAYyB,SAASC,IAAT,EAAZ;AAAA,OADD,EAEJ1B,IAFI,CAEC,gBAAQ;AACZoB,gBAAQC,GAAR,CAAY,oCAAZ;AACAD,gBAAQC,GAAR,CAAYO,IAAZ;AACA,eAAKV,WAAL,GAAiBU,IAAjB;AACA,eAAOA,IAAP;AACD,OAPI,EAQJC,KARI,CAQE,iBAAS;AACdT,gBAAQC,GAAR,CAAYS,KAAZ;AACD,OAVI,CAAP;AAWD;;sBAEDK,6CAAkB;AAAA;;AAChB,UAAI,KAAKjB,WAAL,IAAoB,KAAKA,WAAL,CAAiBkB,YAAzC,EAAuD;AACrD,eAAO,KAAK1B,UAAL,CAAgBc,KAAhB,CAAuB,KAAKT,eAA5B,EAA4C;AAC/CsB,kBAAO,MADwC;AAE/CC,gBAAK,8BAAK,EAACF,cAAa,KAAKlB,WAAL,CAAiBkB,YAA/B,EAA4CG,sBAAqB,MAAjE,EAAL;AAF0C,SAA5C,EAIFvC,IAJE,CAIG;AAAA,iBAAYyB,SAASC,IAAT,EAAZ;AAAA,SAJH,EAKF1B,IALE,CAKG,gBAAQ;AACZ,iBAAKwC,YAAL,GAAmBZ,IAAnB;AACA,iBAAOA,IAAP;AACD,SARE,EASFC,KATE,CASI,iBAAS;AACdT,kBAAQC,GAAR,CAAYS,KAAZ;AACD,SAXE,CAAP;AAYC;AAEJ;;;cArFMW,SAAS;;;;;;;;;;;;;;;;;;MCDLhC,kBAAAA;AAGX,qBAAYC,UAAZ,EAAwB;AAAA;;AACtB,WAAKA,UAAL,GAAgBA,UAAhB;;AAOA,WAAKK,eAAL,GAAuB,wDAAvB;AACA,WAAKC,WAAL,GAAmB,oDAAnB;AACA,WAAKC,qBAAL,GAA2B,2BAA3B;AACA,WAAKC,WAAL,GAAiB,IAAjB;AACD;;sBAEDC,+BAAW;AACTC,cAAQC,GAAR,CAAY,oBAAZ;AACD;;sBAEDC,6BAAU;AACRF,cAAQC,GAAR,CAAY,mBAAZ;AACD;;sBAEDE,mCAAYmB,KAAK;AAAA;;AAEb,aAAO,KAAKhC,UAAL,CAAgBiC,GAAhB,CAAoB,KAAK3B,WAAL,GAAiB,gBAAjB,GAAkC,KAAKE,WAAL,CAAiBkB,YAAnD,GAAgE,+BAAhE,GAAgGM,GAApH,EAEJ1C,IAFI,CAEC,gBAAQ;AACZoB,gBAAQC,GAAR,CAAY,0BAAZ;AACAD,gBAAQC,GAAR,CAAYO,IAAZ;AACA,cAAKD,QAAL,GAAciB,KAAKC,KAAL,CAAWjB,KAAKH,QAAhB,CAAd;AACA,eAAO,MAAKE,QAAZ;AACD,OAPI,EAQJE,KARI,CAQE,iBAAS;AACdT,gBAAQC,GAAR,CAAYS,KAAZ;AACD,OAVI,CAAP;AAWH;;sBAEDC,qCAAc;AASZ,aAAO,KAAKrB,UAAL,CAAgBiC,GAAhB,CAAoB,KAAK1B,qBAAzB,EAAgDjB,IAAhD,CAAqD,gBAC5D;AACEoB,gBAAQC,GAAR,CAAY,eAAZ;AACAD,gBAAQC,GAAR,CAAYO,IAAZ;AACA,eAAOgB,KAAKC,KAAL,CAAWjB,KAAKH,QAAhB,CAAP;AACD,OALM,CAAP;AAOD;;sBAEDO,yCAAeC,MAAKC,OAAM;AAAA;;AACxBd,cAAQC,GAAR,CAAY,0BAAZ;;AAEA,aAAO,KAAKX,UAAL,CAAgBiC,GAAhB,CAAoB,KAAK1B,qBAAL,GAA2B,QAA3B,GAAoCgB,IAApC,GAAyC,SAAzC,GAAmDC,KAAvE,EACJlC,IADI,CACC,gBAAQ;AACZoB,gBAAQC,GAAR,CAAY,oCAAZ;AACAD,gBAAQC,GAAR,CAAYO,IAAZ;AACA,eAAKV,WAAL,GAAiB0B,KAAKC,KAAL,CAAWjB,KAAKH,QAAhB,CAAjB;AACA,eAAO,OAAKP,WAAZ;AACD,OANI,EAOJW,KAPI,CAOE,iBAAS;AACdT,gBAAQC,GAAR,CAAYS,KAAZ;AACD,OATI,CAAP;AAUD;;sBAEDK,6CAAkB;AAAA;;AAChB,UAAI,KAAKjB,WAAL,IAAoB,KAAKA,WAAL,CAAiBkB,YAAzC,EAAuD;AAErD,eAAO,KAAK1B,UAAL,CAAgBiC,GAAhB,CAAqB,KAAK5B,eAAL,GAAqB,gBAArB,GAAsC,KAAKG,WAAL,CAAiBkB,YAA5E,EAEFpC,IAFE,CAEG,gBAAQ;AACZoB,kBAAQC,GAAR,CAAY,8BAAZ;AACAD,kBAAQC,GAAR,CAAYO,IAAZ;AACA,iBAAKkB,mBAAL,GAA0BF,KAAKC,KAAL,CAAWjB,KAAKH,QAAhB,CAA1B;AACA,iBAAO,OAAKqB,mBAAL,CAAyBC,SAAhC;AACD,SAPE,EAQFlB,KARE,CAQI,iBAAS;AACdT,kBAAQC,GAAR,CAAY,oCAAZ;AACAD,kBAAQC,GAAR,CAAYS,KAAZ;AACA,gBAAMA,KAAN;AACD,SAZE,CAAP;AAaC;AAEJ;;;cA1FMW,SAAS;;;;;;;;;;;;;;;;MCHLO;AACX,qCAAc;AAAA;;AACZ,WAAKC,YAAL,GAAoB,cAApB;AACA,WAAKC,eAAL;AACD;;oCACDzB,6BAASA,WAAU;AACjBL,cAAQC,GAAR,CAAY,iCAAZ;AACAD,cAAQC,GAAR,CAAYI,UAASX,OAArB;AACA,UAAIW,UAASX,OAAT,CAAiBqC,GAAjB,CAAqB,KAAKF,YAA1B,CAAJ,EAA6C;AAC3C,aAAKC,eAAL,GAAuBzB,UAASX,OAAT,CAAiB6B,GAAjB,CAAqB,KAAKM,YAA1B,CAAvB;AACD;AACD,aAAOxB,SAAP;AACD;;oCAED2B,2BAAQA,UAAS;AACf,UAAI,KAAKF,eAAT,EAA0B;AACxB9B,gBAAQC,GAAR,CAAY+B,QAAZ;AACAhC,gBAAQC,GAAR,CAAY,KAAK6B,eAAjB;AACA,YAAI,CAAC,MAAD,EAAS,KAAT,EAAgB,OAAhB,EAAyBG,OAAzB,CAAiCD,SAAQf,MAAzC,KAAoD,CAAxD,EAA2D;AACzDe,mBAAQtC,OAAR,CAAgBwC,GAAhB,CAAoB,KAAKL,YAAzB,EAAuC,KAAKC,eAA5C;AACD;AACF;AACD,aAAOE,QAAP;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MCjBUG,uBAAAA;AAIX,0BAAYC,EAAZ,EAAeC,EAAf,EAAmB;AAAA;;AAAA;;AAAA;;AACjB,WAAKD,EAAL,GAAQA,EAAR;AACA,WAAKE,WAAL,GAAmB,EAAnB;;AAEA,WAAKD,EAAL,GAAQA,EAAR;AACA,WAAKA,EAAL,CAAQE,SAAR,0BAAgC;AAAA,eAAM,MAAKC,qBAAL,CAA2BC,IAAIC,EAA/B,CAAN;AAAA,OAAhC;AACA,WAAKL,EAAL,CAAQE,SAAR,mCAAyC;AAAA,eAAM,MAAKI,qBAAL,CAA2BF,IAAIC,EAA/B,CAAN;AAAA,OAAzC;AACA,WAAKL,EAAL,CAAQE,SAAR,uBAA6B;AAAA,eAAM,MAAKK,UAAL,CAAgBH,IAAII,OAApB,CAAN;AAAA,OAA7B;AACA,WAAKC,iBAAL,GAAuB,CAAvB;AACA,WAAKC,iBAAL,GAAuB,CAAvB;AACD;;2BAEDhD,+BAAW;AACTC,cAAQC,GAAR,CAAY,yBAAZ;AACD;;2BAED+C,uBAAO;AAAA;;AACLhD,cAAQC,GAAR,CAAY,qBAAZ,EAAkC,KAAKgD,MAAvC;AACA,WAAKb,EAAL,CAAQc,WAAR,CAAoB,KAAKD,MAAzB,EAAiCrE,IAAjC,CAAsC,gBAAQ;AAC5C,eAAK0D,WAAL,GAAmB9B,IAAnB;AACA,eAAK2C,QAAL,GAAc,OAAKb,WAAnB;AACA,eAAKQ,iBAAL,GAAuB,OAAKV,EAAL,CAAQgB,kBAAR,EAAvB;AACA,YAAI,OAAKN,iBAAL,GAAuB,CAA3B,EAA8B,OAAKN,qBAAL,CAA2B,OAAKM,iBAAhC;AAC9B,YAAI,OAAKC,iBAAL,GAAuB,CAA3B,EAA8B,OAAKM,sBAAL,CAA4B,OAAKN,iBAAjC;AAC/B,OAND;AAOD;;2BAUDO,uCAAcT,SAAQ;AACpB7C,cAAQC,GAAR,CAAY,gCAAZ;AACAD,cAAQC,GAAR,CAAY4C,OAAZ;AACA,WAAKU,eAAL,GAAqBV,OAArB;AACA,WAAKR,EAAL,CAAQmB,OAAR,CAAgB,8BAAoBX,OAApB,CAAhB;;AAEA,aAAO,IAAP;AAED;;2BACDY,6CAAiB;;AAEfzD,cAAQC,GAAR,CAAY,mBAAZ;AACA,WAAK0C,qBAAL,CAA2B,KAAKY,eAAL,CAAqBG,SAAhD;AACA,WAAKrB,EAAL,CAAQmB,OAAR,CAAgB,8BAAoB,IAApB,CAAhB;AACA,aAAO,IAAP;AACD;;2BAGDH,yDAAuBX,IAAI;AAKzB,WAAKa,eAAL,GAAqB,IAArB;AACA,WAAKT,iBAAL,GAAuB,CAAvB;AACA,WAAKC,iBAAL,GAAuBL,EAAvB;AACA,UAAIA,MAAI,CAAR,EAAW;AACT,aAAKS,QAAL,GAAc,KAAKb,WAAnB;AACA;AACD;AACDtC,cAAQC,GAAR,CAAY,sCAAZ;AACAD,cAAQC,GAAR,CAAYyC,EAAZ;AACA1C,cAAQC,GAAR,CAAY,KAAKqC,WAAjB;AACA,WAAKa,QAAL,GAAc,KAAKb,WAAL,CAAiBqB,MAAjB,CAAwB;AAAA,eAAKC,EAAEF,SAAF,IAAehB,EAApB;AAAA,OAAxB,CAAd;AACA1C,cAAQC,GAAR,CAAY,KAAKkD,QAAjB;AACD;;2BAEDR,uDAAsBD,IAAG;AACvB,WAAKW,sBAAL,CAA4BX,EAA5B;AACD;;2BAEDF,uDAAsBE,IAAG;AACvB,WAAKI,iBAAL,GAAuBJ,EAAvB;AACA,UAAIA,MAAI,CAAR,EAAU;AACR,aAAKa,eAAL,GAAqB,IAArB;AACA,aAAKJ,QAAL,GAAc,KAAKb,WAAnB;AACA;AACD;AACD,WAAKa,QAAL,GAAc,KAAKb,WAAL,CAAiBqB,MAAjB,CAAwB;AAAA,eAAKC,EAAElB,EAAF,IAAQA,EAAb;AAAA,OAAxB,CAAd;AACA,UAAI,KAAKS,QAAL,CAAcU,MAAd,GAAqB,CAAzB,EAA2B;AACzB,aAAKN,eAAL,GAAqB,KAAKJ,QAAL,CAAc,CAAd,CAArB;AACA,aAAKf,EAAL,CAAQ0B,kBAAR,CAA2B,KAAKX,QAAL,CAAc,CAAd,EAAiBO,SAA5C;AACA,aAAKrB,EAAL,CAAQmB,OAAR,CAAgB,qCAA2B,KAAKL,QAAL,CAAc,CAAd,EAAiBO,SAA5C,CAAhB;AACA,aAAKtB,EAAL,CAAQ2B,UAAR,GAAmB,KAAKZ,QAAL,CAAc,CAAd,EAAiBa,SAApC;AACA,aAAK3B,EAAL,CAAQmB,OAAR,CAAgB,6BAAmB,KAAKpB,EAAL,CAAQ2B,UAA3B,CAAhB;AACD;AACF;;2BAEDE,yCAAgB;AAAA;;AACd,WAAK7B,EAAL,CAAQ6B,aAAR,CAAsB,KAAKnB,iBAA3B,EACGlE,IADH,CACQ,gBAAQ;AACd,eAAK6E,eAAL;;AAEA,YAAIG,IAAE,OAAKT,QAAL,CAAcpE,GAAd,CAAkB,UAASmF,CAAT,EAAY;AAAC,iBAAOA,EAAExB,EAAT;AAAa,SAA5C,EAA8CT,OAA9C,CAAsDzB,IAAtD,CAAN;AACA,eAAK2C,QAAL,CAAcgB,MAAd,CAAqBP,CAArB,EAAuB,CAAvB;AACAA,YAAE,OAAKtB,WAAL,CAAiBvD,GAAjB,CAAqB,UAASmF,CAAT,EAAY;AAAC,iBAAOA,EAAExB,EAAT;AAAa,SAA/C,EAAiDT,OAAjD,CAAyDzB,IAAzD,CAAF;AACA,eAAK8B,WAAL,CAAiB6B,MAAjB,CAAwBP,CAAxB,EAA0B,CAA1B;AACD,OARD;AASD;;2BAEDhB,iCAAWC,SAAS;AAClB7C,cAAQC,GAAR,CAAY,cAAZ;AACAD,cAAQC,GAAR,CAAY4C,OAAZ;AACA,WAAKM,QAAL,CAAciB,IAAd,CAAmBvB,OAAnB;AACD;;;eAhHMxB,SAAS;;;;;;;;;;;;;MCLNgD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MAeCC,qBAAAA;AAIX,wBAAYjC,EAAZ,EAAe/C,UAAf,EAA0BiF,MAA1B,EAAkC;AAAA;;AAAA;;AAAA;;AAChC,WAAKlC,EAAL,GAAUA,EAAV;AACA,WAAKmC,MAAL,GAAclF,UAAd;AACA,WAAKiF,MAAL,GAAcA,MAAd;AACA,WAAKlC,EAAL,CAAQE,SAAR,qBAA4B;AAAA,eAAO,MAAKkC,UAAL,CAAgBhC,IAAIiC,IAApB,CAAP;AAAA,OAA5B;AACA,WAAKC,OAAL,GAAa,KAAb;AACA,WAAKC,QAAL,GAAc,EAAd;AACA,WAAKC,SAAL,GAAe,KAAf;AACD;;yBAED9E,+BAAW;AACTC,cAAQC,GAAR,CAAY,wBAAZ;AACA,WAAK6E,UAAL,GAAkBT,WAAWU,YAAX,CAAwB,KAAKC,UAA7B,EAAyC;AACzDC,qBAAa,IAD4C;AAEzDC,cAAM,aAFmD;AAGzDC,sBAAc;AAH2C,OAAzC,CAAlB;AAKA,WAAKL,UAAL,CAAgBM,OAAhB;;AAEA,WAAK5E,IAAL,GAAU,CAAC,CAAC,qBAAD,EAAuB,CAAvB,CAAD,EAA2B,CAAC,CAAD,EAAG,CAAH,CAA3B,CAAV;;AAGA,WAAK6E,GAAL,GAAW,IAAIC,YAAJ,CAAkB,KAAKC,SAAvB,EAAkC;AAC3C/E,cAAM,KAAKA,IADgC;AAE3CgF,oBAAY,IAF+B;AAG3CC,oBAAY,CAAC,GAAD,EAAK,GAAL,CAH+B;AAI3CC,qBAAY,IAJ+B;AAK3CC,kBAAU,KALiC;AAM3CC,0BAAkB;;AANyB,OAAlC,CAAX;AASA5F,cAAQC,GAAR,CAAY,KAAKoF,GAAjB;AACD;;yBAEDZ,iCAAWC,MAAM;AACf,UAAImB,OAAM,IAAV;;AAEE,WAAKC,QAAL,GAAgBpB,KAAKV,SAArB;;AAGA,WAAKW,OAAL,GACID,KAAKzF,IAAL,CAAU8G,QAAV,CAAmB,MAAnB,CAAD,IACErB,KAAKzF,IAAL,CAAU8G,QAAV,CAAmB,MAAnB,CADF,IAEErB,KAAKzF,IAAL,CAAU8G,QAAV,CAAmB,MAAnB,CAFF,IAGErB,KAAKzF,IAAL,CAAU8G,QAAV,CAAmB,MAAnB,CAHF,IAIErB,KAAKzF,IAAL,CAAU8G,QAAV,CAAmB,MAAnB,CAJF,IAKErB,KAAKzF,IAAL,CAAU8G,QAAV,CAAmB,MAAnB,CALF,IAMErB,KAAKzF,IAAL,CAAU8G,QAAV,CAAmB,MAAnB,CANF,IAOErB,KAAKzF,IAAL,CAAU8G,QAAV,CAAmB,MAAnB,CAPF,IAQErB,KAAKzF,IAAL,CAAU8G,QAAV,CAAmB,MAAnB,CARF,IASErB,KAAKzF,IAAL,CAAU8G,QAAV,CAAmB,MAAnB,CAVL;;AAgBA,UAAI,CAAC,KAAKpB,OAAV,EAEE,KAAKH,MAAL,CAAYpE,KAAZ,CAAkBsE,KAAKV,SAAvB,EAAkC,EAACvE,aAAa,aAAd,EAA4BC,SAAQ,EAAC,SAAS,cAAV,EAApC,EAAlC,EACGd,IADH,CACQ,oBAAY;AAEhB,YAAIoH,YAAW3F,SAAS4F,KAAT,EAAf;AACA5F,iBAAS6F,IAAT,GAAgBtH,IAAhB,CAAqB,iBAAS;AAC5BiH,eAAKrF,IAAL,GAAU,EAAV;AACA,cAAI2F,UAASN,KAAKtB,MAAL,CAAY6B,OAAZ,CAAoBC,KAApB,EAA0BR,KAAKrF,IAA/B,EAAoCqF,KAAKR,GAAzC,CAAb;AACD,SAHD;AAIEW,kBAAUM,IAAV,GAAiB1H,IAAjB,CAAsB,gBAAQ;AAC5BiH,eAAKf,UAAL,CAAgByB,QAAhB,CAAyB/F,IAAzB;AACAqF,eAAKf,UAAL,CAAgBM,OAAhB;AACAS,eAAKjB,QAAL,GAAgBF,KAAKV,SAArB;AACD,SAJD;AAKD,OAbL,EAcIvD,KAdJ,CAcU,iBAAS;AACjB+F,cAAM,mCAAmC9B,KAAKV,SAA9C;AACAhE,gBAAQC,GAAR,CAAYS,KAAZ;AACD,OAjBD;AAoBL;;yBAED+F,yBAAQ;AACN,WAAK5B,SAAL,GAAgB,CAAE,KAAKA,SAAvB;;AAIA,UAAI,KAAKA,SAAT,EAAoB6B,OAAOC,UAAP,CAAkB,UAASd,IAAT,EAAc;AAACA,aAAKR,GAAL,CAASuB,MAAT;AAAkB,OAAnD,EAAoD,GAApD,EAAwD,IAAxD;AACrB;;;eAzFMvF,SAAS;;;;;;;;;;;;;;;;;;;MClBLwF,iBAAAA;;;;;qBACX9G,+BAAU;AACR,WAAKS,IAAL,GAAY,CAAC,CAAC,CAAD,EAAG,CAAH,CAAD,EAAO,CAAC,CAAD,EAAG,CAAH,CAAP,CAAZ;AACA,WAAKsG,EAAL,GAAU,+BAAiB,KAAKC,OAAtB,EAA+B;AACvCvG,cAAM,KAAKA,IAD4B;AAEvCgF,oBAAY,IAF2B;AAGvCC,oBAAY;AAH2B,OAA/B,CAAV;AAKD;;;;;;;;;;;;;;;;;;;;;MCPUuB,qBAAAA;AAEX,wBAAYC,OAAZ,EAAoB;AAAA;;AAClB,WAAKA,OAAL,GAAeA,OAAf;AACA,WAAKC,OAAL,GAAe,EAAf;AACA,WAAKC,WAAL,GAAiB,IAAjB;AACD;;yBAEDpH,+BAAY;AAAA;;AACV,WAAKkH,OAAL,CAAatG,WAAb,GAA2B/B,IAA3B,CACE,oBAAY;AACVoB,gBAAQC,GAAR,CAAY,yCAAZ;AACAD,gBAAQC,GAAR,CAAYmH,QAAZ;AACA,cAAKF,OAAL,GAAeE,SAASC,GAAxB;AACA,cAAKF,WAAL,GAAiB,KAAjB;AACD,OANH;AAUD;;;cAlBM9F,SAAS;;;;;;;;;;;;;;;MCALiG,yBAAAA,iBACX,wBAAYtD,SAAZ,EAAsB;AAAA;;AACpB,SAAKA,SAAL,GAAiBA,SAAjB;AACD;;MAGUuD,mBAAAA,WACX,kBAAY7C,IAAZ,EAAiB;AAAA;;AACf,SAAKA,IAAL,GAAYA,IAAZ;AACD;;MAGU8C,oBAAAA,YACX,mBAAYxD,SAAZ,EAAsB;AAAA;;AACpB,SAAKA,SAAL,GAAiBA,SAAjB;AACD;;MAGUyD,0BAAAA,kBACX,yBAAYC,OAAZ,EAAoB;AAAA;;AAClB,SAAKA,OAAL,GAAeA,OAAf;AACD;;MAGUC,wBAAAA,gBACX,uBAAYjF,EAAZ,EAAe;AAAA;;AACb,SAAKA,EAAL,GAAUA,EAAV;AACD;;MAGUkF,iCAAAA,yBACX,gCAAYlF,EAAZ,EAAe;AAAA;;AACb,SAAKA,EAAL,GAAUA,EAAV;AACD;;MAGUmF,wBAAAA,gBACX,uBAAYnF,EAAZ,EAAe;AAAA;;AACb,SAAKA,EAAL,GAAUA,EAAV;AACD;;MAGUoF,iCAAAA,yBACX,gCAAYpF,EAAZ,EAAe;AAAA;;AACb,SAAKA,EAAL,GAAUA,EAAV;AACD;;MAGUqF,0BAAAA,kBACX,yBAAYlF,OAAZ,EAAoB;AAAA;;AAClB,SAAKA,OAAL,GAAeA,OAAf;AACD;;MAEUmF,6BAAAA,qBACX,4BAAYC,SAAZ,EAAsB;AAAA;;AACpB,SAAKA,SAAL,GAAiBA,SAAjB;AACD;;MAGUC,8BAAAA,sBACX,+BAAa;AAAA;AACZ;;MAGUC,qBAAAA,aACX,oBAAYtF,OAAZ,EAAoB;AAAA;;AAClB,SAAKA,OAAL,GAAcA,OAAd;AACD;;MAGUuF,qBAAAA,aACX,oBAAYV,OAAZ,EAAoB;AAAA;;AAClB,SAAKA,OAAL,GAAcA,OAAd;AACD;;;;;;;;;;;;;;;MC3EUW,iBAAAA;;;;;qBAKXjC,2BAAQF,MAAK1F,MAAK8H,cAAc;AAE9B,UAAIC,oBAAJ;AACA,UAAIC,aAAa,IAAIC,UAAJ,EAAjB;;AAGAD,iBAAWE,gBAAX,CAA4B,SAA5B,EAAuC,YAAW;AAGhD,YAAIC,aAAa,IAAIC,UAAJ,CAAeJ,WAAWK,MAA1B,CAAjB;;AAGA,YAAIF,WAAW,CAAX,MAAgB,EAApB,EAAwB;AACtB3I,kBAAQC,GAAR,CAAY,iDAAZ;AACA,cAAI6I,eAAaH,WAAW1G,OAAX,CAAmB,EAAnB,CAAjB;AACA,cAAI8G,SAAS,IAAIH,UAAJ,CAAeD,UAAf,EAA0BG,eAAa,CAAvC,CAAb;AACAtI,eAAKwI,GAAL,GAAW,IAAIC,YAAJ,CAAiBF,OAAOG,MAAxB,CAAX;AACD,SALD,MAKO;AACL1I,eAAKwI,GAAL,GAAW,IAAIC,YAAJ,CAAiBN,WAAWO,MAA5B,CAAX;AACD;;AAID1I,aAAK2I,EAAL,GAAU,EAAV;AACA,aAAK,IAAIvF,IAAE,CAAX,EAAcA,IAAE,CAAH,GAAMpD,KAAKwI,GAAL,CAASnF,MAA5B,EAAmCD,KAAG,CAAtC,EAAwC;AAGtCpD,eAAK2I,EAAL,CAAQ/E,IAAR,CAAa,CAAC5D,KAAKwI,GAAL,CAASpF,CAAT,CAAD,EAAapD,KAAKwI,GAAL,CAASpF,IAAE,CAAX,CAAb,CAAb;AACD;;AAED,YAAI0E,YAAJ,EAAkBA,aAAac,cAAb,CAA4B,EAAC5I,MAAKA,KAAK2I,EAAX,EAA5B;AACnB,OAzBD;AA0BAX,iBAAWa,iBAAX,CAA6BnD,IAA7B;AACD;;;;;;;;;;;;;;;;;;;;;MCpCUoD,qBAAAA;AAIX,wBAAYhK,UAAZ,EAAuB+C,EAAvB,EAA2B;AAAA;;AACzB,WAAK/C,UAAL,GAAgBA,UAAhB;;AAGA,UAAIiK,SAAS,SAAb;;AAIA,WAAKC,UAAL,GAAgBD,SAAO,UAAvB;AACA,WAAKE,OAAL,GAAaF,SAAO,UAApB;;AAEA,WAAKG,WAAL,GAAiBH,SAAO,WAAxB;AACA,WAAKI,WAAL,GAAiBJ,SAAO,OAAxB;AACA,WAAKK,gBAAL,GAAsBL,SAAO,OAA7B;;AAEA,WAAKM,QAAL,GAAcN,SAAO,QAArB;AACA,WAAKO,QAAL,GAAc,EAAd;AACA,WAAK3G,QAAL,GAAc,EAAd;AACAnD,cAAQC,GAAR,CAAY,YAAZ;AACA,WAAKX,UAAL,CAAgBnB,SAAhB,CAA0B,kBAAU;AAClCN,eACG0B,oBADH,GAEGwK,WAFH,CAEe,EAFf,EAGGvK,YAHH,CAGgB;AACZC,uBAAa,aADD;AAEZC,mBAAS;AACP,sBAAU,kBADH;AAEP,gCAAoB;AAFb;AAFG,SAHhB;AAUD,OAXD;AAYA,WAAKqD,iBAAL,GAAuB,CAAvB;AACA,WAAKD,iBAAL,GAAuB,CAAvB;AACA,WAAKkH,gBAAL,GAAsB,EAAtB;AACA,WAAKC,OAAL,GAAaV,SAAO,UAApB;;AAEA,WAAKW,YAAL,GAAkBxD,OAAOyD,QAAP,CAAgBC,QAAhB,CAAyBC,UAAzB,CAAoC,QAApC,KAAiD3D,OAAOyD,QAAP,CAAgBC,QAAhB,CAAyBC,UAAzB,CAAoC,aAApC,CAAnE;AACA,UAAI,KAAKH,YAAT,EACA,KAAK5K,UAAL,CAAgBc,KAAhB,CAAsB,KAAK6J,OAA3B,EAAmC,EAAChJ,QAAO,MAAR,EAAnC,EAAoDR,KAApD,CAA0D;AAAA,eAAO+F,MAAM,kCAAgC9F,MAAM4J,UAA5C,CAAP;AAAA,OAA1D;;AAEA,WAAKC,aAAL,GAAmB,EAAnB;AACA,WAAKC,YAAL,GAAkB,IAAlB;AACD;;yBAEDC,6CAAkB;AAChB,aAAOC,YAAY,KAAKF,YAAL,CAAkBG,EAA9B,CAAP;AACD;;yBAEDD,mCAAYzH,QAAQ;AAAA;;AAClBjD,cAAQC,GAAR,CAAY,0BAAZ,EAAuCgD,MAAvC;AACA,UAAI2H,iBAAgB3H,MAAD,GAAS,KAAK0G,WAAL,GAAiB,GAAjB,GAAqB1G,MAArB,GAA4B,UAArC,GAAgD,KAAKuG,UAAxE;;AAEA,UAAI,KAAKM,QAAL,CAAcjG,MAAd,GAAqB,CAAzB,EACE,OAAO,IAAIzF,OAAJ,CAAY;AAAA,eAAWyM,QAAQ,MAAKf,QAAb,CAAX;AAAA,OAAZ,CAAP,CADF,KAGE,OAAO,KAAKxK,UAAL,CAAgBc,KAAhB,CAAsBwK,cAAtB,EACNhM,IADM,CACD;AAAA,eAAYyB,SAASC,IAAT,EAAZ;AAAA,OADC,EAEN1B,IAFM,CAED,gBAAQ;AACZ,cAAKkL,QAAL,GAAetJ,IAAf;AACA,eAAOA,IAAP;AACD,OALM,EAMNC,KANM,CAMA,iBAAS;AACdT,gBAAQC,GAAR,CAAYS,KAAZ;AAED,OATM,CAAP;AAUH;;yBAEDoD,iDAAmBpB,IAAG;AACpB,WAAKK,iBAAL,GAAuBL,EAAvB;AACD;;yBACDoI,mDAAoB;AAClB,aAAO,KAAK/H,iBAAZ;AACD;;yBAEDgI,6CAAkB;AAChB,aAAO7H,YAAY,KAAKsH,YAAL,CAAkBG,EAA9B,CAAP;AACD;;yBAEDzH,mCAAYD,QAAQ;AAAA;;AAElBjD,cAAQC,GAAR,CAAY,0BAAZ,EAAuCgD,MAAvC;AACA,UAAI+H,cAAa/H,MAAD,GAAS,KAAK0G,WAAL,GAAiB,GAAjB,GAAqB1G,MAArB,GAA4B,UAArC,GAAgD,KAAKwG,OAArE;;AAEA,UAAI,KAAKtG,QAAL,CAAcU,MAAd,GAAqB,CAAzB,EACE,OAAO,IAAIzF,OAAJ,CAAY;AAAA,eAAWyM,QAAQ,OAAK1H,QAAb,CAAX;AAAA,OAAZ,CAAP,CADF,KAGA,OAAO,KAAK7D,UAAL,CAAgBc,KAAhB,CAAsB4K,WAAtB,EACJpM,IADI,CACC;AAAA,eAAYyB,SAASC,IAAT,EAAZ;AAAA,OADD,EAEJ1B,IAFI,CAEC,gBAAQ;AACZ,eAAKuE,QAAL,GAAc3C,IAAd;AACA,eAAOA,IAAP;AACD,OALI,EAMJC,KANI,CAME,iBAAS;AACdT,gBAAQC,GAAR,CAAYS,KAAZ;AACD,OARI,CAAP;AAUD;;yBACDuK,iDAAmBvI,IAAG;AACpB,WAAKI,iBAAL,GAAuBJ,EAAvB;AACD;;yBAEDU,mDAAoB;AAClB,aAAO,KAAKN,iBAAZ;AACD;;yBAEDoI,uCAAcrI,SAAS;AAAA;;AAEnB,aAAO,KAAKvD,UAAL,CAAgBc,KAAhB,CAAsB,KAAKqJ,OAA3B,EAAoC,EAAExI,QAAO,MAAT,EAAiBC,MAAK,8BAAK2B,OAAL,CAAtB,EAApC,EACJjE,IADI,CACC;AAAA,eAAYyB,SAASC,IAAT,EAAZ;AAAA,OADD,EAEJ1B,IAFI,CAEC,gBAAQ;AACZ,eAAKuE,QAAL,GAAc3C,IAAd;AACA,eAAOA,IAAP;AACD,OALI,CAAP;AAMH;;yBAED2K,uCAAczD,SAAS;AAAA;;AACrB,aAAO,KAAKpI,UAAL,CAAgBc,KAAhB,CAAsB,KAAKoJ,UAA3B,EAAuC,EAAEvI,QAAO,MAAT,EAAiBC,MAAK,8BAAKwG,OAAL,CAAtB,EAAvC,EACJ9I,IADI,CACC;AAAA,eAAYyB,SAASC,IAAT,EAAZ;AAAA,OADD,EAEJ1B,IAFI,CAEC,gBAAQ;AACZoB,gBAAQC,GAAR,CAAY,mBAAZ;AACA,eAAK6J,QAAL,GAActJ,IAAd;AACA,eAAOA,IAAP;AACD,OANI,CAAP;AAOD;;yBAGD4K,+BAAW;AACT,aAAO,KAAK9L,UAAL,CAAgBc,KAAhB,CAAsB,KAAKyJ,QAA3B,EACJjL,IADI,CACC;AAAA,eAAYyB,SAASC,IAAT,EAAZ;AAAA,OADD,EAEJ1B,IAFI,CAEC,gBAAQ;AACZ,eAAO4B,IAAP;AACD,OAJI,EAKJC,KALI,CAKE,iBAAS;AACdT,gBAAQC,GAAR,CAAY,2BAAZ;AACAD,gBAAQC,GAAR,CAAYS,KAAZ;AAED,OATI,CAAP;AAUD;;yBAED2K,qCAAc;AACZ,UAAI,CAAC,KAAKnB,YAAV,EAAwB,OAAO9L,QAAQkN,MAAR,CAAe,mBAAf,CAAP;AACtB,aAAO,KAAKhM,UAAL,CAAgBc,KAAhB,CAAsB,KAAKuJ,WAA3B,EACJ/K,IADI,CACC;AAAA,eAAYyB,SAASC,IAAT,EAAZ;AAAA,OADD,EAEJ1B,IAFI,CAEC,gBAAQ;AACZ,eAAO4B,IAAP;AACD,OAJI,EAKJC,KALI,CAKE,iBAAS;AACdT,gBAAQC,GAAR,CAAY,8BAAZ;;AAEA,cAAMS,KAAN;AAED,OAVI,CAAP;AAWD;;yBAED6K,+CAAkB;AAElB,aAAO,KAAKjM,UAAL,CAAgBc,KAAhB,CAAsB,KAAKwJ,gBAA3B,EACJhL,IADI,CACC;AAAA,eAAYyB,SAASC,IAAT,EAAZ;AAAA,OADD,EAEJ1B,IAFI,CAEC,gBAAQ;AACZ,eAAO4B,IAAP;AACD,OAJI,EAKJC,KALI,CAKE,iBAAS;AACdT,gBAAQC,GAAR,CAAY,8BAAZ;;AAEA,cAAMS,KAAN;AAED,OAVI,CAAP;AAWD;;yBAECuD,uCAAcvB,IAAG;AACjB,aAAO,KAAKpD,UAAL,CAAgBc,KAAhB,CAAsB,KAAKqJ,OAAL,GAAa,GAAb,GAAiB/G,EAAvC,EAA0C,EAACzB,QAAO,QAAR,EAA1C,EACJrC,IADI,CACC;AAAA,eAAWyB,SAASC,IAAT,EAAX;AAAA,OADD,EAEJ1B,IAFI,CAEC,gBAAO;AAAC,eAAO4B,IAAP;AAAa,OAFtB,CAAP;AAGC;;yBAEDgL,6BAASC,KAAIC,MAAM;AACnB,aAAO,KAAKpM,UAAL,CAAgBc,KAAhB,CAAsB,KAAKsJ,WAA3B,EAAwC,EAACzI,QAAO,MAAR,EAAeC,MAAK,8BAAK,EAACyK,WAAUF,GAAX,EAAezH,WAAU0H,IAAzB,EAAL,CAApB,EAAxC,EACJ9M,IADI,CACC;AAAA,eAAWyB,SAASC,IAAT,EAAX;AAAA,OADD,EAEJ1B,IAFI,CAEC,gBAAO;AAAC,eAAO4B,IAAP;AAAa,OAFtB,CAAP;AAGC;;;cAtLIa,SAAS;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MCALuK,uBAAAA;AAIX,0BAAYxJ,EAAZ,EAAeC,EAAf,EAAmB;AAAA;;AAAA;;AAAA;;AACjBrC,cAAQC,GAAR,CAAY,gBAAZ;AACA,WAAKmC,EAAL,GAAUA,EAAV;AACA,WAAKC,EAAL,GAAQA,EAAR;AACA,WAAKyH,QAAL,GAAgB,EAAhB;AACA,WAAK+B,eAAL,GAAqB,IAArB;AACA,WAAK9I,iBAAL,GAAuB,CAAvB;AACA/C,cAAQC,GAAR,CAAY,0BAAZ;AACA,WAAKoC,EAAL,CAAQE,SAAR,0BAAgC;AAAA,eAAM,MAAKuJ,sBAAL,CAA4BrJ,IAAIC,EAAhC,CAAN;AAAA,OAAhC;AACA,WAAKL,EAAL,CAAQE,SAAR,uBAA6B;AAAA,eAAM,MAAKwJ,WAAL,CAAiBtJ,IAAIiF,OAArB,CAAN;AAAA,OAA7B;AACA,WAAKrF,EAAL,CAAQE,SAAR,mCAAyC;AAAA,eAAM,MAAKuJ,sBAAL,CAA4BrJ,IAAIC,EAAhC,CAAN;AAAA,OAAzC;AACA1C,cAAQC,GAAR,CAAY,4BAAZ;AACD;;2BAED+C,uBAAO;AAAA;;AACLhD,cAAQC,GAAR,CAAY,qBAAZ,EAAkC,KAAKgD,MAAvC;AACA,WAAKb,EAAL,CAAQsI,WAAR,CAAoB,KAAKzH,MAAzB,EAAiCrE,IAAjC,CAAsC,gBAAQ;AAC5C,eAAKkL,QAAL,GAAgBtJ,IAAhB;;AAEA,eAAKuC,iBAAL,GAAuB,OAAKX,EAAL,CAAQ0I,kBAAR,EAAvB;AACA9K,gBAAQC,GAAR,CAAY,OAAK8C,iBAAjB;AACA,YAAI,OAAKA,iBAAL,GAAuB,CAA3B,EAA8B,OAAK+I,sBAAL,CAA4B,OAAK/I,iBAAjC;AAC/B,OAND;AAOD;;2BAID+I,yDAAuBpJ,IAAI;AAEzB,WAAKK,iBAAL,GAAuBL,EAAvB;AACA,UAAI,KAAKoH,QAAL,CAAcjG,MAAd,GAAqB,CAAzB,EAA4B;AAC1B,aAAKgI,eAAL,GAAuB,KAAK/B,QAAL,CAAcnG,MAAd,CAAqB;AAAA,iBAAKC,EAAElB,EAAF,IAAQA,EAAb;AAAA,SAArB,EAAsC,CAAtC,CAAvB;AACD,OAFD,MAEO;AACL1C,gBAAQC,GAAR,CAAY,gCAAZ;AACD;AACF;;2BAED+L,uCAActE,SAAQ;AACpB1H,cAAQC,GAAR,CAAY,iBAAZ;AACA,WAAK4L,eAAL,GAAqBnE,OAArB;AACA,WAAKrF,EAAL,CAAQmB,OAAR,CAAgB,8BAAoBkE,OAApB,CAAhB;AACA,aAAO,IAAP;AACD;;2BAEDuE,6CAAiB;AACfjM,cAAQC,GAAR,CAAY,mBAAZ;AACA,WAAK4L,eAAL,GAAqB,IAArB;AACA,WAAKxJ,EAAL,CAAQmB,OAAR,CAAgB,8BAAoB,IAApB,CAAhB;AACA,aAAO,IAAP;AACD;;2BAEDuI,mCAAYG,IAAI;AACdlM,cAAQC,GAAR,CAAY,eAAZ,EAA4BiM,EAA5B;AACA,WAAKpC,QAAL,CAAcqC,OAAd,CAAsBD,EAAtB;AACD;;;eAzDM7K,SAAS;;;;;;;;;;;;;;;;;;MCNL+K,uBAAAA;;;;;;;;;;;;;;;;;;;;MCEAC,wBAAAA;AAGX,2BAAYC,UAAZ,EAAwB;AAAA;;AACtB,WAAKlK,EAAL,GAAUkK,UAAV;AACA,WAAKC,YAAL,GAAkB,KAAlB;AACD;;4BAEDxM,+BAAU;AAAA;;AACR,WAAKqC,EAAL,CAAQmJ,gBAAR,GAA2B3M,IAA3B,CAAgC,gBAAQ;AACpCoB,gBAAQC,GAAR,CAAYO,IAAZ;AACA,cAAKgM,QAAL,GAAchM,IAAd;AACA,cAAK+L,YAAL,GAAkB,IAAlB;AACD,OAJH,EAKG9L,KALH,CAKS,iBAAS;AACdT,gBAAQC,GAAR,CAAY,kCAAZ;AACA,cAAKsM,YAAL,GAAkB,KAAlB;AACD,OARH;AASD;;;cAjBMlL,SAAS;;;;;;;;;;;;;;;;;;MCDLoL,mBAAAA;AAGX,sBAAYH,UAAZ,EAAwB;AAAA;;AACtB,WAAKlK,EAAL,GAAUkK,UAAV;AACA,WAAKC,YAAL,GAAkB,KAAlB;AACD;;uBAEDxM,+BAAU;AAAA;;AACR,WAAKqC,EAAL,CAAQiJ,WAAR,GAAsBzM,IAAtB,CAA2B,gBAAQ;AAC/BoB,gBAAQC,GAAR,CAAYO,IAAZ;AACA,cAAKgM,QAAL,GAAchM,IAAd;AACA,cAAK+L,YAAL,GAAkB,IAAlB;AACD,OAJH,EAKG9L,KALH,CAKS,iBAAS;AACdT,gBAAQC,GAAR,CAAY,kCAAZ;AACA,cAAKsM,YAAL,GAAkB,KAAlB;AACD,OARH;AASD;;;cAjBMlL,SAAS;;;;;;;;;;;;;;;;;;MCCLqL,0BAAAA;AAGX,6BAAYrK,EAAZ,EAAe/C,UAAf,EAA2B;AAAA;;AAAA;;AAEzB,WAAK+C,EAAL,GAASA,EAAT;AACA,WAAKA,EAAL,CAAQE,SAAR,2BAAiC;AAAA,eAAM,MAAKoK,SAAL,CAAelK,IAAIuB,SAAnB,CAAN;AAAA,OAAjC;;AAEA,WAAK1E,UAAL,GAAkBA,UAAlB;AACA,WAAKA,UAAL,CAAgBnB,SAAhB,CAA0B,kBAAU;AAClCN,eACG0B,oBADH,GAEGwK,WAFH,CAEe,EAFf,EAGGvK,YAHH,CAGgB;AACZC,uBAAa,aADD;AAEZC,mBAAS;AACP,sBAAU,kBADH;AAEP,gCAAoB;AAFb;AAFG,SAHhB;AAUD,OAXD;AAYA,WAAKkN,UAAL,GAAkB,EAAlB;AAEA,WAAKC,IAAL,GAAU,EAAV;AACA,WAAKC,KAAL,GAAW,EAAX;AACD;;8BAEDC,6BAAS;AACP,UAAI,KAAK3K,EAAL,CAAQ2B,UAAZ,EAAuB;AACrB4I,kBAAU3I,SAAV;AACD;AACF;;8BAED2I,+BAAU3I,WAAW;AAAA;;AACnBhE,cAAQC,GAAR,CAAY,8BAA4B+D,SAAxC;AACA,WAAK4I,UAAL,GAAkB5I,SAAlB;AACA,UAAI,CAACA,SAAL,EAAgB;AAAC,aAAK8I,KAAL,GAAa,EAAb,CAAgB;AAAQ;;AAEzC,WAAKxN,UAAL,CAAgBc,KAAhB,CAAsB,KAAKwM,UAA3B,EAAuC;AACrC3L,gBAAQ,UAD6B;AAErCvB,iBAAS,EAAC,SAAS,GAAV;AAF4B,OAAvC,EAGGd,IAHH,CAGQ;AAAA,eAAYyB,SAASiG,IAAT,EAAZ;AAAA,OAHR,EAIG1H,IAJH,CAIQ;AAAA,eAAQ,IAAI8H,OAAOsG,SAAX,EAAD,CAAyBC,eAAzB,CAAyCC,GAAzC,EAA8C,UAA9C,CAAP;AAAA,OAJR,EAKGtO,IALH,CAKQ,gBAAQ;AAEZ,eAAKkO,KAAL,GAAa,EAAb;AACA,YAAIK,WAAW3M,KAAK4M,oBAAL,CAA0B,YAA1B,CAAf;AACA,6BAAqBD,QAArB,kHAA+B;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA,cAAtBE,QAAsB;;AAC7B,cAAIzI,WAAW,OAAK0I,wBAAL,CAA8BD,QAA9B,EAAwC,QAAxC,CAAf;AACA,cAAIE,WAAW,OAAKD,wBAAL,CAA8BD,QAA9B,EAAwC,kBAAxC,CAAf;AACA,cAAIG,WAAW,OAAKF,wBAAL,CAA8BD,QAA9B,EAAwC,sBAAxC,CAAf;AACA,cAAII,WAAW,OAAKH,wBAAL,CAA8BD,QAA9B,EAAwC,kBAAxC,CAAf;;AAEA,cAAIzI,YAAY,OAAKgI,UAArB,EACA;AACE,kBAAIc,OAAO,EAAX;AACAA,mBAAKzO,IAAL,GAAY2F,SAAS+I,OAAT,CAAiB,OAAKf,UAAtB,EAAkC,EAAlC,CAAZ;AACAc,mBAAKE,IAAL,GAAYL,QAAZ;AACAG,mBAAKG,QAAL,GAAgB,OAAKC,UAAL,CAAgB,IAAIC,IAAJ,CAASR,QAAT,CAAhB,CAAhB;AACAG,mBAAKM,KAAL,GAAYP,YAAY,sBAAxB;AACAC,mBAAKO,IAAL,GAAYR,YAAY,sBAAZ,GAAqC,KAArC,GAA6CD,QAAzD;;AAEAE,mBAAKQ,QAAL,GAAgBR,KAAKM,KAAL,GAAaN,KAAKO,IAAlB,GAAwB,CAAC,EAAEP,KAAKO,IAAL,GAAY,UAAd,CAAD,GAA6B,CAA7B,GAAiC,CAAC,EAAEP,KAAKO,IAAL,GAAY,UAAd,CAAD,GAA6B,IAA9D,GAAsE,CAAC,EAAEP,KAAKO,IAAL,GAAY,OAAd,CAAD,GAA0B,CAA1B,GAA8B,CAAC,EAAEP,KAAKO,IAAL,GAAY,OAAd,CAAD,GAA0B,IAAxD,GAAgE,CAAC,EAAEP,KAAKO,IAAL,GAAY,IAAd,CAAD,GAAuB,CAAvB,GAA2B,CAAC,EAAEP,KAAKO,IAAL,GAAY,IAAd,CAAD,GAAuB,IAAlD,GAAyDP,KAAKO,IAAL,GAAY,IAAnP;AACAP,mBAAKS,IAAL,GAAYV,QAAZ;AACAC,mBAAK1J,SAAL,GAAe,OAAK4I,UAAL,GAAgBc,KAAKzO,IAApC;;AAEA,kBAAIyO,KAAKM,KAAT,EAAgB,OAAKlB,KAAL,CAAWX,OAAX,CAAmBuB,IAAnB,EAAhB,KACK,OAAKZ,KAAL,CAAW1I,IAAX,CAAgBsJ,IAAhB;AACN;AAEF;;AAED,YAAI,OAAKb,IAAL,CAAUhJ,MAAV,GAAiB,CAArB,EAAwB,OAAKiJ,KAAL,CAAWX,OAAX,CAAmB,EAAClN,MAAK,IAAN,EAAW+O,OAAM,IAAjB,EAAsBC,MAAK,KAA3B,EAAiCL,MAAK,EAAtC,EAAnB;AACzB,OAnCH,EAmCKnN,KAnCL,CAmCW,iBAAS;AAChB,eAAKqM,KAAL,GAAW,EAAX;AACF9M,gBAAQC,GAAR,CAAY,mBAAZ;AACAD,gBAAQC,GAAR,CAAYS,KAAZ;AACD,OAvCD;AAwCD;;8BAED4M,6DAAyBD,UAASe,KAAK;AAErC,UAAIC,WAAUhB,SAASD,oBAAT,CAA8BgB,GAA9B,CAAd;;AAEA,aAAOC,SAASxK,MAAT,GAAgB,CAAhB,GAAkBwK,SAAS,CAAT,EAAYC,WAA9B,GAA0C,EAAjD;AACD;;8BAED7J,iCAAWC,MAAK;AAEd,UAAIA,KAAKsJ,KAAT,EAAgB;AACd,YAAIO,SAAQ,EAAZ;AACA,YAAI7J,KAAKzF,IAAL,IAAY,IAAhB,EAAsB;AACpBsP,mBAAS,KAAK1B,IAAL,CAAU2B,GAAV,EAAT;AACD,SAFD,MAEO;AACL,eAAK3B,IAAL,CAAUzI,IAAV,CAAe,KAAKwI,UAApB;AACA2B,mBAAS,KAAK3B,UAAL,GAAgBlI,KAAKzF,IAA9B;AACD;AACD,aAAK0N,SAAL,CAAe4B,MAAf;AACD,OATD,MAUM,KAAKlM,EAAL,CAAQmB,OAAR,CAAgB,uBAAakB,IAAb,CAAhB;AACP;;8BAEDoJ,iCAAWF,MAAM;AACb,UAAIa,OAAO,IAAIV,IAAJ,KAAaH,IAAxB;;AAEA,UAAIa,OAAO,IAAX,EAAiB;AACf,eAAO,WAAP;AACD;;AAED,UAAIC,MAAMC,KAAKC,KAAL,CAAWH,OAAO,IAAlB,CAAV;;AAEA,UAAIC,MAAM,EAAV,EAAc;AACZ,eAAOA,MAAM,WAAb;AACD;;AAED,UAAIG,MAAMF,KAAKC,KAAL,CAAWH,OAAO,KAAlB,CAAV;AACA,UAAII,MAAM,EAAV,EAAc;AACZ,eAAOA,MAAM,WAAb;AACD;;AAID,UAAIC,IAAIlB,IAAR;AACAkB,UAAI,CACF,MAAMA,EAAEC,OAAF,EADJ,EAEF,OAAOD,EAAEE,QAAF,KAAe,CAAtB,CAFE,EAGF,KAAKF,EAAEG,WAAF,EAHH,EAIF,MAAMH,EAAEI,QAAF,EAJJ,EAKF,MAAMJ,EAAEK,UAAF,EALJ,EAMFpQ,GANE,CAME;AAAA,eAAaqQ,UAAUC,KAAV,CAAgB,CAAC,CAAjB,CAAb;AAAA,OANF,CAAJ;AASA,aAAOP,EAAEO,KAAF,CAAQ,CAAR,EAAW,CAAX,EAAcC,IAAd,CAAmB,GAAnB,IAA0B,GAA1B,GAAgCR,EAAEO,KAAF,CAAQ,CAAR,EAAWC,IAAX,CAAgB,GAAhB,CAAvC;AACD;;;cApIIjO,SAAS;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MCDLkO,uBAAAA;AAIX,0BAAYlN,EAAZ,EAAgB;AAAA;;AAAA;;AACd,WAAKA,EAAL,GAAQA,EAAR;AACA,WAAKmN,IAAL,GAAU,oEAAV;AACA,WAAKC,KAAL,GAAW,yEAAX;AACA,WAAKC,KAAL,GAAW,EAAX;;AAEA,UAAIC,MAAK,IAAT;AACA,WAAKC,cAAL,GAAsB,aAAK;AACzB5P,gBAAQC,GAAR,CAAY,gBAAZ;AACAD,gBAAQC,GAAR,CAAYiE,CAAZ;AACAyL,YAAID,KAAJ,GAAUxL,EAAE1D,IAAZ;AACAR,gBAAQC,GAAR,CAAY,kBAAZ;AACA0P,YAAItN,EAAJ,CAAOmB,OAAP,CAAe,wBAAcmM,IAAID,KAAlB,CAAf;AACD,OAND;AAOA1P,cAAQC,GAAR,CAAY,gBAAZ;AACAD,cAAQC,GAAR,CAAY,KAAKiF,IAAjB;AACD;;2BAEDnF,+BAAW;AAET2G,aAAOgC,gBAAP,CAAwB,SAAxB,EAAmC,KAAKkH,cAAxC;AACA5P,cAAQC,GAAR,CAAY,yBAAZ;AACAD,cAAQC,GAAR,CAAY,KAAKiF,IAAjB;AACA,WAAK2K,UAAL,GAAmB,KAAK3K,IAAL,KAAc,MAAjC;AACD;;2BAED4K,+BAAW;AACTpJ,aAAOqJ,mBAAP,CAA2B,SAA3B,EAAsC,KAAKH,cAA3C;AACD;;2BAGDI,2CAAiB;AACf,WAAKC,KAAL,GAAWvJ,OAAOwJ,IAAP,CAAY,KAAKV,IAAjB,EAAuB,WAAvB,EAAoC,uBAApC,CAAX;AACD;;2BACDW,yCAAgB;AACd,WAAKF,KAAL,GAAWvJ,OAAOwJ,IAAP,CAAY,KAAKT,KAAjB,EAAwB,WAAxB,EAAqC,uBAArC,CAAX;AACD;;;eAvCMpO,SAAS;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MCCL+O,gBAAAA;;;;;;;oBAGXrQ,+BAAW;AAGT,UAAIsQ,OAAQ3J,OAAOyD,QAAP,CAAgBkG,IAAhB,IAAwB,EAAxB,IAA8B3J,OAAOyD,QAAP,CAAgBkG,IAAhB,IAAsB,IAApD,IAA4D3J,OAAOyD,QAAP,CAAgBkG,IAAhB,IAAwB,KAArF,GAA6F,EAA7F,GAAiG,MAAI3J,OAAOyD,QAAP,CAAgBkG,IAAhI;AACA,WAAKC,MAAL,CAAYC,KAAZ,GAAoB7J,OAAOyD,QAAP,CAAgBqG,QAAhB,GAA0B,IAA1B,GAA+B9J,OAAOyD,QAAP,CAAgBsG,QAA/C,GAAwDJ,IAAxD,GAA6D,KAAKb,IAAtF;AACD;;oBAEDkB,yCAAgB;AACd,UAAIC,eAAe,KAAKL,MAAxB;AACAK,mBAAaC,MAAb;AACAC,eAASC,WAAT,CAAqB,MAArB;AACA9Q,cAAQC,GAAR,CAAY0Q,aAAaJ,KAAzB;AACA/J,YAAM,kCAAkCmK,aAAaJ,KAArD;AACD;;;;;;;;;;;;;;UCtBapS,YAAAA;AAAT,WAASA,SAAT,CAAmBN,MAAnB,EAA2B;AAEhCA,WAAOkT,eAAP,CAAuB,CACrB,aADqB,EAErB,iBAFqB,EAGrB,eAHqB,EAIrB,eAJqB,EAKrB,cALqB,EAMrB,cANqB,EAOrB,SAPqB,EAQrB,gBARqB,EASrB,cATqB,EAUrB,iBAVqB,EAWrB,eAXqB,EAYrB,iBAZqB,EAarB,WAbqB,EAcrB,gBAdqB,EAerB,cAfqB,EAgBrB,kBAhBqB,CAAvB;AAmBD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MCDYC,kBAAAA;AAGX,qBAAY5O,EAAZ,EAAgB;AAAA;;AAAA;;AAAA;;AACd,WAAKA,EAAL,GAAQA,EAAR;;AAEA,WAAKwN,cAAL,GAAsB,iBAAQ;AAC5B,cAAKqB,UAAL,GAAgBC,MAAM1Q,IAAtB;AACA,YAAI,MAAKyQ,UAAL,IAAmB,MAAKA,UAAL,CAAgBpN,MAAhB,GAAuB,CAA9C,EAAgD;AAE9C7D,kBAAQC,GAAR,CAAY,0BAAZ;AACAD,kBAAQC,GAAR,CAAY,sBAAoB,MAAKkR,QAArC;AACAnR,kBAAQC,GAAR,CAAY,sBAAoB,MAAKgR,UAArC;AACA,gBAAK7O,EAAL,CAAQoJ,QAAR,CAAiB,MAAKgE,IAAtB,EAA2B,MAAKyB,UAAhC;AACD;AACF,OATD;AAWD;;sBAEDlR,+BAAW;AAGT,UAAIsQ,OAAQ3J,OAAOyD,QAAP,CAAgBkG,IAAhB,IAAwB,EAAxB,IAA8B3J,OAAOyD,QAAP,CAAgBkG,IAAhB,IAAsB,IAApD,IAA4D3J,OAAOyD,QAAP,CAAgBkG,IAAhB,IAAwB,KAArF,GAA6F,EAA7F,GAAiG,MAAI3J,OAAOyD,QAAP,CAAgBkG,IAAhI;AACA,WAAKc,QAAL,GAAgBzK,OAAOyD,QAAP,CAAgBqG,QAAhB,GAA0B,IAA1B,GAA+B9J,OAAOyD,QAAP,CAAgBsG,QAA/C,GAAwDJ,IAAxD,GAA6D,KAAKb,IAAlF;AACAxP,cAAQC,GAAR,CAAY,mBAAZ;AACAD,cAAQC,GAAR,CAAY,KAAKuP,IAAjB;AACAxP,cAAQC,GAAR,CAAY,KAAKkR,QAAjB;AACAzK,aAAOgC,gBAAP,CAAwB,SAAxB,EAAmC,KAAKkH,cAAxC,EAAwD,KAAxD;AACD;;sBAEDwB,iCAAY;AACV1K,aAAOqJ,mBAAP,CAA2B,SAA3B,EAAsC,KAAKH,cAA3C;AACD;;sBAEDyB,iCAAW7B,MAAM;AACf,WAAKS,KAAL,GAAWvJ,OAAOwJ,IAAP,CAAYV,IAAZ,EAAkB,WAAlB,EAA+B,uBAA/B,CAAX;AACD;;sBAED8B,mCAAa;AACX,WAAKD,UAAL,CAAgB,yEAAhB;AACD;;;eAtCMhQ,SAAS;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MChBLkQ,wBAAAA;AAIX,2BAAYlP,EAAZ,EAAgBD,EAAhB,EAAoB;AAAA;;AAAA;;AAAA;;AAClB,WAAKC,EAAL,GAAUA,EAAV;AACA,WAAKD,EAAL,GAAUA,EAAV;AACA,WAAKoP,WAAL,GAAiB,UAAjB;AACA,WAAKC,WAAL,GAAiB,KAAjB;AACA,WAAKC,cAAL,GAAoB,sBAApB;AACA,WAAKC,gBAAL,GAAsB,IAAtB;AACA,WAAKC,SAAL,GAAe,KAAf;AACA,WAAKvP,EAAL,CAAQE,SAAR,4BAAkC;AAAA,eAAM,MAAKyJ,aAAL,CAAmBvJ,IAAIiF,OAAvB,CAAN;AAAA,OAAlC;AACD;;4BAEDmK,2BAAQ;AAAA;;AACN7R,cAAQC,GAAR,CAAY,wBAAsB,KAAKuR,WAAvC;AACA,WAAKpP,EAAL,CAAQ8I,aAAR,CAAsB,EAACjM,MAAK,KAAKuS,WAAX,EAAuBM,MAAK,KAAKL,WAAjC,EAA6CM,SAAQ,KAAKL,cAA1D,EAAyEhO,WAAU,KAAKiO,gBAAxF,EAAtB,EACG/S,IADH,CACQ,mBAAU;AACd,eAAKgT,SAAL,GAAe,IAAf;AACA,eAAKI,aAAL,GAAmBnP,OAAnB;AACA,eAAKR,EAAL,CAAQmB,OAAR,CAAgB,yBAAeX,OAAf,CAAhB;AACD,OALH,EAMGpC,KANH,CAMS,iBAAS;AACdT,gBAAQC,GAAR,CAAYS,KAAZ;AACA8F,cAAM,uCAAqC9F,KAA3C;AACD,OATH;AAUA,WAAK8Q,WAAL,GAAiB,EAAjB;AACA,WAAKC,WAAL,GAAiB,EAAjB;AACA,WAAKC,cAAL,GAAoB,EAApB;AACD;;4BAEDO,+BAAU;AACR,WAAKT,WAAL,GAAiB,UAAjB;AACA,WAAKC,WAAL,GAAiB9C,KAAKC,KAAL,CAAYD,KAAKuD,MAAL,KAAgB,GAAjB,GAAwB,CAAnC,IAAsC,IAAvD;AACA,WAAKR,cAAL,GAAoB,sBAApB;AACD;;4BAED1F,uCAActE,SAAQ;AACpB,UAAIA,OAAJ,EAAa;AACX,aAAKiK,gBAAL,GAAwBjK,QAAQhF,EAAhC;AACD,OAFD,MAEO,KAAKiP,gBAAL,GAAsB,IAAtB;AACR;;4BAEDrO,yCAAe,CAEd;;;eA7CMjC,SAAS;;;;;;;;;;;;;;;;;;;;;ACDlB,MAAM8Q,YAAY,SAAZA,SAAY,QAAS;AACzB,QAAI,CAACC,KAAL,EAAY;AACV,aAAO,EAAP;AACD;;AAED,WAAO,CAAC,QAAQC,IAAR,CAAaD,KAAb,IAAsBA,MAAM/C,KAAN,CAAY,CAAZ,CAAtB,GAAuC+C,KAAxC,EACJE,KADI,CACE,GADF,EAEJC,MAFI,CAEG,UAACC,MAAD,EAASC,KAAT,EAAmB;AAAA,yBACNA,MAAMH,KAAN,CAAY,GAAZ,CADM;AAAA,UACpBI,GADoB;AAAA,UACfnC,KADe;;AAEzBiC,aAAOE,GAAP,IAAcnC,QAAQoC,mBAAmBpC,MAAM5C,OAAN,CAAc,KAAd,EAAqB,GAArB,CAAnB,CAAR,GAAwD,EAAtE;AACA,aAAO6E,MAAP;AACD,KANI,EAMF,EANE,CAAP;AAOD,GAZD;;MAgBaI,oBAAAA;AAGX,uBAAY3L,OAAZ,EAAoB7E,EAApB,EAAuBC,EAAvB,EAA2B;AAAA;;AACzB,WAAK4E,OAAL,GAAeA,OAAf;AACA,WAAK7E,EAAL,GAASA,EAAT;AACA,WAAKC,EAAL,GAAQA,EAAR;AACA,WAAKwQ,aAAL,GAAmB,KAAnB;AACA,WAAKC,gBAAL,GAAsB,EAAtB;AACA,WAAKC,eAAL,GAAqB,KAArB;AACA,WAAKpR,SAAL,GAAe,EAAf;AACA,WAAKqR,gBAAL,GAAsB,KAAtB;AACD;;wBAMDjT,+BAAU;AAAA;;AACRC,cAAQC,GAAR,CAAY,sBAAZ;AACA,WAAKuS,MAAL,GAAYL,UAAUzL,OAAOyD,QAAP,CAAgB8I,MAAhB,CAAuBC,SAAvB,CAAiC,CAAjC,CAAV,CAAZ;AACAlT,cAAQC,GAAR,CAAY,KAAKuS,MAAjB;AACA,WAAK3R,IAAL,GAAU,KAAK2R,MAAL,CAAY3R,IAAtB;AACA,WAAKC,KAAL,GAAW,KAAK0R,MAAL,CAAY1R,KAAvB;AACA,UAAI,KAAKD,IAAL,IAAa,KAAKC,KAAtB,EAA6B;AAC3B,aAAK+R,aAAL,GAAmB,IAAnB;;AAGA,aAAK5L,OAAL,CAAarG,cAAb,CAA4B,KAAKC,IAAjC,EAAsC,KAAKC,KAA3C,EAAkDlC,IAAlD,CAAuD,uBAAc;AACnEoB,kBAAQC,GAAR,CAAY,kCAAZ;AACAD,kBAAQC,GAAR,CAAYkT,WAAZ;AACA,gBAAKN,aAAL,GAAmB,KAAnB;AACA,cAAIM,YAAYC,iBAAhB,EAAmC;AACjC,kBAAKN,gBAAL,GAAsBK,YAAYC,iBAAlC;AACA,kBAAKL,eAAL,GAAqB,IAArB;AACD,WAHD,MAGO;AAEL,kBAAK9L,OAAL,CAAalG,eAAb,GAA+BnC,IAA/B,CAAoC,gBAAO;AACzCoB,sBAAQC,GAAR,CAAY,yCAAZ;AACAD,sBAAQC,GAAR,CAAYoT,IAAZ;AACA,oBAAK1R,SAAL,GAAe0R,IAAf;AACD,aAJD,EAKG5S,KALH,CAKS,iBAAQ;AACb,oBAAKqS,gBAAL,GAAsBpS,MAAM4J,UAA5B;AACA,oBAAKyI,eAAL,GAAqB,IAArB;AACD,aARH;AASD;AACF,SAnBD;AAoBD;AACF;;wBAEDO,yCAAeC,GAAE;AAAA;;AAEf,WAAKV,aAAL,GAAmB,IAAnB;AACA,WAAK5L,OAAL,CAAa9G,WAAb,CAAyBoT,EAAEjS,GAA3B,EAAgC1C,IAAhC,CAAqC,kBAAS;AAC5C,eAAKiU,aAAL,GAAmB,KAAnB;AACA7S,gBAAQC,GAAR,CAAY,6BAAZ;AACAD,gBAAQC,GAAR,CAAYuT,MAAZ;AACA,eAAKR,gBAAL,GAAsBQ,OAAOjT,QAA7B;AACA,eAAKkT,cAAL,GAAqBC,OAClBC,IADkB,CACb,OAAKX,gBAAL,CAAsBY,MADT,EAElBC,IAFkB,CAEb,UAACC,CAAD,EAAGC,CAAH;AAAA,iBAAS,CAACD,CAAD,GAAK,CAACC,CAAf;AAAA,SAFa,EAGlBpQ,MAHkB,CAGX;AAAA,iBAAO,CAACqQ,MAAM,CAACtB,GAAP,CAAR;AAAA,SAHW,EAIlB3T,GAJkB,CAId;AAAA,iBAAO,OAAKiU,gBAAL,CAAsBY,MAAtB,CAA6BlB,GAA7B,CAAP;AAAA,SAJc,CAArB;AAKD,OAVD,EAWGjS,KAXH,CAWS,iBAAQ;AACb,eAAKoS,aAAL,GAAmB,KAAnB;AACA,eAAKE,eAAL,GAAqB,IAArB;AACA,eAAKD,gBAAL,GAAuBpS,MAAM4J,UAA7B;AACD,OAfH;AAgBD;;wBAED2J,yCAAeV,GAAG;AAAA;;AAChB,UAAIrH,KAAG,EAAP;AACAA,SAAGgI,WAAH,GAAiBX,EAAExV,KAAnB;AACAmO,SAAGiI,SAAH,GAAaZ,EAAEjS,GAAf;;AAEA,WAAKuR,aAAL,GAAmB,IAAnB;AACA,WAAKzQ,EAAL,CAAQ+I,aAAR,CAAsBe,EAAtB,EAA0BtN,IAA1B,CAA+B,gBAAO;AACpC,eAAKiU,aAAL,GAAmB,KAAnB;AACA,eAAKxQ,EAAL,CAAQmB,OAAR,CAAgB,yBAAehD,IAAf,CAAhB;AACD,OAHD,EAGGC,KAHH,CAGU,iBAAO;AACf,eAAKoS,aAAL,GAAmB,KAAnB;AACA,eAAKE,eAAL,GAAqB,IAArB;AACA,eAAKD,gBAAL,GAAuBpS,MAAM4J,UAA7B;AACD,OAPD;AAQD;;;cApFMjJ,SAAS;;;;;;;;;;;;;;;;;;MCnBL+S,0BAAAA;AAGX,6BAAY/R,EAAZ,EAAeD,EAAf,EAAmB;AAAA;;AAAA;;AACjB,WAAKC,EAAL,GAAUA,EAAV;AACA,WAAKD,EAAL,GAAQA,EAAR;AACApC,cAAQC,GAAR,CAAY,aAAZ;AACA,WAAKoC,EAAL,CAAQE,SAAR,4BAAkC;AAAA,eAAM,MAAKyJ,aAAL,CAAmBvJ,IAAIiF,OAAvB,CAAN;AAAA,OAAlC;AACA,WAAKrF,EAAL,CAAQE,SAAR,4BAAkC;AAAA,eAAO,MAAKe,aAAL,CAAmBb,IAAII,OAAvB,CAAP;AAAA,OAAlC;AACD;;8BAIDwR,6BAAS7B,QAAQ8B,aAAaC,uBAAsB;AAClDvU,cAAQC,GAAR,CAAY,4BAAZ;AACA,UAAIuS,UAAUA,OAAOgC,SAArB,EAAgC;AAC9BxU,gBAAQC,GAAR,CAAY,+BAA6BuS,OAAOgC,SAAhD;AACA,aAAKC,aAAL,CAAmBjC,OAAOgC,SAA1B;AACD;AACD,UAAIhC,UAAUA,OAAOvK,SAArB,EAAgC;AAC9BjI,gBAAQC,GAAR,CAAY,+BAA6BuS,OAAOvK,SAAhD;AACA,aAAKyM,aAAL,CAAmBlC,OAAOvK,SAA1B;AACD;AACF;;8BAIDlI,+BAAW;AACTC,cAAQC,GAAR,CAAY,sBAAZ;AACA,WAAKsD,eAAL,GAAqB,KAAKnB,EAAL,CAAQgB,kBAAR,KAA6B,CAAlD;AAED;;8BAID4I,uCAActE,SAAS;AACrB,WAAKmE,eAAL,GAAqBnE,OAArB;AACA,WAAK3E,iBAAL,GAAuB2E,QAAQhF,EAA/B;AACA,WAAKN,EAAL,CAAQ0B,kBAAR,CAA2B0Q,SAA3B;AACA,WAAKnS,EAAL,CAAQmB,OAAR,CAAgB,qCAA2BkE,QAAQhF,EAAnC,CAAhB;AACA,aAAO,IAAP;AACD;;8BAID+R,uCAAcD,WAAU;AACtBxU,cAAQC,GAAR,CAAY,iCAAZ;AACA,WAAKmC,EAAL,CAAQ0B,kBAAR,CAA2B0Q,SAA3B;AACA,WAAKnS,EAAL,CAAQmB,OAAR,CAAgB,4BAAkBgR,SAAlB,CAAhB;AACA,WAAKnS,EAAL,CAAQmB,OAAR,CAAgB,qCAA2BgR,SAA3B,CAAhB;AACD;;8BAGDE,uCAAczM,WAAU;AACtBjI,cAAQC,GAAR,CAAY,iCAAZ;AACA,WAAKmC,EAAL,CAAQ6I,kBAAR,CAA2BhD,SAA3B;AACA,WAAK5F,EAAL,CAAQmB,OAAR,CAAgB,4BAAkByE,SAAlB,CAAhB;AACD;;8BAGD3E,uCAAcoK,MAAM;AAClB1N,cAAQC,GAAR,CAAY,+BAAZ;AACAD,cAAQC,GAAR,CAAYyN,IAAZ;AACA,WAAKnK,eAAL,GAAqBmK,IAArB;AACA,UAAI,CAACA,IAAL,EAAW;AAACjK,0BAAmB,OAAO,IAAP;AAAa;AAC5C,WAAKX,iBAAL,GAAuB4K,KAAKhL,EAA5B;AACA1C,cAAQC,GAAR,CAAY,eAAZ;AACAD,cAAQC,GAAR,CAAYyN,IAAZ;;AAEA,WAAKtL,EAAL,CAAQ2B,UAAR,GAAmB2J,KAAK1J,SAAxB;AACA,WAAK3B,EAAL,CAAQmB,OAAR,CAAgB,6BAAmBkK,KAAK1J,SAAxB,CAAhB;AACA,aAAO,IAAP;AACD;;;cAvEM3C,SAAS;;;;;;;;;;;;;;;;;;MCDLsT,wBAAAA;AAGX,2BAAYtS,EAAZ,EAAeD,EAAf,EAAmB;AAAA;;AAAA;;AACjB,WAAKC,EAAL,GAAUA,EAAV;AACA,WAAKD,EAAL,GAAQA,EAAR;;AAEA,WAAKC,EAAL,CAAQE,SAAR,4BAAkC;AAAA,eAAM,MAAKyJ,aAAL,CAAmBvJ,IAAIiF,OAAvB,CAAN;AAAA,OAAlC;AACA,WAAKrF,EAAL,CAAQE,SAAR,4BAAkC;AAAA,eAAO,MAAKe,aAAL,CAAmBb,IAAII,OAAvB,CAAP;AAAA,OAAlC;AACD;;4BAIDwR,6BAAS7B,QAAQ8B,aAAaC,uBAAsB;AAClDvU,cAAQC,GAAR,CAAY,4BAAZ;AACA,UAAIuS,UAAUA,OAAOgC,SAArB,EAAgC;AAC9BxU,gBAAQC,GAAR,CAAY,+BAA6BuS,OAAOgC,SAAhD;AACA,aAAKC,aAAL,CAAmBjC,OAAOgC,SAA1B;AACD;AACD,UAAIhC,UAAUA,OAAOvK,SAArB,EAAgC;AAC9BjI,gBAAQC,GAAR,CAAY,+BAA6BuS,OAAOvK,SAAhD;AACA,aAAKyM,aAAL,CAAmBlC,OAAOvK,SAA1B;AACD;AACF;;4BAIDlI,+BAAW;AACTC,cAAQC,GAAR,CAAY,sBAAZ;AACA,WAAKsD,eAAL,GAAqB,KAAKnB,EAAL,CAAQgB,kBAAR,KAA6B,CAAlD;AAED;;4BAID4I,uCAActE,SAAS;AACrB,WAAKmE,eAAL,GAAqBnE,OAArB;AACA,WAAKoE,sBAAL,CAA4BpE,QAAQhF,EAApC;AACA,aAAO,IAAP;AACD;;4BAGDoJ,yDAAuBpJ,IAAI;AAEzB,WAAKK,iBAAL,GAAuBL,EAAvB;AACA,WAAK+R,aAAL;AACA,WAAKC,aAAL;AACD;;4BAKDD,uCAAcD,WAAU;AACtBxU,cAAQC,GAAR,CAAY,iCAAZ;AACA,WAAKmC,EAAL,CAAQ0B,kBAAR,CAA2B0Q,SAA3B;AACA,WAAKnS,EAAL,CAAQmB,OAAR,CAAgB,4BAAkBgR,SAAlB,CAAhB;AACA,WAAKnS,EAAL,CAAQmB,OAAR,CAAgB,qCAA2BgR,SAA3B,CAAhB;AACD;;4BAGDE,uCAAczM,WAAU;AACtBjI,cAAQC,GAAR,CAAY,iCAAZ;AACA,WAAKmC,EAAL,CAAQ6I,kBAAR,CAA2BhD,SAA3B;AACA,WAAK5F,EAAL,CAAQmB,OAAR,CAAgB,4BAAkByE,SAAlB,CAAhB;AAED;;4BAGD2M,+CAAmB,CAIlB;;4BAGDtR,uCAAcoK,MAAM;AAClB,WAAKnK,eAAL,GAAqBmK,IAArB;AACA,UAAI,CAACA,IAAL,EAAW;AAACjK,0BAAmB,OAAO,IAAP;AAAa;AAC5C,WAAKX,iBAAL,GAAuB4K,KAAKhL,EAA5B;AACA1C,cAAQC,GAAR,CAAY,eAAZ;AACAD,cAAQC,GAAR,CAAYyN,IAAZ;;AAGA,WAAKtL,EAAL,CAAQ2B,UAAR,GAAmB2J,KAAK1J,SAAxB;AACA,WAAK3B,EAAL,CAAQmB,OAAR,CAAgB,6BAAmBkK,KAAK1J,SAAxB,CAAhB;AACA,aAAO,IAAP;AACD;;4BAEDS,iCAAWC,MAAK;AACd1E,cAAQC,GAAR,CAAY,cAAZ;AACAD,cAAQC,GAAR,CAAYyE,IAAZ;AACD;;4BAEDT,yCAAgB;AAAA;;AACd,WAAK7B,EAAL,CAAQ6B,aAAR,CAAsB,KAAKnB,iBAA3B;AACAlE,WAAK,gBAAQ;AACX,eAAK6E,eAAL;AACA,YAAIG,IAAE,OAAKT,QAAL,CAAcpE,GAAd,CAAkB,UAASmF,CAAT,EAAY;AAAC,iBAAOA,EAAExB,EAAT;AAAa,SAA5C,EAA8CT,OAA9C,CAAsDzB,KAAKkC,EAA3D,CAAN;AACA,eAAKS,QAAL,CAAcgB,MAAd,CAAqBP,CAArB,EAAuB,CAAvB;AACAA,YAAE,OAAKtB,WAAL,CAAiBvD,GAAjB,CAAqB,UAASmF,CAAT,EAAY;AAAC,iBAAOA,EAAExB,EAAT;AAAa,SAA/C,EAAiDT,OAAjD,CAAyDzB,KAAKkC,EAA9D,CAAF;AACA,eAAKJ,WAAL,CAAiB6B,MAAjB,CAAwBP,CAAxB,EAA0B,CAA1B;AACD,OAND;AAOD;;;cArGMvC,SAAS;;;;;;;;;;;;;;;;;;MCDLwT,wBAAAA;AAGX,2BAAYxS,EAAZ,EAAeD,EAAf,EAAmB;AAAA;;AACjB,WAAKC,EAAL,GAAUA,EAAV;AACA,WAAKD,EAAL,GAAQA,EAAR;AAID;;4BAIDiS,6BAAS7B,QAAQ8B,aAAaC,uBAAsB;AAClDvU,cAAQC,GAAR,CAAY,4BAAZ;AACA,UAAIuS,UAAUA,OAAOgC,SAArB,EAAgC;AAC9B,aAAKC,aAAL,CAAmBjC,OAAOgC,SAA1B;AACD;AACF;;4BAIDzU,+BAAW;AACTC,cAAQC,GAAR,CAAY,sBAAZ;AACA,WAAKsD,eAAL,GAAqB,KAAKnB,EAAL,CAAQgB,kBAAR,KAA6B,CAAlD;AAED;;4BAIDqR,uCAAcD,WAAU;AACtBxU,cAAQC,GAAR,CAAY,iCAAZ;AACA,WAAKmC,EAAL,CAAQ0B,kBAAR,CAA2B0Q,SAA3B;AACA,WAAKnS,EAAL,CAAQmB,OAAR,CAAgB,4BAAkBgR,SAAlB,CAAhB;AACA,WAAKnS,EAAL,CAAQmB,OAAR,CAAgB,qCAA2BgR,SAA3B,CAAhB;AACD;;4BAGDlR,uCAAcoK,MAAM;AAClB,WAAKnK,eAAL,GAAqBmK,IAArB;AACA,UAAI,CAACA,IAAL,EAAW;AAACjK,0BAAmB,OAAO,IAAP;AAAa;AAC5C,WAAKX,iBAAL,GAAuB4K,KAAKhL,EAA5B;AACA1C,cAAQC,GAAR,CAAY,eAAZ;AACAD,cAAQC,GAAR,CAAYyN,IAAZ;;AAGA,WAAKtL,EAAL,CAAQ2B,UAAR,GAAmB2J,KAAK1J,SAAxB;AACA,WAAK3B,EAAL,CAAQmB,OAAR,CAAgB,6BAAmBkK,KAAK1J,SAAxB,CAAhB;AACA,aAAO,IAAP;AACD;;4BAEDS,iCAAWC,MAAK;AACd1E,cAAQC,GAAR,CAAY,cAAZ;AACAD,cAAQC,GAAR,CAAYyE,IAAZ;AACD;;4BAEDT,yCAAgB;AAAA;;AACd,WAAK7B,EAAL,CAAQ6B,aAAR,CAAsB,KAAKnB,iBAA3B;AACAlE,WAAK,gBAAQ;AACX,cAAK6E,eAAL;AACA,YAAIG,IAAE,MAAKT,QAAL,CAAcpE,GAAd,CAAkB,UAASmF,CAAT,EAAY;AAAC,iBAAOA,EAAExB,EAAT;AAAa,SAA5C,EAA8CT,OAA9C,CAAsDzB,KAAKkC,EAA3D,CAAN;AACA,cAAKS,QAAL,CAAcgB,MAAd,CAAqBP,CAArB,EAAuB,CAAvB;AACAA,YAAE,MAAKtB,WAAL,CAAiBvD,GAAjB,CAAqB,UAASmF,CAAT,EAAY;AAAC,iBAAOA,EAAExB,EAAT;AAAa,SAA/C,EAAiDT,OAAjD,CAAyDzB,KAAKkC,EAA9D,CAAF;AACA,cAAKJ,WAAL,CAAiB6B,MAAjB,CAAwBP,CAAxB,EAA0B,CAA1B;AACD,OAND;AAOD;;;cAhEMvC,SAAS;;;;;;;;;;;;;;;;;;MCFLyT,yBAAAA;AAEX,4BAAYzS,EAAZ,EAAgB;AAAA;;AAAA;;AACd,WAAKA,EAAL,GAAUA,EAAV;AACArC,cAAQC,GAAR,CAAY,kBAAZ;;AAGA,WAAKkD,QAAL,GAAc,CAAC,EAAClE,MAAK,YAAN,EAAmBgP,MAAK,MAAxB,EAA+BL,MAAK,YAApC,EAAD,EACZ,EAAC3O,MAAK,WAAN,EAAkBgP,MAAK,MAAvB,EAA8BL,MAAK,YAAnC,EADY,EAEZ,EAAC3O,MAAK,WAAN,EAAkBgP,MAAK,MAAvB,EAA8BL,MAAK,YAAnC,EAFY,EAGZ,EAAC3O,MAAK,WAAN,EAAkBgP,MAAK,OAAvB,EAA+BL,MAAK,YAApC,EAHY,EAIZ,EAAC3O,MAAK,UAAN,EAAiBgP,MAAK,OAAtB,EAA8BL,MAAK,YAAnC,EAJY,EAKZ,EAAC3O,MAAK,UAAN,EAAiBgP,MAAK,OAAtB,EAA8BL,MAAK,YAAnC,EALY,CAAd;AAMA,WAAKrD,aAAL,GAAmB,EAAnB;AACA,WAAKwK,WAAL,GAAiB,EAAjB;AACA,WAAKC,SAAL,GAAe,EAAf;AACA,WAAKC,cAAL,GAAoB,IAApB;AACA,WAAK5S,EAAL,CAAQE,SAAR,sBAA4B;AAAA,eAAM,MAAK2S,YAAL,CAAkBzS,IAAIuB,SAAtB,CAAN;AAAA,OAA5B;AACA,WAAKmR,cAAL,GAAoB,KAApB;AACD;;6BAEDpV,+BAAW,CAEV;;6BAEDmV,qCAAa7N,KAAK;AAChBrH,cAAQC,GAAR,CAAY,gBAAZ;AACAD,cAAQC,GAAR,CAAYoH,GAAZ;AACA,WAAK2N,SAAL,GAAe3N,GAAf;AACA,WAAK+N,iBAAL,GAAyB,IAAzB;AACD;;6BAEDC,iCAAW3H,MAAM;AACf1N,cAAQC,GAAR,CAAY,UAAZ,EAAuByN,IAAvB;AACD;;6BAED4H,qCAAc;AACZ,WAAKL,cAAL,GAAoB,KAApB;AACD;;6BAEDM,yCAAe;AACb,WAAKN,cAAL,GAAoB,IAApB;AACD;;6BACDO,iCAAW9H,MAAK;AACd,UAAI+H,eAAe,KAAKtS,QAAL,CAAclB,OAAd,CAAsByL,IAAtB,CAAnB;AACA,UAAI+H,gBAAe,CAAnB,EAAuB,KAAKtS,QAAL,CAAcgB,MAAd,CAAqBsR,YAArB,EAAkC,CAAlC;AACxB;;6BAEDC,iDAAmBhI,MAAM;AACvB1N,cAAQC,GAAR,CAAY,eAAZ;AACAD,cAAQC,GAAR,CAAYyN,IAAZ;AACD;;6BAEDiI,iDAAmBjI,MAAK;AACtB1N,cAAQC,GAAR,CAAY,eAAZ;AACAD,cAAQC,GAAR,CAAYyN,IAAZ;AACA,UAAI9J,IAAI,KAAK2G,aAAL,CAAmBtI,OAAnB,CAA2ByL,IAA3B,CAAR;AACA,WAAKnD,aAAL,CAAmBpG,MAAnB,CAA0BP,CAA1B,EAA4B,CAA5B;AACD;;6BAEDgS,2BAAQ1E,OAAM;AAAA;;AACZlR,cAAQC,GAAR,CAAY,SAAZ;AACAD,cAAQC,GAAR,CAAYiR,MAAM2E,YAAN,CAAmB/I,KAA/B;AACAoE,YAAM4E,eAAN;AACA5E,YAAM6E,cAAN;AACA,6BAAKxL,aAAL,EAAmB4B,OAAnB,uBAA8B+E,MAAM2E,YAAN,CAAmB/I,KAAjD;AACA,aAAO,IAAP;AACD;;6BAEDkJ,2BAAQ9E,OAAM;AACZ,aAAO,IAAP;AACD;;6BAED+E,mCAAY/E,OAAM;AAAA;;AAChBlR,cAAQC,GAAR,CAAY,eAAZ;AACAD,cAAQC,GAAR,CAAYiR,MAAMgF,MAAN,CAAapJ,KAAzB;;AAEA,8BAAKvC,aAAL,EAAmB4B,OAAnB,wBAA8B+E,MAAMgF,MAAN,CAAapJ,KAA3C;AAED;;6BAEDqJ,+BAAUjF,OAAO;AAAA;;AACflR,cAAQC,GAAR,CAAY,WAAZ;AACAD,cAAQC,GAAR,CAAYiR,MAAMgF,MAAN,CAAapJ,KAAzB;AACA,8BAAKvC,aAAL,EAAmB4B,OAAnB,wBAA8B+E,MAAMgF,MAAN,CAAapJ,KAA3C;AACD;;6BAEDsJ,uCAAc;AAAA;;AAEZ,wBAAKjT,QAAL,EAAcgJ,OAAd,kBAAyB,KAAK5B,aAA9B;AACA,WAAKA,aAAL,GAAmB,EAAnB;AACD;;6BACD8L,uBAAM;AACJ,WAAKlB,cAAL,GAAoB,IAApB;AACD;;;cA7FM9T,SAAS;;;;;;;;;;;;;;;MCLLuR,oBAAAA;;;;;;;;;;;;;;;;;;;;MCEA0D,qBAAAA,+BAEX,oBAAYlU,EAAZ,EAAgB;AAAA;;AACd,SAAKA,EAAL,GAAUA,EAAV;AACD,YAHMf,SAAS;;;;;;;;;;;;;;;;;;MCDLkV,0BAAAA;AAGX,6BAAYnU,EAAZ,EAAgB;AAAA;;AACdpC,cAAQC,GAAR,CAAY,mBAAZ;AACA,WAAKuW,QAAL,GAAgB,EAAhB;AACA,WAAKrT,QAAL,GAAc,EAAd;AACA,WAAKoH,aAAL,GAAmB,EAAnB;AACA,WAAKwK,WAAL,GAAiB,EAAjB;AACA,WAAKC,SAAL,GAAe,EAAf;AACA,WAAKyB,aAAL,GAAmB,IAAnB;AACA,WAAKC,eAAL,GAAqB,EAArB;AACA,WAAKtU,EAAL,GAAUA,EAAV;AACD;;8BAEDrC,+BAAW;AAAA;;AACT,WAAKqC,EAAL,CAAQgJ,QAAR,GACGxM,IADH,CACQ,gBAAQ;AAAE,cAAK4X,QAAL,GAAgBhW,IAAhB;AAAsB,OADxC;AAED;;8BAED6U,iCAAW3H,MAAM;AACf1N,cAAQC,GAAR,CAAY,UAAZ,EAAuByN,IAAvB;AACD;;8BAEDiJ,uCAAcC,SAAS;AACrB,WAAKH,aAAL,GAAmB,KAAnB;AACA,WAAKC,eAAL,GAAuBE,OAAvB;AACD;;8BACDC,6CAAiB;AACf,WAAKJ,aAAL,GAAmB,IAAnB;AACD;;8BACDjB,iCAAW9H,MAAK;AACd,UAAI+H,eAAe,KAAKtS,QAAL,CAAclB,OAAd,CAAsByL,IAAtB,CAAnB;AACA,UAAI+H,gBAAe,CAAnB,EAAuB,KAAKtS,QAAL,CAAcgB,MAAd,CAAqBsR,YAArB,EAAkC,CAAlC;AACxB;;8BAEDC,iDAAmBhI,MAAM;AACvB1N,cAAQC,GAAR,CAAY,eAAZ;AACAD,cAAQC,GAAR,CAAYyN,IAAZ;AACD;;8BAEDiI,iDAAmBjI,MAAK;AACtB1N,cAAQC,GAAR,CAAY,eAAZ;AACAD,cAAQC,GAAR,CAAYyN,IAAZ;AACF,UAAI9J,IAAI,KAAK2G,aAAL,CAAmBtI,OAAnB,CAA2ByL,IAA3B,CAAR;AACE,WAAKnD,aAAL,CAAmBpG,MAAnB,CAA0BP,CAA1B,EAA4B,CAA5B;AACD;;8BAEDgS,2BAAQ1E,OAAM;AAAA;;AACZlR,cAAQC,GAAR,CAAY,SAAZ;AACAD,cAAQC,GAAR,CAAYiR,MAAM2E,YAAN,CAAmB/I,KAA/B;AACAoE,YAAM4E,eAAN;AACA5E,YAAM6E,cAAN;AACA,6BAAKxL,aAAL,EAAmB4B,OAAnB,uBAA8B+E,MAAM2E,YAAN,CAAmB/I,KAAjD;AACA,aAAO,IAAP;AACD;;8BAEDkJ,2BAAQ9E,OAAM;AACZ,aAAO,IAAP;AACD;;8BAED+E,mCAAY/E,OAAM;AAAA;;AAChBlR,cAAQC,GAAR,CAAY,eAAZ;AACAD,cAAQC,GAAR,CAAYiR,MAAMgF,MAAN,CAAapJ,KAAzB;;AAEA,8BAAKvC,aAAL,EAAmB4B,OAAnB,wBAA8B+E,MAAMgF,MAAN,CAAapJ,KAA3C;AAED;;8BAEDqJ,+BAAUjF,OAAO;AAAA;;AACflR,cAAQC,GAAR,CAAY,WAAZ;AACAD,cAAQC,GAAR,CAAYiR,MAAMgF,MAAN,CAAapJ,KAAzB;AACA,8BAAKvC,aAAL,EAAmB4B,OAAnB,wBAA8B+E,MAAMgF,MAAN,CAAapJ,KAA3C;AACD;;8BAEDsJ,uCAAc;AAAA;;AAEZ,wBAAKjT,QAAL,EAAcgJ,OAAd,kBAAyB,KAAK5B,aAA9B;AACA,WAAKA,aAAL,GAAmB,EAAnB;AACD;;;cA9EMlJ,SAAS;;;;;;;;;;;;;;;;;;MCALyV,oBAAAA;AAEX,uBAAa1U,EAAb,EAAgBoC,MAAhB,EAAuB;AAAA;;AACrB,WAAKpC,EAAL,GAAQA,EAAR;AACA,WAAK9C,UAAL,GAAgBkF,MAAhB;AACD;;wBAEDzE,+BAAW;AACT,WAAKwK,aAAL,GAAoB,KAAKnI,EAAL,CAAQmI,aAA5B;AACA,WAAK1H,OAAL,GAAa,KAAKT,EAAL,CAAQmB,eAArB;AACA,WAAKqO,SAAL,GAAe,KAAf;AACA,WAAKmF,MAAL,GAAY,EAAZ;AACD;;wBAEDC,qCAAa;AAAA;;AACXhX,cAAQC,GAAR,CAAY,yBAAZ;AACAD,cAAQC,GAAR,CAAY,KAAKsK,aAAjB;AACAvK,cAAQC,GAAR,CAAY,KAAK4C,OAAjB;AACA,UAAIwN,OAAQ3J,OAAOyD,QAAP,CAAgBkG,IAAhB,IAAwB,EAAxB,IAA8B3J,OAAOyD,QAAP,CAAgBkG,IAAhB,IAAsB,IAApD,IAA4D3J,OAAOyD,QAAP,CAAgBkG,IAAhB,IAAwB,KAArF,GAA6F,EAA7F,GAAiG,MAAI3J,OAAOyD,QAAP,CAAgBkG,IAAhI;AACA,WAAKc,QAAL,GAAgBzK,OAAOyD,QAAP,CAAgBqG,QAAhB,GAA0B,IAA1B,GAA+B9J,OAAOyD,QAAP,CAAgBsG,QAA/C,GAAwDJ,IAAxD,GAA6D,KAAKxN,OAAL,CAAa2M,IAA1F;;AALW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA,YAMF9K,IANE;;AAOT,cAAKpF,UAAL,CAAgBc,KAAhB,CAAsB,MAAKyC,OAAL,CAAamB,SAAb,GAAuBU,KAAKzF,IAAlD,EAAwD,EAACgC,QAAO,KAAR,EAAcC,MAAKwD,IAAnB,EAAxD,EAAkF9F,IAAlF,CAAuF,oBACvF;AACE,gBAAKmY,MAAL,IAAarS,KAAKzF,IAAL,GAAU,UAAvB;AACAe,kBAAQC,GAAR,CAAY,WAAZ,EAAwBI,QAAxB;AACD,SAJD,EAIGI,KAJH,CAIS,iBAAS;AAChB,gBAAKsW,MAAL,IAAarS,KAAKzF,IAAL,GAAU,aAAvB;AACAe,kBAAQC,GAAR,CAAY,cAAZ,EAA2BS,KAA3B;AACC,SAPH;AAPS;;AAMX,2BAAiB,KAAK6J,aAAtB,kHAAqC;AAAA;;AAAA;;AAAA;AAUpC;AACD,WAAKqH,SAAL,GAAe,IAAf;AAED;;;cAhCMvQ,SAAS;;;;;;;;;;;;;;;;;;MCFL4V,uBAAAA;AAGX,0BAAa7U,EAAb,EAAiB;AAAA;;AACf,WAAKA,EAAL,GAAQA,EAAR;AACA,WAAKmI,aAAL,GAAmB,EAAnB;AACA,WAAK2M,aAAL,GAAmB,EAAnB;AACD;;2BAEDnX,+BAAW;AACTC,cAAQC,GAAR,CAAY,yBAAZ;AACA,WAAKsK,aAAL,GAAmB,EAAnB;AACA,WAAKA,aAAL,GAAoB,KAAKnI,EAAL,CAAQmI,aAA5B;AACD;;2BAEDuF,+BAAW;AACT9P,cAAQC,GAAR,CAAY,0BAAZ;AACAD,cAAQC,GAAR,CAAY,KAAKsK,aAAjB;AACA,WAAKnI,EAAL,CAAQmI,aAAR,GAAsB,KAAKA,aAA3B;AACD;;2BAEDoL,iDAAmBjI,MAAK;AACtB1N,cAAQC,GAAR,CAAY,eAAZ;AACAD,cAAQC,GAAR,CAAYyN,IAAZ;AACA,UAAI9J,IAAI,KAAK2G,aAAL,CAAmBtI,OAAnB,CAA2ByL,IAA3B,CAAR;AACA,WAAKnD,aAAL,CAAmBpG,MAAnB,CAA0BP,CAA1B,EAA4B,CAA5B;AACD;;2BAEDgS,2BAAQ1E,OAAM;AAAA;;AACZlR,cAAQC,GAAR,CAAY,SAAZ;AACAD,cAAQC,GAAR,CAAYiR,MAAM2E,YAAN,CAAmB/I,KAA/B;AACAoE,YAAM4E,eAAN;AACA5E,YAAM6E,cAAN;AACA,6BAAKxL,aAAL,EAAmB4B,OAAnB,uBAA8B+E,MAAM2E,YAAN,CAAmB/I,KAAjD;AACA,aAAO,IAAP;AACD;;2BAEDkJ,2BAAQ9E,OAAM;AACZ,aAAO,IAAP;AACD;;2BAED+E,mCAAY/E,OAAM;AAAA;;AAChBlR,cAAQC,GAAR,CAAY,eAAZ,EAA4BiR,KAA5B,EAAkC,KAAK8D,SAAvC;;AAEA,8BAAKzK,aAAL,EAAmB4B,OAAnB,wBAA8B+E,MAAMgF,MAAN,CAAapJ,KAA3C;AACA9M,cAAQC,GAAR,CAAY,eAAZ,EAA4B,KAAKsK,aAAjC;AAED;;2BAED4L,+BAAUjF,OAAO;AAAA;;AACflR,cAAQC,GAAR,CAAY,WAAZ,EAAwBiR,KAAxB,EAA8B,KAAK6D,WAAnC;;AAEE,8BAAKxK,aAAL,EAAmB4B,OAAnB,wBAA8B+E,MAAMgF,MAAN,CAAapJ,KAA3C;;AAEF9M,cAAQC,GAAR,CAAY,eAAZ,EAA4B,KAAKsK,aAAjC;AACD;;2BAED6L,uCAAc;AAAA;;AAEZpW,cAAQC,GAAR,CAAY,gBAAZ;AACA,6BAAKiX,aAAL,EAAmB/K,OAAnB,uBAA8B,KAAK5B,aAAnC;AACA,WAAKA,aAAL,GAAmB,EAAnB;AACD;;2BAED8K,iCAAW3H,MAAM;AACf1N,cAAQC,GAAR,CAAY,UAAZ,EAAuByN,IAAvB;AACD;;2BAED8H,iCAAW9H,MAAK;AACd,UAAI+H,eAAe,KAAKyB,aAAL,CAAmBjV,OAAnB,CAA2ByL,IAA3B,CAAnB;AACA,UAAI+H,gBAAe,CAAnB,EAAuB,KAAKyB,aAAL,CAAmB/S,MAAnB,CAA0BsR,YAA1B,EAAuC,CAAvC;AACxB;;;cAtEMpU,SAAS;;;;;;;;;;;;;;;;;;MCEL8V,0BAAAA;AAEX,6BAAY9U,EAAZ,EAAe+U,EAAf,EAAkBhV,EAAlB,EAAqB;AAAA;;AAAA;;AACnB,WAAKC,EAAL,GAAUA,EAAV;AACA,WAAKvE,MAAL,GAAcsZ,EAAd;AACA,WAAKhV,EAAL,GAASA,EAAT;AACA,WAAKC,EAAL,CAAQE,SAAR,4BAAkC;AAAA,eAAM,MAAKgB,eAAL,CAAqBd,IAAII,OAAzB,CAAN;AAAA,OAAlC;AACD;;8BAEDU,2CAAgBV,SAAS;AACvB7C,cAAQC,GAAR,CAAY,mCAAZ;AACA,WAAKmC,EAAL,CAAQmB,eAAR,GAAwBV,OAAxB;AACA,WAAK/E,MAAL,CAAYuZ,QAAZ,CAAqB,cAArB;AACD;;;cAZMhW,SAAS;;;;;;;;;;;;;;;;;;MCHLiW,uBAAAA;AAGX,0BAAYlV,EAAZ,EAAgB;AAAA;;AACd,WAAKoU,QAAL,GAAgB,EAAhB;AACA,WAAKpU,EAAL,GAAUA,EAAV;AACF;;2BAEArC,+BAAU;AAAA;;AAER,WAAKqC,EAAL,CAAQgJ,QAAR,GACExM,IADF,CACO,gBAAQ;AAAE,cAAK4X,QAAL,GAAgBhW,IAAhB;AAAsB,OADvC;AAEF;;2BAED+W,iCAAWC,MAAK;AACb,WAAKpV,EAAL,CAAQoI,YAAR,GAAqBgN,IAArB;AACA,aAAO,IAAP;AACF;;;cAhBOnW,SAAS","file":"app-bundle.js","sourcesContent":["export class App {\n\n  configureRouter(config, router) {\n    config.title = 'West-Life Repository Router';\n  }\n\n  login() {\n    //window.location=\"login.html?next\"+window.location.pathname;\n  }\n\n}\n","export default {\n  debug: true,\n  testing: true\n};\n","//Configure Bluebird Promises not to throw warnings about aurelia empty promises\nPromise.config({\n  warnings: {\n    wForgottenReturn: false\n  }\n});\n\nexport function configure(aurelia) {\n  aurelia.use\n    .standardConfiguration()\n    .feature('resources');\n  aurelia.start().then(() => aurelia.setRoot());\n\n  }\n","export class Repositoryapp {\n\n  configureRouter(config, router) {\n    config.title = 'West-Life Repository Router';\n\n    config.map([\n      {route: ['', 'dashboard'], name: 'dashboard', moduleId: 'scientist/dashboard', nav: true, title: 'Visitor Dashboard'},\n      {route: 'dashboard/project/:projectid/', name: 'projectdetail', moduleId: 'scientist/dashboarddetail'},\n      {route: 'dashboard/dataset/:datasetid/', name: 'datasetdetail', moduleId: 'scientist/dashboarddetail'},\n      {route: 'createdataset', name: 'createdataset', moduleId: 'scientist/createdataset', nav: true, title: 'Create Empty Dataset'},\n      {route: 'repositorytovf', name: 'repositorytovf', moduleId: 'scientist/repositorytovf', nav: true, title: 'Upload to Virtual Folder'}\n    ]);\n    this.router = router;\n  }\n\n  login() {\n    //window.location=\"login.html?next\"+window.location.pathname;\n  }\n\n}\n","//Configure Bluebird Promises not to throw warnings about aurelia empty promises\nPromise.config({\n  warnings: {\n    wForgottenReturn: false\n  }\n});\n\nexport function configure(aurelia) {\n  aurelia.use\n    .standardConfiguration()\n    .feature('resources');\n  aurelia.start().then(() => aurelia.setRoot('repositoryapp'));\n}\n","export class Staffapp {\n\n  configureRouter(config, router) {\n    config.title = 'West-Life Repository Router';\n    config.map([\n      {route: ['', 'dashboard'], name: 'dashboard', moduleId: 'staff/dashboard', nav: true, title: 'Staff Dashboard'},\n      {route: 'upselectuser', name: 'upselectuser', moduleId: 'staff/upselectuser', nav: true, title: 'Upload - Select Visitor User'},\n      {route: 'upselectdataset', name: 'upselectdataset', moduleId: 'staff/upselectdataset', nav: true, title: 'Upload - Select/create target dataset'},\n      {route: 'upselectdata', name: 'upselectdata', moduleId: 'staff/upselectdata', nav: true, title: 'Upload - Select data'},\n      {route: 'upconfirm', name: 'upconfirm', moduleId: 'staff/upconfirm', nav: true, title: 'Upload - Confirmation'}\n    ]);\n    this.router = router;\n\n  }\n\n}\n","Promise.config({\n  warnings: {\n    wForgottenReturn: false\n  }\n});\n\nexport function configure(aurelia) {\n  aurelia.use\n    .standardConfiguration()\n    .feature('resources');\n  aurelia.start().then(() => aurelia.setRoot('staffapp'));\n}\n","import {HttpClient,json} from 'aurelia-fetch-client';\n\n\n/* Provides methods to return promise of data from REST Project api*/\nexport class Ariaapi {\n  static inject = [HttpClient];\n\n  constructor(httpclient) {\n    this.httpclient=httpclient;\n    this.httpclient.configure(config => {\n      config\n        .rejectErrorResponses()\n        .withDefaults({\n          credentials: 'same-origin',\n          headers: {\n\n            'Accept': 'application/json',\n            'Content-Type': 'application/json'\n          }\n        })\n    });\n    //needs SSO credentials\n    this.proposallisturl = \"https://www.structuralbiology.eu/ws/oauth/proposallist\";\n    this.proposalurl = \"https://www.structuralbiology.eu/ws/oauth/proposal\";\n    this.accesstokenserviceurl=\"/ariademo/accessToken.php\";\n    this.accesstoken=null;\n  }\n\n  attached() {\n    console.log('ariaapi.attached()');\n  }\n\n  created() {\n    console.log('ariaapi.created()');\n  }\n\n  getProposal() {\n      return this.httpclient.fetch(this.proposalurl)\n        .then(response => response.json())\n        .then(data => {\n          this.proposal=data;\n          return data;\n        })\n        .catch(error => {\n          console.log(error);\n        });\n  }\n\n  getAriaLink() {\n    return this.httpclient.fetch(this.accesstokenserviceurl)\n      .then(response => response.json())\n      .then(data => {\n        return data;\n      })\n      .catch(error => {\n        console.log(error);\n      });\n  }\n\n  getAccessToken(code,state){\n    console.log(\"Ariaapi.getAccessToken()\");\n    return this.httpclient.fetch(this.accesstokenserviceurl+\"?code=\"+code+\"&state=\"+state)\n      .then(response => response.json())\n      .then(data => {\n        console.log(\"ariaapi.getaccesstoken() returned:\");\n        console.log(data);\n        this.accesstoken=data;\n        return data;\n      })\n      .catch(error => {\n        console.log(error);\n      });\n  }\n\n  getProposalList() {\n    if (this.accesstoken && this.accesstoken.access_token) {\n      return this.httpclient.fetch( this.proposallisturl,{\n          method:\"POST\",\n          body:json({access_token:this.accesstoken.access_token,aria_response_format:'json'})\n        })\n          .then(response => response.json())\n          .then(data => {\n            this.proposallist= data\n            return data\n          })\n          .catch(error => {\n            console.log(error);\n          });\n      }\n\n  }\n\n}\n","//import {HttpClient,json} from 'aurelia-fetch-client';\nimport {HttpClient} from 'aurelia-http-client';\n\n/* Provides methods to return promise of data from REST Project api*/\nexport class Ariaapi {\n  static inject = [HttpClient];\n\n  constructor(httpclient) {\n    this.httpclient=httpclient;\n    /*this.httpclient.configure(config=> {\n      config.withHeader('Accept', 'application/json');\n      config.withHeader('Content-Type', 'application/json');\n    });*/\n\n    //needs SSO credentials\n    this.proposallisturl = \"https://www.structuralbiology.eu/ws/oauth/proposallist\";\n    this.proposalurl = \"https://www.structuralbiology.eu/ws/oauth/proposal\";\n    this.accesstokenserviceurl=\"/ariademo/accessToken.php\";\n    this.accesstoken=null;\n  }\n\n  attached() {\n    console.log('ariaapi.attached()');\n  }\n\n  created() {\n    console.log('ariaapi.created()');\n  }\n\n  getProposal(pid) {\n//    return this.httpclient.fetch(this.proposalurl)\n      return this.httpclient.get(this.proposalurl+\"?access_token=\"+this.accesstoken.access_token+\"&aria_show_all=true&aria_pid=\"+pid)\n\n        .then(data => {\n          console.log(\"ariaapixhr.getProposal()\");\n          console.log(data);\n          this.proposal=JSON.parse(data.response);\n          return this.proposal;\n        })\n        .catch(error => {\n          console.log(error);\n        });\n  }\n\n  getAriaLink() {\n/*    return this.httpclient.fetch(this.accesstokenserviceurl)\n      .then(response => response.json())\n      .then(data => {\n        return data;\n      })\n      .catch(error => {\n        console.log(error);\n      });*/\n    return this.httpclient.get(this.accesstokenserviceurl).then(data =>\n    {\n      console.log(\"getAriaLink()\");\n      console.log(data);\n      return JSON.parse(data.response);\n    })\n\n  }\n\n  getAccessToken(code,state){\n    console.log(\"Ariaapi.getAccessToken()\");\n//    return this.httpclient.fetch(this.accesstokenserviceurl+\"?code=\"+code+\"&state=\"+state)\n    return this.httpclient.get(this.accesstokenserviceurl+\"?code=\"+code+\"&state=\"+state)\n      .then(data => {\n        console.log(\"ariaapi.getaccesstoken() returned:\");\n        console.log(data);\n        this.accesstoken=JSON.parse(data.response);\n        return this.accesstoken;\n      })\n      .catch(error => {\n        console.log(error);\n      });\n  }\n\n  getProposalList() {\n    if (this.accesstoken && this.accesstoken.access_token) {\n//      return this.httpclient.fetch( this.proposallisturl,{\n      return this.httpclient.get( this.proposallisturl+\"?access_token=\"+this.accesstoken.access_token)\n\n          .then(data => {\n            console.log(\"ariaapixhr.getProposalList()\");\n            console.log(data);\n            this.proposallistwrapper= JSON.parse(data.response);\n            return this.proposallistwrapper.proposals\n          })\n          .catch(error => {\n            console.log(\"ariaapixhr.getProposalList() error\");\n            console.log(error);\n            throw error;\n          });\n      }\n\n  }\n}\n","import {Interceptor, HttpResponseMessage, RequestMessage} from \"aurelia-fetch-client\";\n\nexport class Csrfheaderinterceptor { //implements Interceptor {\n  constructor() {\n    this.TOKEN_HEADER = 'X-CSRF-TOKEN';\n    this.latestCsrfToken;\n  }\n  response(response) {\n    console.log(\"csrfheaderinterceptor, headers:\")\n    console.log(response.headers)\n    if (response.headers.has(this.TOKEN_HEADER)) {\n      this.latestCsrfToken = response.headers.get(this.TOKEN_HEADER);\n    }\n    return response;\n  }\n\n  request(request) {\n    if (this.latestCsrfToken) {\n      console.log(request)\n      console.log(this.latestCsrfToken)\n      if (['POST', 'PUT', 'PATCH'].indexOf(request.method) >= 0) {\n        request.headers.add(this.TOKEN_HEADER, this.latestCsrfToken);\n      }\n    }\n    return request;\n  }\n\n}\n","import {ProjectApi} from '../components/projectapi';\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {\n  Selecteddataset, FilterDataset, FilterDatasetByProject, FilterProjectByDataset,\n  Webdavresource, Adddataset\n} from \"./messages\";\nimport {bindable} from 'aurelia-framework';\n\nexport class Datasettable {\n  static inject = [ProjectApi,EventAggregator];\n  @bindable userid;\n\n  constructor(pa,ea) {\n    this.pa=pa;\n    this.alldatasets = [];\n    //this.showDatasets =true;\n    this.ea=ea;\n    this.ea.subscribe(FilterDataset,msg =>this.filterSelectedDataset(msg.id));\n    this.ea.subscribe(FilterDatasetByProject,msg =>this.filterProjectDatasets(msg.id));\n    this.ea.subscribe(Adddataset,msg=> this.addDataset(msg.dataset));\n    this.selectedDatasetId=0;\n    this.selectedProjectId=0;\n  }\n\n  attached() {\n    console.log(\"datasettable attached()\");\n  }\n\n  bind() {\n    console.log(\"datasettable bind()\",this.userid);\n    this.pa.getDatasets(this.userid).then(data => {\n      this.alldatasets = data;\n      this.datasets=this.alldatasets;\n      this.selectedDatasetId=this.pa.getSelectedDataset();\n      if (this.selectedDatasetId>0) this.filterSelectedDataset(this.selectedDatasetId);\n      if (this.selectedProjectId>0) this.filterProjectDatasets2(this.selectedProjectId);\n    });\n  }\n/*\n  activate(params, routeConfig, navigationInstruction){\n    console.log(\"Visitingscientist activate()\")\n    if (params && params.datasetid) {\n      this.filterSelectedDataset(params.datasetid);\n    }\n  }\n  */\n\n  selectDataset(dataset){\n    console.log(\"selectDataset() sending signal\");\n    console.log(dataset)\n    this.selectedDataset=dataset;\n    this.ea.publish(new Selecteddataset(dataset));\n    //if (dataset) this.ea.publish(new Webdavresource(dataset.webdavurl));\n    return true;\n\n  }\n  deselectDataset(){\n\n    console.log(\"deselectDataset()\");\n    this.filterProjectDatasets(this.selectedDataset.projectId);\n    this.ea.publish(new Selecteddataset(null))\n    return true;\n  }\n\n\n  filterProjectDatasets2(id) {\n    //this.selectedProposal=item;\n    //this.selectedDatasetId=id;\n    //this.filterMyProject();\n    //get the selected dataset\n    this.selectedDataset=null;\n    this.selectedDatasetId=0;\n    this.selectedProjectId=id;\n    if (id==0) {\n      this.datasets=this.alldatasets;\n      return;\n    }\n    console.log(\"datasettable.filterProjectDatasets()\");\n    console.log(id);\n    console.log(this.alldatasets);\n    this.datasets=this.alldatasets.filter(i => i.projectId == id);\n    console.log(this.datasets)\n  }\n\n  filterProjectDatasets(id){\n    this.filterProjectDatasets2(id);\n  }\n\n  filterSelectedDataset(id){\n    this.selectedDatasetId=id;\n    if (id==0){\n      this.selectedDataset=null;\n      this.datasets=this.alldatasets;\n      return;\n    }\n    this.datasets=this.alldatasets.filter(i => i.id == id);\n    if (this.datasets.length>0){\n      this.selectedDataset=this.datasets[0];\n      this.pa.setSelectedProject(this.datasets[0].projectId);\n      this.ea.publish(new FilterProjectByDataset(this.datasets[0].projectId));\n      this.pa.dataseturl=this.datasets[0].webdavurl;\n      this.ea.publish(new Webdavresource(this.pa.dataseturl));\n    }\n  }\n\n  deleteDataset() {\n    this.pa.deleteDataset(this.selectedDatasetId)\n      .then(data => {\n      this.deselectDataset();\n      //remove it from local arrays datasets and alldatasets\n      let i=this.datasets.map(function(e) {return e.id;}).indexOf(data);\n      this.datasets.splice(i,1);\n      i=this.alldatasets.map(function(e) {return e.id;}).indexOf(data);\n      this.alldatasets.splice(i,1);\n    })\n  }\n\n  addDataset(dataset) {\n    console.log(\"adddataset()\");\n    console.log(dataset);\n    this.datasets.push(dataset);\n  }\n\n}\n","/**\n * Created by Tomas Kulhanek on 2/17/17.\n */\n\nimport * as CodeMirror from \"codemirror\";\nimport \"codemirror/mode/clike/clike\";\nimport \"codemirror/mode/htmlmixed/htmlmixed\";\nimport \"codemirror/mode/javascript/javascript\";\n\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {HttpClient} from 'aurelia-fetch-client';\nimport {Editfile} from './messages';\nimport {Nmrapi} from './nmrapi';\nimport {bindable} from 'aurelia-framework';\n\n\n//import $ from 'jquery';\n\n\nexport class Fileeditor {\n  static inject = [EventAggregator, HttpClient,Nmrapi];\n  @bindable pid;\n\n  constructor(ea,httpclient,nmrapi) {\n    this.ea = ea;\n    this.client = httpclient;\n    this.nmrapi = nmrapi;\n    this.ea.subscribe(Editfile, msg => this.selectFile(msg.file));\n    this.isimage=false;\n    this.filename=\"\";\n    this.showtable=false;\n  }\n\n  attached() {\n    console.log(\"Fileeditor.attached()1\");\n    this.codemirror = CodeMirror.fromTextArea(this.cmTextarea, {\n      lineNumbers: true,\n      mode: \"text/x-less\",\n      lineWrapping: true\n    });\n    this.codemirror.refresh();\n    //sample data ofr table\n    this.data=[[\"no data for preview\",1],[1,1]];\n\n    //handsontable needs to be inlcuded in <script ...> of index.html page\n    this.ht2 = new Handsontable (this.filetable, {\n      data: this.data,\n      rowHeaders: true,\n      colHeaders: [\"R\",\"I\"],\n      autoWrapRow:true,\n      stretchH: \"all\",\n      autoResizeColumn: true\n\n    });\n    console.log(this.ht2);\n  }\n\n  selectFile(file) {\n    let that =this\n\n      this.imageurl = file.webdavurl;\n      //visualizeimg is set & image extension is detected\n      //vfstorage returns string - should convert to boolean\n      this.isimage =\n        ((file.name.endsWith('.JPG'))||\n          (file.name.endsWith('.jpg'))||\n          (file.name.endsWith('.PNG'))||\n          (file.name.endsWith('.png'))||\n          (file.name.endsWith('.GIF'))||\n          (file.name.endsWith('.gif'))||\n          (file.name.endsWith('.BMP'))||\n          (file.name.endsWith('.bmp'))||\n          (file.name.endsWith('.SVG'))||\n          (file.name.endsWith('.svg')));\n\n      //console.log(\"fileeditor.selectfile() visualizeimg: isimage:\")\n      //console.log(this.isimage);\n\n      /*get first 4 kB of data, if it is supported by web server in Range header */\n      if (!this.isimage)\n\n        this.client.fetch(file.webdavurl, {credentials: 'same-origin',headers:{'Range': 'bytes=0-4095'}})\n          .then(response => {\n            //have duplicate of blob and text\n            let response2= response.clone();\n            response.blob().then(data2 => {\n              that.data={};\n              let bindata= that.nmrapi.convert(data2,that.data,that.ht2);\n            })\n              response2.text().then(data => {\n                that.codemirror.setValue(data);\n                that.codemirror.refresh();\n                that.filename = file.webdavurl;\n              });\n            }\n          ).catch(error => {\n          alert('Error retrieving content from ' + file.webdavurl);\n          console.log(error);\n        });\n\n\n  }\n  //triggered when click on button\n  table() {\n    this.showtable= ! this.showtable;\n    //workaround - table width is incorect when rendered hidden\n    //render it after 100 ms again, usually after it is shown, thus calculating\n    //correct width\n    if (this.showtable) window.setTimeout(function(that){that.ht2.render()},100,this);\n  }\n\n}\n","import {Handsontable} from \"handsontable\";\n\nexport class htable {\n  attached(){\n    this.data = [[1,2],[1,3]];\n    this.ht = new Handsontable(this.idtable, {\n      data: this.data,\n      rowHeaders: true,\n      colHeaders: true\n    });\n  }\n}\n","import {Ariaapi} from '../components/ariaapi';\n\n/* Dashboard receives list of projects and list of datasets, in case the project or dataset is selected either by click or within url it is filtered */\nexport class Importaria {\n  static inject = [Ariaapi];\n  constructor(ariaapi){\n    this.ariaapi = ariaapi;\n    this.ariaurl = \"\";\n    this.showspinner=true;\n  }\n\n  attached () {\n    this.ariaapi.getAriaLink().then(\n      linkdata => {\n        console.log('importaria.attached() recieved linkdata');\n        console.log(linkdata);\n        this.ariaurl = linkdata.url;\n        this.showspinner=false;\n      }\n    )\n    //this.ariaurl=this.aoaservice+\n\n  }\n}\n","/**\n * Created by Tomas Kulhanek on 1/9/17.\n */\n\nexport class Webdavresource {\n  constructor(webdavurl){\n    this.webdavurl = webdavurl;\n  }\n}\n\nexport class Editfile {\n  constructor(file){\n    this.file = file;\n  }\n}\n\nexport class Uploaddir {\n  constructor(webdavurl){\n    this.webdavurl = webdavurl;\n  }\n}\n\nexport class Selectedproject {\n  constructor(project){\n    this.project = project;\n  }\n}\n\nexport class FilterProject {\n  constructor(id){\n    this.id = id;\n  }\n}\n\nexport class FilterDatasetByProject {\n  constructor(id){\n    this.id = id;\n  }\n}\n\nexport class FilterDataset {\n  constructor(id){\n    this.id = id;\n  }\n}\n\nexport class FilterProjectByDataset {\n  constructor(id){\n    this.id = id;\n  }\n}\n\nexport class Selecteddataset {\n  constructor(dataset){\n    this.dataset = dataset;\n  }\n}\nexport class Preselecteddataset {\n  constructor(datasetid){\n    this.datasetid = datasetid;\n  }\n}\n\nexport class Preselecteddatasets {\n  constructor(){\n  }\n}\n\nexport class Adddataset {\n  constructor(dataset){\n    this.dataset= dataset;\n  }\n}\n\nexport class Addproject {\n  constructor(project){\n    this.project= project;\n  }\n}\n","// defines some usefull methods which can be used by other related to handle NMR data\n\nexport class Nmrapi {\n  // converts blob e.g. from Response into byte array and float array in data\n  // data is reference to data object= {raw:Float32Array,ri:[[1,2],[1,3],...]}\n  // optional handsontable is reference to handsontable object, if it exists, it is updated\n  // with data.ri\n  convert(blob,data,handsontable) {\n    //convert blob to array of floats\n    let arrayBuffer;\n    let fileReader = new FileReader();\n\n    // define action at the end of reading\n    fileReader.addEventListener(\"loadend\", function() {\n      //console.log(\"fileeditor.convert() raw data read:\")\n      // store the read data\n      let uint8Array = new Uint8Array(fileReader.result);\n\n      // if it starts with '#' that will be probably nuts or jcamp format - ASCII until ctrl-z (#26) fid\n      if (uint8Array[0]===35) {\n        console.log('Jcamp or Nuts format detected - shift to CTRL-z')\n        let indexbindata=uint8Array.indexOf(26);\n        let uint82 = new Uint8Array(uint8Array,indexbindata+1);\n        data.raw = new Float32Array(uint82.buffer);\n      } else {\n        data.raw = new Float32Array(uint8Array.buffer);\n      }\n\n      // now convert rawdata into array of [[Real,Imaginary],[Real,Imaginary],..]\n      // which handsontable can visualize\n      data.ri = [];\n      for (let i=0;(i+1)<data.raw.length;i+=2){\n        //console.log(data.raw[i]);\n        //console.log(data.raw[i+1])\n        data.ri.push([data.raw[i],data.raw[i+1]]);\n      }\n      //update handsontable if it is defined\n      if (handsontable) handsontable.updateSettings({data:data.ri});\n    });\n    fileReader.readAsArrayBuffer(blob);\n  }\n\n}\n","import {HttpClient,json} from 'aurelia-fetch-client';\n//import {Csrfheaderinterceptor} from '../components/csrfheaderinterceptor';\n/* Provides methods to return promise of data from REST Project api*/\n\nexport class ProjectApi {\n  static inject = [HttpClient];\n\n\n  constructor(httpclient,ea) {\n    this.httpclient=httpclient;\n\n    //needs SSO credentials\n    let apiurl = \"restcon\";\n    //test fronted calls test backend uri - which has test authentication - test credentials added\n    //if (window.location.pathname.indexOf('repositorytest2')>0) apiurl = \"/restcontest2\";\n    //else if (window.location.pathname.indexOf('repositorytest')>0) apiurl = \"/restcontest\";\n    this.projecturl=apiurl+\"/project\";\n    this.dataurl=apiurl+\"/dataset\";\n    //this.userdataurl=apiurl+\"/user\";\n    this.copytaskurl=apiurl+\"/copytask\";\n    this.userinfourl=apiurl+\"/user\";\n    this.staffuserinfourl=apiurl+\"/user\";\n    //needs admin/staff credentials\n    this.usersurl=apiurl+\"/users\";//\"/admin/restcon/users\";\n    this.projects=[];\n    this.datasets=[];\n    console.log(\"projectapi\");\n    this.httpclient.configure(config => {\n      config\n        .rejectErrorResponses()\n        .withBaseUrl('')\n        .withDefaults({\n          credentials: 'same-origin',\n          headers: {\n            'Accept': 'application/json',\n            'X-Requested-With': 'Fetch'\n          }\n        })\n    });\n    this.selectedProjectId=0;\n    this.selectedDatasetId=0;\n    this.selecttedDataset={};\n    this.authurl=apiurl+\"/authsso\";\n    //is available if path contains two or more '/' e.g. /staff/\n    this.apiavailable=window.location.pathname.startsWith('/staff') || window.location.pathname.startsWith('/repository');\n    if (this.apiavailable)\n    this.httpclient.fetch(this.authurl,{method:\"POST\"}).catch(error=>alert(\"Backend service not running: \"+error.statusText));\n    //required by upselectdata and upconfirm\n    this.filestoupload=[];\n    this.selectedUser=null;\n  }\n\n  getUserProjects() {\n    return getProjects(this.selectedUser.Id);\n  }\n\n  getProjects(userid) {\n    console.log(\"projectapi,getProjects()\",userid);\n    let userprojecturl=(userid)?this.userinfourl+\"/\"+userid+\"/project\":this.projecturl;\n    //if the projects is already fetched - returns it, otherwise fetch\n    if (this.projects.length>0)\n      return new Promise(resolve => resolve(this.projects))\n    else\n      return this.httpclient.fetch(userprojecturl)\n      .then(response => response.json())\n      .then(data => {\n        this.projects= data;\n        return data\n      })\n      .catch(error => {\n        console.log(error);\n\n      });\n  }\n\n  setSelectedProject(id){\n    this.selectedProjectId=id;\n  }\n  getSelectedProject(){\n    return this.selectedProjectId;\n  }\n\n  getUserDatasets() {\n    return getDatasets(this.selectedUser.Id);\n  }\n\n  getDatasets(userid) {\n  //  await sleep(1000);\n    console.log(\"projectapi,getDatasets()\",userid);\n    let userdataurl=(userid)?this.userinfourl+\"/\"+userid+\"/dataset\":this.dataurl;\n    //get them all the times?\n    if (this.datasets.length>0)\n      return new Promise(resolve => resolve(this.datasets))\n    else\n    return this.httpclient.fetch(userdataurl)\n      .then(response => response.json())\n      .then(data => {\n        this.datasets=data;\n        return data;\n      })\n      .catch(error => {\n        console.log(error);\n      });\n\n  }\n  setSelectedDataset(id){\n    this.selectedDatasetId=id;\n  }\n\n  getSelectedDataset(){\n    return this.selectedDatasetId;\n  }\n\n  submitDataset(dataset) {\n    //sets the user - on behalf this request is done\n      return this.httpclient.fetch(this.dataurl, { method:'post', body:json(dataset)})\n        .then(response => response.json())\n        .then(data => {\n          this.datasets=data;//TODO ???\n          return data;\n        });\n  }\n\n  submitProject(project) {\n    return this.httpclient.fetch(this.projecturl, { method:'post', body:json(project)})\n      .then(response => response.json())\n      .then(data => {\n        console.log(\"Project submitted\");\n        this.projects=data; //TODO ???\n        return data;\n      });\n  }\n\n  /* getting list of users - available for staff */\n  getUsers() {\n    return this.httpclient.fetch(this.usersurl)\n      .then(response => response.json())\n      .then(data => {\n        return data;\n      })\n      .catch(error => {\n        console.log('getUsers() returns error:');\n        console.log(error);\n        //alert(\"Sorry, error:\"+error.statusCode+\" \"+error.message);\n      });\n  }\n\n  getUserInfo() {\n    if (!this.apiavailable) return Promise.reject(\"api not available\");\n      return this.httpclient.fetch(this.userinfourl)\n        .then(response => response.json())\n        .then(data => {\n          return data;\n        })\n        .catch(error => {\n          console.log('getUserInfo() returns error:');\n          //console.log(error);\n          throw error;\n          //          alert(\"Sorry, error:\"+error.statusCode+\" \"+error.message);\n        });\n    }\n\n    getStaffUserInfo(){\n // getUserInfo() {\n    return this.httpclient.fetch(this.staffuserinfourl)\n      .then(response => response.json())\n      .then(data => {\n        return data;\n      })\n      .catch(error => {\n        console.log('getUserInfo() returns error:');\n        //console.log(error);\n        throw error;\n        //          alert(\"Sorry, error:\"+error.statusCode+\" \"+error.message);\n      });\n  }\n\n    deleteDataset(id){\n    return this.httpclient.fetch(this.dataurl+\"/\"+id,{method:\"delete\"})\n      .then(response=> response.json())\n      .then(data=> {return data;});\n    }\n\n    copytask(src,dest) {\n    return this.httpclient.fetch(this.copytaskurl, {method:\"post\",body:json({sourceurl:src,webdavurl:dest})})\n      .then(response =>response.json())\n      .then(data=> {return data;});\n    }\n}\n","import {ProjectApi} from './projectapi';\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {Selectedproject,FilterProject,FilterProjectByDataset,Addproject} from \"./messages\";\nimport {bindable} from 'aurelia-framework';\n\nexport class Projecttable {\n  static inject = [ProjectApi,EventAggregator];\n  @bindable userid;\n\n  constructor(pa,ea) {\n    console.log(\"Projecttable()\");\n    this.pa = pa;\n    this.ea=ea;\n    this.projects = [];\n    this.selectedProject=null;\n    this.selectedProjectId=0;\n    console.log(\"Projecttable() subscribe\");\n    this.ea.subscribe(FilterProject,msg =>this.filterSelectedProposal(msg.id));\n    this.ea.subscribe(Addproject,msg =>this.addProposal(msg.project));\n    this.ea.subscribe(FilterProjectByDataset,msg =>this.filterSelectedProposal(msg.id));\n    console.log(\"Projecttable() subscribe 2\");\n  }\n\n  bind() {\n    console.log(\"projecttable bind()\",this.userid);\n    this.pa.getProjects(this.userid).then(data => {\n      this.projects = data;\n      //data retrieved and selectedProject already set e.g. by activate, call filter again\n      this.selectedProjectId=this.pa.getSelectedProject();\n      console.log(this.selectedProjectId);\n      if (this.selectedProjectId>0) this.filterSelectedProposal(this.selectedProjectId);\n    });\n  }\n\n\n  /* this is used when new project proposal is selected - it filters project by id and datasets by id*/\n  filterSelectedProposal(id) {\n    //this.selectedProposal=item;\n    this.selectedProjectId=id;\n    if (this.projects.length>0) {\n      this.selectedProject = this.projects.filter(i => i.id == id)[0];\n    } else {\n      console.log(\"projects are not yet retrieved\");\n    }\n  }\n\n  selectProject(project){\n    console.log(\"selectProject()\");\n    this.selectedProject=project;\n    this.ea.publish(new Selectedproject(project))\n    return true;\n  }\n\n  deselectProject(){\n    console.log(\"deselectProject()\");\n    this.selectedProject=null;\n    this.ea.publish(new Selectedproject(null))\n    return true;\n  }\n\n  addProposal(pr) {\n    console.log(\"addproposal()\",pr);\n    this.projects.unshift(pr)\n  }\n\n\n}\n","export class Searchbydate {\n\n}\n","import {ProjectApi} from './projectapi';\n\nexport class Staffuserinfo {\n  static inject = [ProjectApi];\n\n  constructor(projectapi) {\n    this.pa = projectapi;\n    this.showuserinfo=false;\n  }\n\n  attached(){\n    this.pa.getStaffUserInfo().then(data => {\n        console.log(data);\n        this.userinfo=data;\n        this.showuserinfo=true;\n      })\n      .catch(error => {\n        console.log(\"no user info, disable showing it\")\n        this.showuserinfo=false;\n      })\n  }\n}\n","import {ProjectApi} from './projectapi';\n\nexport class Userinfo {\n  static inject = [ProjectApi];\n\n  constructor(projectapi) {\n    this.pa = projectapi;\n    this.showuserinfo=false;\n  }\n\n  attached(){\n    this.pa.getUserInfo().then(data => {\n        console.log(data);\n        this.userinfo=data;\n        this.showuserinfo=true;\n      })\n      .catch(error => {\n        console.log(\"no user info, disable showing it\");\n        this.showuserinfo=false;\n      })\n  }\n}\n","import {HttpClient} from 'aurelia-fetch-client';\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {Editfile,Webdavresource} from './messages';\n\nexport class Webdavfilepanel {\n  static inject = [EventAggregator,HttpClient];\n\n  constructor(ea,httpclient) {\n    //even aggregator to listen for webdav resource to be presented/updated in panel\n    this.ea =ea;\n    this.ea.subscribe(Webdavresource,msg =>this.setwebdav(msg.webdavurl))\n    //http client to perform WEBDAV queries\n    this.httpclient = httpclient;\n    this.httpclient.configure(config => {\n      config\n        .rejectErrorResponses()\n        .withBaseUrl('')\n        .withDefaults({\n          credentials: 'same-origin',\n          headers: {\n            'Accept': 'application/json',\n            'X-Requested-With': 'Fetch'\n          }\n        })\n    });\n    this.webdavpath = '';///files/XufWqKau/';\n    //hold depth of directory structure if cd into them\n    this.dirs=[];\n    this.files=[];\n  }\n\n  atached(){\n    if (this.pa.dataseturl){\n      setwebdav(webdavurl);\n    }\n  }\n\n  setwebdav(webdavurl) {\n    console.log(\"setwebdav() obtained url:\"+webdavurl);\n    this.webdavpath = webdavurl;\n    if (!webdavurl) {this.files = [];return;}\n    //query the directory content\n    this.httpclient.fetch(this.webdavpath, {\n      method: 'PROPFIND',\n      headers: {'Depth': '1'}\n    }).then(response => response.text())\n      .then(str => (new window.DOMParser()).parseFromString(str, \"text/xml\"))\n      .then(data => {\n        //parse structure https://stackoverflow.com/questions/17604071/parse-xml-using-javascript\n        this.files = [];\n        let filesDOM = data.getElementsByTagName(\"D:response\");\n        for (let fileitem of filesDOM) {\n          let filename = this.getFirstElementByTagName(fileitem, \"D:href\");\n          let filedate = this.getFirstElementByTagName(fileitem, \"lp1:creationdate\");\n          let filesize = this.getFirstElementByTagName(fileitem, \"lp1:getcontentlength\");\n          let filetype = this.getFirstElementByTagName(fileitem, \"D:getcontenttype\");\n          //console.log(this.webdavpath+\" x \"+filename);\n          if (filename != this.webdavpath) //do not include current dir\n          {\n            let item = {};\n            item.name = filename.replace(this.webdavpath, '')\n            item.date = filedate;\n            item.nicedate = this.formatdate(new Date(filedate));\n            item.isdir= filetype == 'httpd/unix-directory';\n            item.size = filetype == 'httpd/unix-directory' ? 'DIR' : filesize;\n            //convert to 4GB or 30MB or 20kB or 100b\n            item.nicesize = item.isdir ? item.size: ~~(item.size / 1000000000) > 0 ? ~~(item.size / 1000000000) + \"GB\" : (~~(item.size / 1000000) > 0 ? ~~(item.size / 1000000) + \"MB\" : (~~(item.size / 1000) > 0 ? ~~(item.size / 1000) + \"kB\" : item.size + \" b\"));\n            item.type = filetype;\n            item.webdavurl=this.webdavpath+item.name;\n            //directory first, files after that\n            if (item.isdir) this.files.unshift(item);\n            else this.files.push(item);\n          }\n\n        }\n        //adds first row with '..' to cd to parent directory\n        if (this.dirs.length>0) this.files.unshift({name:'..',isdir:true,size:'DIR',date:''});\n      }).catch(error => {\n        this.files=[];\n      console.log(\"setwebdav() error\");\n      console.log(error);\n    });\n  }\n\n  getFirstElementByTagName(fileitem,tag) {\n    //console.log(tag);\n    let elements =fileitem.getElementsByTagName(tag);\n    //console.log(elements);\n    return elements.length>0?elements[0].textContent:'';\n  }\n\n  selectFile(file){\n    //file.webdavurl = this.webdavpath+file.name;\n    if (file.isdir) {\n      let newdir= '';\n      if (file.name =='..') {\n        newdir = this.dirs.pop();\n      } else {\n        this.dirs.push(this.webdavpath);\n        newdir = this.webdavpath+file.name;\n      }\n      this.setwebdav(newdir);\n    }\n    else  this.ea.publish(new Editfile(file));\n  }\n\n  formatdate(date) {\n      let diff = new Date() - date; // the difference in milliseconds\n\n      if (diff < 1000) { // less than 1 second\n        return 'right now';\n      }\n\n      let sec = Math.floor(diff / 1000); // convert diff to seconds\n\n      if (sec < 60) {\n        return sec + ' sec. ago';\n      }\n\n      let min = Math.floor(diff / 60000); // convert diff to minutes\n      if (min < 60) {\n        return min + ' min. ago';\n      }\n\n      // format the date\n      // add leading zeroes to single-digit day/month/hours/minutes\n      let d = date;\n      d = [\n        '0' + d.getDate(),\n        '0' + (d.getMonth() + 1),\n        '' + d.getFullYear(),\n        '0' + d.getHours(),\n        '0' + d.getMinutes()\n      ].map(component => component.slice(-2)); // take last 2 digits of every component\n\n      // join the components into date\n      return d.slice(0, 3).join('.') + ' ' + d.slice(3).join(':');\n    }\n}\n","import {bindable} from 'aurelia-framework';\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {Uploaddir} from '../components/messages';\n\nexport class Pickerclient {\n  static inject = [EventAggregator];\n  @bindable mode;\n\n  constructor(ea) {\n    this.ea=ea;\n    this.href=\"https://portal.west-life.eu/virtualfolder/filepickercomponent.html\";\n    this.href2=\"https://portal.west-life.eu/virtualfolder/uploaddirpickercomponent.html\";\n    this.vfurl=\"\";\n    //receives message from popup window, fills target element with the data received\n    let th2= this\n    this.receiveMessage = e => {\n      console.log(\"received event\");\n      console.log(e);\n      th2.vfurl=e.data;\n      console.log(\"publishing event\");\n      th2.ea.publish(new Uploaddir(th2.vfurl))\n    }\n    console.log(\"Pickerclient()\");\n    console.log(this.mode)\n  }\n\n  attached() {\n    //registers itself to receive message from popup window\n    window.addEventListener(\"message\", this.receiveMessage);\n    console.log(\"Pickerclient attached()\");\n    console.log(this.mode);\n    this.filepicker = (this.mode === \"file\")\n  }\n\n  detached() {\n    window.removeEventListener(\"message\", this.receiveMessage)\n  }\n\n//opens popup window in defined location, sets the target element id.\n  openfilewindow() {\n    this.popup=window.open(this.href, 'newwindow', 'width=640, height=480');\n  }\n  opendirwindow() {\n    this.popup=window.open(this.href2, 'newwindow', 'width=640, height=480');\n  }\n}\n","import {bindable} from 'aurelia-framework';\n/** Icopy - <icopy href=\"link-reference\"></icopy>\n * element to create a link icon which on click will copy the url into the clipboard\n * using the browser capability document.execCommand(\"copy\")\n */\n\nexport class Icopy {\n  @bindable href;\n\n  attached() {\n    //set value of referenced input\n    // href is relative - thus adding protocol and hostname, port\n    let port = (window.location.port == \"\" || window.location.port==\"80\" || window.location.port == \"443\")? \"\" :\":\"+window.location.port;\n    this.hrefid.value = window.location.protocol+ '//'+window.location.hostname+port+this.href;\n  }\n\n  copyclipboard() {\n    let inputElement = this.hrefid;\n    inputElement.select();\n    document.execCommand(\"copy\");\n    console.log(inputElement.value);\n    alert(\"Copied the url to clipboard: \" + inputElement.value);\n  }\n}\n","export function configure(config) {\n  //config.globalResources([]);\n  config.globalResources([\n    './irep.html',\n    './irepdemo.html',\n    './iadmin.html',\n    './istaff.html',\n    './ifile.html',\n    './ilink.html',\n    './icopy',\n    './ifolder.html',\n    './idata.html',\n    './iproject.html',\n    './itable.html',\n    './ispincog.html',\n    './iupload',\n    './idelete.html',\n    './inext.html',\n    './icopyicon.html'\n  ]);\n\n}\n","import {bindable} from 'aurelia-framework';\nimport {ProjectApi} from \"../components/projectapi\";\n/** Iupload - <iupload href=\"link-reference\"></iupload>\n * element to create a link icon which on click will initiate copy task\n */\n/*\nvar popup;\nvar target;\n//opens popup window in defined location, sets the target element id.\nfunction openwindow(_target,href) {\n  target = _target;\n  popup=window.open(href, 'newwindow', 'width=640, height=480');\n}\n//receives message from popup window, fills target element with the data received\nfunction receiveMessage(event) {\n  document.getElementById(target).innerHTML=event.data;\n  document.getElementById(target).setAttribute(\"href\",event.data);\n}\nwindow.addEventListener(\"message\", receiveMessage, false);\n*/\nexport class Iupload {\n  @bindable href;\n  static inject = [ProjectApi];\n  constructor(pa) {\n    this.pa=pa;\n    //receiveMessage will be registered in event listener - this declaration will assure that the context 'this' won't be lost\n    this.receiveMessage = event=> {\n      this.uploadhref=event.data;\n      if (this.uploadhref && this.uploadhref.length>0){\n        //now upload from this.hreffull to this.uploadhref\n        console.log(\"Iupload.receiveMessage()\");\n        console.log(\"will upload from:\"+this.hreffull);\n        console.log(\"              to:\"+this.uploadhref);\n        this.pa.copytask(this.href,this.uploadhref);\n      }\n    }\n\n  }\n\n  attached() {\n    //set value of referenced input\n    // href is relative - thus adding protocol and hostname, port\n    let port = (window.location.port == \"\" || window.location.port==\"80\" || window.location.port == \"443\")? \"\" :\":\"+window.location.port;\n    this.hreffull = window.location.protocol+ '//'+window.location.hostname+port+this.href;\n    console.log(\"Iupload.atached()\")\n    console.log(this.href)\n    console.log(this.hreffull)\n    window.addEventListener(\"message\", this.receiveMessage, false);\n  }\n\n  dettached() {\n    window.removeEventListener(\"message\", this.receiveMessage);\n  }\n\n  openwindow(href) {\n    this.popup=window.open(href, 'newwindow', 'width=640, height=480');\n  }\n\n  uploadtovf() {\n    this.openwindow('https://portal.west-life.eu/virtualfolder/uploaddirpickercomponent.html');\n  }\n}\n","import {Selectedproject, Adddataset} from \"../components/messages\";\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {ProjectApi} from '../components/projectapi';\nimport {bindable} from 'aurelia-framework';\n\n/* Dashboarddetails shows details of projects/datasets */\nexport class Createdataset {\n  static inject = [EventAggregator, ProjectApi];\n  @bindable userid;\n\n  constructor(ea, pa) {\n    this.ea = ea;\n    this.pa = pa;\n    this.datasetname=\"Antidote\";\n    this.datasetinfo=\"0 b\";\n    this.datasetsummary=\"spectrum of antidote\";\n    this.datasetprojectid=null;\n    this.submitted=false;\n    this.ea.subscribe(Selectedproject,msg =>this.selectProject(msg.project));\n  }\n\n  submit(){\n    console.log(\"submitting dataset:\"+this.datasetname);\n    this.pa.submitDataset({name:this.datasetname,info:this.datasetinfo,summary:this.datasetsummary,projectId:this.datasetprojectid})\n      .then(dataset =>{\n        this.submitted=true;\n        this.submitteditem=dataset;\n        this.ea.publish(new Adddataset(dataset));\n      })\n      .catch(error => {\n        console.log(error);\n        alert(\"Error when submitting new dataset:\"+error);\n      });\n    this.datasetname=\"\";\n    this.datasetinfo=\"\";\n    this.datasetsummary=\"\";\n  }\n\n  generate(){\n    this.datasetname=\"Antidote\";\n    this.datasetinfo=Math.floor((Math.random() * 100) + 1)+\" b\";\n    this.datasetsummary=\"spectrum of antidote\"\n  }\n\n  selectProject(project){\n    if (project) {\n      this.datasetprojectid = project.id;\n    } else this.datasetprojectid=null;\n  }\n\n  selectDataset(){\n\n  }\n}\n","//import {Ariaapi} from '../components/ariaapi';\nimport {Ariaapi} from '../components/ariaapixhr';\nimport {ProjectApi} from \"../components/projectapi\";\nimport {Addproject} from \"../components/messages\";\nimport {EventAggregator} from \"aurelia-event-aggregator\";\n\nconst getParams = query => {\n  if (!query) {\n    return {};\n  }\n\n  return (/^[?#]/.test(query) ? query.slice(1) : query)\n    .split('&')\n    .reduce((params, param) => {\n      let [key, value] = param.split('=');\n      params[key] = value ? decodeURIComponent(value.replace(/\\+/g, ' ')) : '';\n      return params;\n    }, {});\n};\n\n\n/* Dashboard receives list of projects and list of datasets, in case the project or dataset is selected either by click or within url it is filtered */\nexport class Dashboard {\n  /* Dashboarddetails shows details of projects/datasets */\n  static inject = [Ariaapi,ProjectApi,EventAggregator];\n  constructor(ariaapi,pa,ea) {\n    this.ariaapi = ariaapi;\n    this.pa= pa;\n    this.ea=ea;\n    this.importingaria=false;\n    this.importariastatus=\"\";\n    this.importariaerror=false;\n    this.proposals=[];\n    this.selectedProposal=false;\n  }\n/*\n  activate(){\n    console.log(\"dashboard.activated()\");\n  }\n*/\n  attached(){\n    console.log(\"dashboard.attached()\");\n    this.params=getParams(window.location.search.substring(1));\n    console.log(this.params);\n    this.code=this.params.code;\n    this.state=this.params.state;\n    if (this.code && this.state) {\n      this.importingaria=true;\n      //code and state are in url => button (import ARIA proposals) was clicked before and redirected back from ARIA - thus\n      //importing the data now\n      this.ariaapi.getAccessToken(this.code,this.state).then(accessToken =>{\n        console.log(\"Dashboard.attached() accestoken:\");\n        console.log(accessToken);\n        this.importingaria=false;\n        if (accessToken.error_description) {\n          this.importariastatus=accessToken.error_description\n          this.importariaerror=true;\n        } else {\n          //use accesstoken to get proposal list\n          this.ariaapi.getProposalList().then(list =>{\n            console.log(\"Dashboard.attached().getProposalList():\")\n            console.log(list);\n            this.proposals=list;\n          })\n            .catch(error =>{\n              this.importariastatus=error.statusText;\n              this.importariaerror=true;\n            })\n        }\n      });\n    }\n  }\n\n  selectProposal(p){\n//    this.selectedProposal=p;\n    this.importingaria=true;\n    this.ariaapi.getProposal(p.pid).then(detail =>{\n      this.importingaria=false;\n      console.log(\"Dashboard.selectProposal():\")\n      console.log(detail);\n      this.selectedProposal=detail.proposal;\n      this.selectedFields= Object\n        .keys(this.selectedProposal.fields)\n        .sort((a,b) => +a - +b)\n        .filter(key => !isNaN(+key))\n        .map(key => this.selectedProposal.fields[key]);\n    })\n      .catch(error =>{\n        this.importingaria=false;\n        this.importariaerror=true;\n        this.importariastatus= error.statusText;\n      })\n  }\n\n  importProposal(p) {\n    let pr={};\n    pr.projectName = p.title;\n    pr.shareable=p.pid;\n\n    this.importingaria=true;\n    this.pa.submitProject(pr).then(data =>{\n      this.importingaria=false;\n      this.ea.publish(new Addproject(data))\n    }).catch (error=>{\n      this.importingaria=false;\n      this.importariaerror=true;\n      this.importariastatus= error.statusText;\n    });\n  }\n}\n\n","import {Selectedproject, Selecteddataset, Webdavresource, FilterDataset,FilterProject,FilterDatasetByProject} from \"../components/messages\";\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {ProjectApi} from '../components/projectapi';\n\n/* Dashboarddetails shows details of projects/datasets */\nexport class Dashboarddetail {\n  static inject = [EventAggregator,ProjectApi];\n\n  constructor(ea,pa) {\n    this.ea = ea;\n    this.pa=pa;\n    console.log(\"subscribe()\");\n    this.ea.subscribe(Selectedproject,msg =>this.selectProject(msg.project));\n    this.ea.subscribe(Selecteddataset,msg => this.selectDataset(msg.dataset));\n  }\n\n  /* it is triggered on first click on project - url is generated\n  * or when url is submitted directly to browser */\n  activate(params, routeConfig, navigationInstruction){\n    console.log(\"dashboarddetail.activate()\")\n    if (params && params.projectid) {\n      console.log(\"dashboarddetail projectid:\"+params.projectid);\n      this.filterProject(params.projectid);\n    }\n    if (params && params.datasetid) {\n      console.log(\"dashboarddetail datasetid:\"+params.datasetid);\n      this.filterDataset(params.datasetid);\n    }\n  }\n\n  /* triggered when the view is shown to user - it requests projects and dataset\n  * available for user from REST api*/\n  attached() {\n    console.log(\"Dashboard.attached()\")\n    this.selectedDataset=this.pa.getSelectedDataset()>0;\n    //console.log(this.pa);\n  }\n\n  //triggered when a project is clicked -\n  // if the same project is selected activate() is not launched - enough to hide all other projects\n  selectProject(project) {\n    this.selectedProject=project;\n    this.selectedProjectId=project.id;\n    this.pa.setSelectedProject(projectid);\n    this.ea.publish(new FilterDatasetByProject(project.id));\n    return true;\n  }\n\n  /* helper class called from filterSelecterProposal - or when attached() so activate() call before didn't have\n  * the projects and datasets sets from REST api*/\n  filterProject(projectid){\n    console.log(\"dashboarddetail.filterProject()\");\n    this.pa.setSelectedProject(projectid);\n    this.ea.publish(new FilterProject(projectid));\n    this.ea.publish(new FilterDatasetByProject(projectid));\n  }\n\n  //filters dataset based on selectedProjectId\n  filterDataset(datasetid){\n    console.log(\"dashboarddetail.filterDataset()\");\n    this.pa.setSelectedDataset(datasetid);\n    this.ea.publish(new FilterDataset(datasetid));\n  }\n\n  //shows only one dataset and publish webdavresource with dataset's url\n  selectDataset(item) {\n    console.log(\"received selectDataset signal\");\n    console.log(item);\n    this.selectedDataset=item;\n    if (!item) {deselectDataset(); return true;}\n    this.selectedDatasetId=item.id;\n    console.log(\"selectDataset\");\n    console.log(item);\n\n    this.pa.dataseturl=item.webdavurl;\n    this.ea.publish(new Webdavresource(item.webdavurl))\n    return true; //continues to process <a href>\n  }\n\n\n}\n","import {Selectedproject, Selecteddataset, Webdavresource, FilterDataset,FilterProject,FilterDatasetByProject,FilterProjectByDataset} from \"../components/messages\";\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {ProjectApi} from '../components/projectapi';\n\n/* Dashboarddetails shows details of projects/datasets */\nexport class Datasetdetail {\n  static inject = [EventAggregator,ProjectApi];\n\n  constructor(ea,pa) {\n    this.ea = ea;\n    this.pa=pa;\n\n    this.ea.subscribe(Selectedproject,msg =>this.selectProject(msg.project));\n    this.ea.subscribe(Selecteddataset,msg => this.selectDataset(msg.dataset));\n  }\n\n  /* it is triggered on first click on project - url is generated\n  * or when url is submitted directly to browser */\n  activate(params, routeConfig, navigationInstruction){\n    console.log(\"dashboarddetail.activate()\")\n    if (params && params.projectid) {\n      console.log(\"dashboarddetail projectid:\"+params.projectid);\n      this.filterProject(params.projectid);\n    }\n    if (params && params.datasetid) {\n      console.log(\"dashboarddetail datasetid:\"+params.datasetid);\n      this.filterDataset(params.datasetid);\n    }\n  }\n\n  /* triggered when the view is shown to user - it requests projects and dataset\n  * available for user from REST api*/\n  attached() {\n    console.log(\"Dashboard.attached()\")\n    this.selectedDataset=this.pa.getSelectedDataset()>0;\n    //console.log(this.pa);\n  }\n\n  //triggered when a project is clicked -\n  // if the same project is selected activate() is not launched - enough to hide all other projects\n  selectProject(project) {\n    this.selectedProject=project;\n    this.filterSelectedProposal(project.id);\n    return true;\n  }\n\n  /* this is used when new project proposal is selected - it filters project by id and datasets by id*/\n  filterSelectedProposal(id) {\n    //this.selectedProposal=item;\n    this.selectedProjectId=id;\n    this.filterProject();\n    this.filterDataset();\n  }\n\n\n  /* helper class called from filterSelecterProposal - or when attached() so activate() call before didn't have\n  * the projects and datasets sets from REST api*/\n  filterProject(projectid){\n    console.log(\"dashboarddetail.filterProject()\");\n    this.pa.setSelectedProject(projectid);\n    this.ea.publish(new FilterProject(projectid));\n    this.ea.publish(new FilterDatasetByProject(projectid));\n  }\n\n  //filters dataset based on selectedProjectId\n  filterDataset(datasetid){\n    console.log(\"dashboarddetail.filterDataset()\");\n    this.pa.setSelectedDataset(datasetid);\n    this.ea.publish(new FilterDataset(datasetid));\n    //this.ea.publish(new FilterProjectByDataset()) -- call from filterDataset -\n  }\n\n  //deselect project proposal, shows all proposals and datasets\n  deselectProposal() {\n    //this.selectedProposal=item;\n    //this.datasets = this.alldatasets;\n    //return true; //continues to process <a href>\n  }\n\n  //shows only one dataset and publish webdavresource with dataset's url\n  selectDataset(item) {\n    this.selectedDataset=item;\n    if (!item) {deselectDataset(); return true;}\n    this.selectedDatasetId=item.id;\n    console.log(\"selectDataset\");\n    console.log(item);\n\n    //TODO replace URL by the one obtained from API\n    this.pa.dataseturl=item.webdavurl;\n    this.ea.publish(new Webdavresource(item.webdavurl))\n    return true; //continues to process <a href>\n  }\n\n  selectFile(file){\n    console.log(\"SelectFile()\");\n    console.log(file);\n  }\n\n  deleteDataset() {\n    this.pa.deleteDataset(this.selectedDatasetId)\n    then(data => {\n      this.deselectDataset();\n      let i=this.datasets.map(function(e) {return e.id;}).indexOf(data.id);\n      this.datasets.splice(i,1);\n      i=this.alldatasets.map(function(e) {return e.id;}).indexOf(data.id);\n      this.alldatasets.splice(i,1);\n    })\n  }\n}\n","import {Selectedproject, Selecteddataset, Webdavresource, FilterDataset,FilterProject,FilterDatasetByProject,FilterProjectByDataset} from \"../components/messages\";\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {ProjectApi} from '../components/projectapi';\n\n/* Dashboarddetails shows details of projects/datasets */\nexport class Projectdetail {\n  static inject = [EventAggregator,ProjectApi];\n\n  constructor(ea,pa) {\n    this.ea = ea;\n    this.pa=pa;\n\n    //this.ea.subscribe(Selectedproject,msg =>this.selectProject(msg.project));\n    //this.ea.subscribe(Selecteddataset,msg => this.selectDataset(msg.dataset));\n  }\n\n  /* it is triggered on first click on project - url is generated\n  * or when url is submitted directly to browser */\n  activate(params, routeConfig, navigationInstruction){\n    console.log(\"dashboarddetail.activate()\")\n    if (params && params.projectid) {\n      this.filterProject(params.projectid);\n    }\n  }\n\n  /* triggered when the view is shown to user - it requests projects and dataset\n  * available for user from REST api*/\n  attached() {\n    console.log(\"Dashboard.attached()\")\n    this.selectedDataset=this.pa.getSelectedDataset()>0;\n    //console.log(this.pa);\n  }\n\n  /* helper class called from filterSelecterProposal - or when attached() so activate() call before didn't have\n  * the projects and datasets sets from REST api*/\n  filterProject(projectid){\n    console.log(\"dashboarddetail.filterProject()\");\n    this.pa.setSelectedProject(projectid);\n    this.ea.publish(new FilterProject(projectid));\n    this.ea.publish(new FilterDatasetByProject(projectid));\n  }\n\n  //shows only one dataset and publish webdavresource with dataset's url\n  selectDataset(item) {\n    this.selectedDataset=item;\n    if (!item) {deselectDataset(); return true;}\n    this.selectedDatasetId=item.id;\n    console.log(\"selectDataset\");\n    console.log(item);\n\n    //TODO replace URL by the one obtained from API\n    this.pa.dataseturl=item.webdavurl;\n    this.ea.publish(new Webdavresource(item.webdavurl))\n    return true; //continues to process <a href>\n  }\n\n  selectFile(file){\n    console.log(\"SelectFile()\");\n    console.log(file);\n  }\n\n  deleteDataset() {\n    this.pa.deleteDataset(this.selectedDatasetId)\n    then(data => {\n      this.deselectDataset();\n      let i=this.datasets.map(function(e) {return e.id;}).indexOf(data.id);\n      this.datasets.splice(i,1);\n      i=this.alldatasets.map(function(e) {return e.id;}).indexOf(data.id);\n      this.alldatasets.splice(i,1);\n    })\n  }\n}\n","\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {Uploaddir} from '../components/messages';\n\nexport class Repositorytovf {\n  static inject = [EventAggregator]\n  constructor(ea) {\n    this.ea = ea;\n    console.log(\"Repositorytovf()\");\n\n\n    this.datasets=[{name:\"sucrose.t1\",size:133511,date:\"18/06/2001\"},\n      {name:\"hetcor.2d\",size:525832,date:\"18/06/2001\"},\n      {name:\"menth.c13\",size:132108,date:\"18/06/2001\"},\n      {name:\"noesy.fid\",size:1640436,date:\"18/06/2001\"},\n      {name:\"hsqc.fid\",size:2098448,date:\"18/06/2001\"},\n      {name:\"hmbc.fid\",size:2098448,date:\"18/06/2001\"}];\n    this.filestoupload=[];\n    this.uploadfiles=[];\n    this.uploaddir=\"\";\n    this.selectingfiles=true;\n    this.ea.subscribe(Uploaddir,msg =>this.setuploaddir(msg.webdavurl))\n    this.copyinprogress=false;\n  }\n\n  attached() {\n\n  }\n\n  setuploaddir(url) {\n    console.log(\"setuploaddir()\");\n    console.log(url)\n    this.uploaddir=url;\n    this.selectedUploadDir = true;\n  }\n\n  selectitem(item) {\n    console.log(\"Selected\",item)\n  }\n\n  submitfiles() {\n    this.selectingfiles=false;\n  }\n\n  unsubmitfiles(){\n    this.selectingfiles=true;\n  }\n  deleteitem(item){\n    let indexremoved = this.datasets.indexOf(item);\n    if (indexremoved >=0 ) this.datasets.splice(indexremoved,1);\n  }\n\n  selectItemToUpload(item) {\n    console.log(\"selected item\");\n    console.log(item);\n  }\n\n  removeItemToUpload(item){\n    console.log(\"selected item\");\n    console.log(item);\n    let i = this.filestoupload.indexOf(item);\n    this.filestoupload.splice(i,1);\n  }\n\n  dropped(event){\n    console.log(\"Dropped\")\n    console.log(event.dataTransfer.files);\n    event.stopPropagation();\n    event.preventDefault();\n    this.filestoupload.unshift(...event.dataTransfer.files);\n    return true;\n  }\n\n  dragged(event){\n    return true;//event.preventDefault(); event.dataTransfer.dropEffect = 'copy';\n  }\n\n  appendFiles(event){\n    console.log(\"appendFiles()\");\n    console.log(event.target.files);\n    //this.uploadfiles=event.target.files;\n    this.filestoupload.unshift(...event.target.files);\n    //else this.filestoupload.unshift(event.target.files);\n  }\n\n  appendDir(event) {\n    console.log(\"appendDir\")\n    console.log(event.target.files);\n    this.filestoupload.unshift(...event.target.files)\n  }\n\n  submitUpload(){\n    //TODO fake implementation\n    this.datasets.unshift(...this.filestoupload);\n    this.filestoupload=[];\n  }\n  copy(){\n    this.copyinprogress=true;\n  }\n\n}\n","export class Dashboard {\n\n}\n","import {ProjectApi} from '../components/projectapi';\n\nexport class Dataupload {\n  static inject = [ProjectApi];\n  constructor(pa) {\n    this.pa = pa;\n  }\n\n}\n","import {ProjectApi} from '../components/projectapi';\n\nexport class Repositorystaff {\n  static inject = [ProjectApi];\n\n  constructor(pa) {\n    console.log(\"Repositorystaff()\");\n    this.visitors = [];//\"Tomas Kulhanek\",\"Andrea Giacchieti\",\"Antonio Rosatto\"];\n    this.datasets=[];\n    this.filestoupload=[];\n    this.uploadfiles=[];\n    this.uploaddir=\"\";\n    this.selectinguser=true;\n    this.selectedvisitor=\"\";\n    this.pa = pa;\n  }\n\n  attached() {\n    this.pa.getUsers()\n      .then(data => { this.visitors = data });\n  }\n\n  selectitem(item) {\n    console.log(\"Selected\",item)\n  }\n\n  selectvisitor(visitor) {\n    this.selectinguser=false;\n    this.selectedvisitor = visitor;\n  }\n  deselectvisitor(){\n    this.selectinguser=true;\n  }\n  deleteitem(item){\n    let indexremoved = this.datasets.indexOf(item);\n    if (indexremoved >=0 ) this.datasets.splice(indexremoved,1);\n  }\n  \n  selectItemToUpload(item) {\n    console.log(\"selected item\");\n    console.log(item);\n  }\n\n  removeItemToUpload(item){\n    console.log(\"selected item\");\n    console.log(item);\n  let i = this.filestoupload.indexOf(item);\n    this.filestoupload.splice(i,1);\n  }\n\n  dropped(event){\n    console.log(\"Dropped\");\n    console.log(event.dataTransfer.files);\n    event.stopPropagation();\n    event.preventDefault();\n    this.filestoupload.unshift(...event.dataTransfer.files);\n    return true;\n  }\n\n  dragged(event){\n    return true;//event.preventDefault(); event.dataTransfer.dropEffect = 'copy';\n  }\n\n  appendFiles(event){\n    console.log(\"appendFiles()\");\n    console.log(event.target.files);\n    //this.uploadfiles=event.target.files;\n    this.filestoupload.unshift(...event.target.files);\n    //else this.filestoupload.unshift(event.target.files);\n  }\n\n  appendDir(event) {\n    console.log(\"appendDir\");\n    console.log(event.target.files);\n    this.filestoupload.unshift(...event.target.files)\n  }\n\n  submitUpload(){\n    //TODO fake implementation\n    this.datasets.unshift(...this.filestoupload);\n    this.filestoupload=[];\n  }\n\n}\n","import {ProjectApi} from '../components/projectapi';\nimport {HttpClient} from 'aurelia-fetch-client';\n\nexport class Upconfirm {\n  static inject = [ProjectApi,HttpClient]\n  constructor (pa,client){\n    this.pa=pa;\n    this.httpclient=client;\n  }\n\n  attached() {\n    this.filestoupload= this.pa.filestoupload;\n    this.dataset=this.pa.selectedDataset;\n    this.submitted=false;\n    this.status=\"\";\n  }\n\n  uploadFiles(){\n    console.log('upconfirm.uploadFiles()');\n    console.log(this.filestoupload);\n    console.log(this.dataset);\n    let port = (window.location.port == \"\" || window.location.port==\"80\" || window.location.port == \"443\")? \"\" :\":\"+window.location.port;\n    this.hreffull = window.location.protocol+ '//'+window.location.hostname+port+this.dataset.href;\n    for (let file of this.filestoupload) {\n      this.httpclient.fetch(this.dataset.webdavurl+file.name, {method:\"PUT\",body:file}).then(response =>\n      {\n        this.status+=file.name+\" -- OK\\n\"\n        console.log(\"fetch ok:\",response);\n      }).catch(error => {\n        this.status+=file.name+\" -- error\\n\"\n        console.log(\"fetch error:\",error);\n        }\n      );\n    }\n    this.submitted=true;\n    //this.pa.filestoupload -> webdav this.pa.dataset\n  }\n\n\n}\n","import {ProjectApi} from \"../components/projectapi\";\n\nexport class Upselectdata {\n  static inject = [ProjectApi];\n\n  constructor (pa) {\n    this.pa=pa;\n    this.filestoupload=[];\n    this.filesuploaded=[];\n  }\n\n  attached() {\n    console.log(\"Upselectdata.attached()\")\n    this.filestoupload=[];\n    this.filestoupload= this.pa.filestoupload;\n  }\n\n  detached() {\n    console.log(\"Upselectdata.dettached()\");\n    console.log(this.filestoupload);\n    this.pa.filestoupload=this.filestoupload;\n  }\n\n  removeItemToUpload(item){\n    console.log(\"selected item\");\n    console.log(item);\n    let i = this.filestoupload.indexOf(item);\n    this.filestoupload.splice(i,1);\n  }\n\n  dropped(event){\n    console.log(\"Dropped\");\n    console.log(event.dataTransfer.files);\n    event.stopPropagation();\n    event.preventDefault();\n    this.filestoupload.unshift(...event.dataTransfer.files);\n    return true;\n  }\n\n  dragged(event){\n    return true;//event.preventDefault(); event.dataTransfer.dropEffect = 'copy';\n  }\n\n  appendFiles(event){\n    console.log(\"appendFiles()\",event,this.uploaddir);\n\n    this.filestoupload.unshift(...event.target.files);\n    console.log(\"filestoupload\",this.filestoupload);\n\n  }\n\n  appendDir(event) {\n    console.log(\"appendDir\",event,this.uploadfiles);\n\n      this.filestoupload.unshift(...event.target.files);\n\n    console.log(\"filestoupload\",this.filestoupload);\n  }\n\n  submitUpload(){\n    //TODO fake implementation\n    console.log(\"submitUpload()\");\n    this.filesuploaded.unshift(...this.filestoupload);\n    this.filestoupload=[];\n  }\n\n  selectitem(item) {\n    console.log(\"Selected\",item)\n  }\n\n  deleteitem(item){\n    let indexremoved = this.filesuploaded.indexOf(item);\n    if (indexremoved >=0 ) this.filesuploaded.splice(indexremoved,1);\n  }\n\n}\n","import {Selecteddataset} from '../components/messages';\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {Router} from 'aurelia-router';\nimport {ProjectApi} from '../components/projectapi';\n\nexport class Upselectdataset {\n  static inject = [EventAggregator,Router,ProjectApi];\n  constructor(ea,ro,pa){\n    this.ea = ea;\n    this.router = ro;\n    this.pa= pa;\n    this.ea.subscribe(Selecteddataset,msg =>this.selectedDataset(msg.dataset));\n  }\n\n  selectedDataset(dataset) {\n    console.log('Upselectdataset.selectedDataset()');\n    this.pa.selectedDataset=dataset;\n    this.router.navigate(\"upselectdata\");\n  }\n\n}\n","import {ProjectApi} from '../components/projectapi';\n\n\nexport class Upselectuser {\n  static inject = [ProjectApi];\n\n  constructor(pa) {\n    this.visitors = [];\n    this.pa = pa;\n }\n\n  attached(){\n    //this.pa.selectedUser;\n    this.pa.getUsers()\n     .then(data => { this.visitors = data });\n }\n\n selectUser(user){\n    this.pa.selectedUser=user;\n    return true;\n }\n}\n"],"sourceRoot":"../src"}