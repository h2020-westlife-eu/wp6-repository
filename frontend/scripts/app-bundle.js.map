{"version":3,"sources":["app.js","environment.js","main.js","repositoryapp.js","repositorymain.js","staffapp.js","staffmain.js","components/ariaapi.js","components/datasettable.js","components/fileeditor.js","components/htable.js","components/importaria.js","components/messages.js","components/projectapi.js","components/projecttable.js","components/searchbydate.js","components/userinfo.js","components/webdavfilepanel.js","pickerclient/pickerclient.js","resources/icopy.js","resources/index.js","scientist/dashboard.js","scientist/dashboarddetail.js","scientist/repositorytovf.js","staff/dataupload.js","staff/repositorystaff.js"],"names":["App","configureRouter","config","router","title","login","debug","testing","configure","Promise","warnings","wForgottenReturn","aurelia","use","standardConfiguration","feature","start","then","setRoot","Repositoryapp","map","route","name","moduleId","nav","Staffapp","Ariaapi","httpclient","rejectErrorResponses","withBaseUrl","withDefaults","credentials","headers","proposallisturl","proposalurl","getProposallist","fetch","response","json","proposallist","data","catch","console","log","error","getProposal","proposal","inject","Datasettable","pa","alldatasets","showDatasets","attached","getDatasets","CodeMirror","Fileeditor","ea","client","subscribe","selectFile","msg","file","isimage","filename","showtable","codemirror","fromTextArea","cmTextarea","lineNumbers","mode","lineWrapping","refresh","ht2","Handsontable","filetable","rowHeaders","colHeaders","autoColumnSize","samplingRatio","manualColumnResize","that","imageurl","webdavurl","endsWith","response2","clone","blob","data2","bindata","convert","text","setValue","alert","table","arrayBuffer","fileReader","FileReader","addEventListener","result","rawdata","Float32Array","i","length","push","updateSettings","readAsArrayBuffer","htable","ht","idtable","Importaria","client_id","oaservice","oastate","Math","floor","random","ariaurl","Webdavresource","Editfile","Uploaddir","ProjectApi","apiurl","window","location","pathname","indexOf","projecturl","dataurl","userinfourl","usersurl","projects","datasets","getProjects","resolve","getUsers","getUserInfo","Projecttable","showProposals","Searchbydate","Userinfo","projectapi","showuserinfo","userinfo","Webdavfilepanel","setwebdav","webdavpath","dirs","method","DOMParser","parseFromString","str","files","filesDOM","getElementsByTagName","fileitem","getFirstElementByTagName","filedate","filesize","filetype","item","replace","date","nicedate","formatdate","Date","isdir","size","nicesize","type","unshift","tag","elements","textContent","newdir","pop","publish","diff","sec","min","d","getDate","getMonth","getFullYear","getHours","getMinutes","component","slice","join","Pickerclient","href","href2","vfurl","th2","receiveMessage","e","filepicker","detached","removeEventListener","openfilewindow","popup","open","opendirwindow","Icopy","port","hrefid","value","protocol","hostname","copyclipboard","inputElement","select","document","execCommand","globalResources","Dashboard","Dashboarddetail","dataseturl","selectedProjectId","selectedDatasetId","selectedProject","activate","params","routeConfig","navigationInstruction","projectid","filterSelectedProposal","datasetid","filterSelectedDataset","filterProject","filterMyDataset","filterDataset","selectProposal","id","mydataset","filter","projectId","selectDataset","summary","filtereditem","deselectProposal","selectedDataset","deselectDataset","Repositorytovf","filestoupload","uploadfiles","uploaddir","selectingfiles","setuploaddir","copyinprogress","url","selectedUploadDir","selectitem","submitfiles","unsubmitfiles","deleteitem","indexremoved","splice","selectItemToUpload","removeItemToUpload","dropped","event","dataTransfer","stopPropagation","preventDefault","dragged","appendFiles","target","appendDir","submitUpload","copy","Dataupload","Repositorystaff","visitors","selectinguser","selectedvisitor","selectvisitor","visitor","deselectvisitor"],"mappings":"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","file":"app-bundle.js","sourcesContent":["export class App {\n\n  configureRouter(config, router) {\n    config.title = 'West-Life Repository Router';\n  }\n\n  login() {\n    //window.location=\"login.html?next\"+window.location.pathname;\n  }\n\n}\n","export default {\n  debug: true,\n  testing: true\n};\n","//Configure Bluebird Promises not to throw warnings about aurelia empty promises\nPromise.config({\n  warnings: {\n    wForgottenReturn: false\n  }\n});\n\nexport function configure(aurelia) {\n  aurelia.use\n    .standardConfiguration()\n    .feature('resources');\n  aurelia.start().then(() => aurelia.setRoot());\n\n  }\n","export class Repositoryapp {\n\n  configureRouter(config, router) {\n    config.title = 'West-Life Repository Router';\n\n    config.map([\n      {route: ['', 'dashboard'], name: 'dashboard', moduleId: 'scientist/dashboard', nav: true, title: 'Visitor Dashboard'},\n      {route: 'dashboard/project/:projectid/', name: 'projectdetail', moduleId: 'scientist/dashboarddetail'},\n      {route: 'dashboard/dataset/:datasetid/', name: 'datasetdetail', moduleId: 'scientist/dashboarddetail'},\n      {route: 'repositorytovf', name: 'repositorytovf', moduleId: 'scientist/repositorytovf', nav: true, title: 'Upload to Virtual Folder'},\n    ]);\n    this.router = router;\n  }\n\n  login() {\n    //window.location=\"login.html?next\"+window.location.pathname;\n  }\n\n}\n","//Configure Bluebird Promises not to throw warnings about aurelia empty promises\nPromise.config({\n  warnings: {\n    wForgottenReturn: false\n  }\n});\n\nexport function configure(aurelia) {\n  aurelia.use\n    .standardConfiguration()\n    .feature('resources');\n  aurelia.start().then(() => aurelia.setRoot('repositoryapp'));\n}\n","export class Staffapp {\n\n  configureRouter(config, router) {\n    config.title = 'West-Life Repository Router';\n    config.map([\n      {route: ['', 'dashboard'], name: 'dashboard', moduleId: 'staff/repositorystaff', nav: true, title: 'Visitor Experiment Dashboard'},\n      {route: 'dataupload', name: 'dataupload', moduleId: 'staff/dataupload', nav: true, title: 'Visitor Dataset Upload'}\n    ]);\n    this.router = router;\n\n  }\n\n}\n","export function configure(aurelia) {\n  aurelia.use\n    .standardConfiguration()\n    .feature('resources');\n  aurelia.start().then(() => aurelia.setRoot('staffapp'));\n}\n","import {HttpClient} from 'aurelia-fetch-client';\n\n/* Provides methods to return promise of data from REST Project api*/\nexport class Ariaapi {\n  static inject = [HttpClient];\n\n  constructor(httpclient) {\n    this.httpclient=httpclient;\n    this.httpclient.configure(config => {\n      config\n        .rejectErrorResponses()\n        .withBaseUrl('https://www.structuralbiology.eu/')\n        .withDefaults({\n          credentials: 'same-origin',\n          headers: {\n            'Accept': 'application/json',\n            'X-Requested-With': 'Fetch'\n          }\n        })\n    });\n    //needs SSO credentials\n    this.proposallisturl = \"/ws/oauth/proposallist\";\n    this.proposalurl = \"/ws/oauth/proposal\";\n  }\n\n  getProposallist() {\n    //if the projects is already fetched - returns it, otherwise fetch\n   return this.httpclient.fetch(this.proposallisturl)\n        .then(response => response.json())\n        .then(data => {\n          this.proposallist= data\n          return data\n        })\n        .catch(error => {\n          console.log(error);\n        });\n  }\n\n  getProposal() {\n      return this.httpclient.fetch(this.proposalurl)\n        .then(response => response.json())\n        .then(data => {\n          this.proposal=data;\n          return data;\n        })\n        .catch(error => {\n          console.log(error);\n        });\n  }\n}\n","import {ProjectApi} from '../components/projectapi';\n\nexport class Datasettable {\n  static inject = [ProjectApi];\n\n  constructor(pa) {\n    this.pa=pa;\n    this.alldatasets = [];\n    this.showDatasets =true;\n  }\n\n  attached() {\n    this.pa.getDatasets().then(data => {\n      this.alldatasets = data;\n    });\n  }\n\n}\n","/**\n * Created by Tomas Kulhanek on 2/17/17.\n */\n\nimport * as CodeMirror from \"codemirror\";\nimport \"codemirror/mode/clike/clike\";\nimport \"codemirror/mode/htmlmixed/htmlmixed\";\nimport \"codemirror/mode/javascript/javascript\";\n\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {HttpClient} from 'aurelia-fetch-client';\nimport {Editfile} from './messages';\nimport {bindable} from 'aurelia-framework';\n\n\n//import $ from 'jquery';\n\n\nexport class Fileeditor {\n  static inject = [EventAggregator, HttpClient];\n  @bindable pid;\n\n  constructor(ea,httpclient) {\n\n    this.ea = ea;\n    this.client = httpclient;\n    this.ea.subscribe(Editfile, msg => this.selectFile(msg.file));\n    this.isimage=false;\n    this.filename=\"\";\n    this.showtable=false;\n\n  }\n\n  attached() {\n    console.log(\"Fileeditor.attached()1\");\n    this.codemirror = CodeMirror.fromTextArea(this.cmTextarea, {\n      lineNumbers: true,\n      mode: \"text/x-less\",\n      lineWrapping: true\n    });\n    this.codemirror.refresh();\n    //sample data ofr table\n    this.data=[[\"no data file parsed\",0],[1,1],[1,1]];\n\n    //handsontable needs to be inlcuded in <script ...> of index.html page\n    this.ht2 = new Handsontable (this.filetable, {\n      data: this.data,\n      rowHeaders: true,\n      colHeaders: true,\n      autoColumnSize: {\n        samplingRatio: 23\n      },\n      manualColumnResize: true\n    });\n    console.log(this.ht2);\n  }\n\n  selectFile(file) {\n    let that =this\n\n      this.imageurl = file.webdavurl;\n      //visualizeimg is set & image extension is detected\n      //console.log(\"fileeditor.selectfile() visualizeimg: isimage:\")\n      //console.log(localStorage.getItem(\"visualizeimg\"));\n      //vfstorage returns string - should convert to boolean\n      this.isimage =\n        ((file.name.endsWith('.JPG'))||\n          (file.name.endsWith('.jpg'))||\n          (file.name.endsWith('.PNG'))||\n          (file.name.endsWith('.png'))||\n          (file.name.endsWith('.GIF'))||\n          (file.name.endsWith('.gif'))||\n          (file.name.endsWith('.BMP'))||\n          (file.name.endsWith('.bmp'))||\n          (file.name.endsWith('.SVG'))||\n          (file.name.endsWith('.svg')));\n\n      //console.log(\"fileeditor.selectfile() visualizeimg: isimage:\")\n      //console.log(this.isimage);\n\n      /*get first 2 kB of data, if it is supported by web server in Range header */\n      if (!this.isimage)\n\n        this.client.fetch(file.webdavurl, {credentials: 'same-origin',headers:{'Range': 'bytes=0-2047'}})\n          .then(response => {\n            let response2= response.clone();\n            response.blob().then(data2 => {\n              console.log(\"file blob content:\");\n              console.log(data2);\n              let bindata= this.convert(data2);\n//              console.log(bindata);\n//              that.ht2.updateSettings({data:bindata})\n\n            })\n              response2.text().then(data => {\n                that.codemirror.setValue(data);\n                that.codemirror.refresh();\n                that.filename = file.webdavurl;\n              });\n            }\n          ).catch(error => {\n          alert('Error retrieving content from ' + file.webdavurl);\n          console.log(error);\n        });\n\n\n  }\n  //triggered when click on button\n  table() {\n    this.showtable= ! this.showtable;\n  }\n\n  convert(blob) {\n    //convert blob to array of floats\n    let arrayBuffer;\n    let fileReader = new FileReader();\n    let that = this;\n    fileReader.addEventListener(\"loadend\", function() {\n      console.log(\"fileeditor.convert() raw data read:\")\n      console.log(fileReader.result);\n      that.rawdata = new Float32Array(fileReader.result);\n      that.data = []\n      for (let i=0;i<that.rawdata.length;i+=2){\n        that.data.push([that.rawdata[i],that.rawdata[i+1]]);\n      }\n      console.log(that.data);\n      that.ht2.updateSettings({data:that.data,   autoColumnSize: {\n          samplingRatio: 23\n        },\n      });\n      // reader.result contains the contents of blob as a typed array\n    });\n    fileReader.readAsArrayBuffer(blob);\n  }\n}\n","import {Handsontable} from \"handsontable\";\n\nexport class htable {\n  attached(){\n    this.data = [[1,2],[1,3]];\n    this.ht = new Handsontable(this.idtable, {\n      data: this.data,\n      rowHeaders: true,\n      colHeaders: true\n    });\n  }\n}\n","export class Importaria {\n  constructor () {\n   this.client_id = \"asdf\"\n   this.oaservice='https://www.structuralbiology.eu/ws/oauth/';\n   //random int between 1000000, 9999999\n   this.oastate=Math.floor(Math.random() * (9999999 - 1000000) ) + 1000000;\n  }\n\n  attached () {\n    this.ariaurl=this.oaservice+\n      \"authorize?client_id=\"+this.client_id+\"&state=\"+this.oastate;\n  }\n}\n","/**\n * Created by Tomas Kulhanek on 1/9/17.\n */\n\nexport class Webdavresource {\n  constructor(webdavurl){\n    this.webdavurl = webdavurl;\n  }\n}\n\nexport class Editfile {\n  constructor(file){\n    this.file = file;\n  }\n}\n\nexport class Uploaddir {\n  constructor(webdavurl){\n    this.webdavurl = webdavurl;\n  }\n}\n","import {HttpClient} from 'aurelia-fetch-client';\n\n/* Provides methods to return promise of data from REST Project api*/\nexport class ProjectApi {\n  static inject = [HttpClient];\n\n  constructor(httpclient) {\n    this.httpclient=httpclient;\n    this.httpclient.configure(config => {\n      config\n        .rejectErrorResponses()\n        .withBaseUrl('')\n        .withDefaults({\n          credentials: 'same-origin',\n          headers: {\n            'Accept': 'application/json',\n            'X-Requested-With': 'Fetch'\n          }\n        })\n    });\n    //needs SSO credentials\n    let apiurl = \"/restcon\";\n    //test fronted calls test backend uri - which has test authentication - test credentials added\n    if (window.location.pathname.indexOf('repositorytest2')>0) apiurl = \"/restcontest2\";\n    else if (window.location.pathname.indexOf('repositorytest')>0) apiurl = \"/restcontest\";\n    this.projecturl=apiurl+\"/project\";\n    this.dataurl=apiurl+\"/dataset\";\n    this.userinfourl=apiurl+\"/user\";\n    //needs admin/staff credentials\n    this.usersurl=\"/admin/restcon/users\";\n    this.projects=[];\n    this.datasets=[];\n  }\n\n  getProjects() {\n    //if the projects is already fetched - returns it, otherwise fetch\n    if (this.projects.length>0)\n      return new Promise(resolve => resolve(this.projects))\n    else\n      return this.httpclient.fetch(this.projecturl)\n      .then(response => response.json())\n      .then(data => {\n        this.projects= data\n        return data\n      })\n      .catch(error => {\n        console.log(error);\n\n      });\n  }\n\n      /*\n        this.proposalsall = data;\n        this.proposals = this.prop/osalsall.slice(0,3);\n        this.proposalslength= this.proposalsall.length;\n        this.showallbutton = this.proposalsall.length > 3;\n        this.showmorebutton = true;\n\n      })*/\n    //not yet implemented on backend\n  getDatasets() {\n    if (this.datasets.length>0)\n      return new Promise(resolve => resolve(this.datasets))\n    else\n    return this.httpclient.fetch(this.dataurl)\n      .then(response => response.json())\n      .then(data => {\n        this.datasets=data;\n        return data;\n      })\n      .catch(error => {\n        console.log(error);\n      });\n\n  }\n\n  /* getting list of users - available for staff */\n  getUsers() {\n    return this.httpclient.fetch(this.usersurl)\n      .then(response => response.json())\n      .then(data => {\n        return data;\n      })\n      .catch(error => {\n        console.log('getUsers() returns error:');\n        console.log(error);\n        //alert(\"Sorry, error:\"+error.statusCode+\" \"+error.message);\n      });\n  }\n\n  getUserInfo() {\n      return this.httpclient.fetch(this.userinfourl)\n        .then(response => response.json())\n        .then(data => {\n          return data;\n        })\n        .catch(error => {\n          console.log('getUserInfo() returns error:');\n          //console.log(error);\n          throw error;\n          //          alert(\"Sorry, error:\"+error.statusCode+\" \"+error.message);\n        });\n    }\n}\n","import {Webdavresource} from \"../components/messages\";\nimport {ProjectApi} from './projectapi';\n\nexport class Projecttable {\n  static inject = [ProjectApi];\n\n  constructor(pa) {\n    this.pa=pa;\n    this.projects = [];\n    this.showProposals=true;\n  }\n\n  attached() {\n    console.log(\"projecttableattached()\")\n    this.pa.getProjects().then(data => {\n      this.projects = data;\n    });\n  }\n}\n","export class Searchbydate {\n\n}\n","import {ProjectApi} from './projectapi';\n\nexport class Userinfo {\n  static inject = [ProjectApi];\n\n  constructor(projectapi) {\n    this.pa = projectapi;\n    this.showuserinfo=false;\n  }\n\n  attached(){\n    console.log(\"Userinfo atached()\")\n    //console.log(this.pa);\n    this.pa.getUserInfo().then(data => {\n        console.log(data);\n        this.userinfo=data;\n        this.showuserinfo=true;\n      })\n      .catch(error => {\n        console.log(\"no user info, disable showing it\")\n        this.showuserinfo=false;\n      })\n  }\n}\n","import {HttpClient} from 'aurelia-fetch-client';\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {Editfile,Webdavresource} from './messages';\n\nexport class Webdavfilepanel {\n  static inject = [EventAggregator,HttpClient];\n\n  constructor(ea,httpclient) {\n    //even aggregator to listen for webdav resource to be presented/updated in panel\n    this.ea =ea;\n    this.ea.subscribe(Webdavresource,msg =>this.setwebdav(msg.webdavurl))\n    //http client to perform WEBDAV queries\n    this.httpclient = httpclient;\n    this.httpclient.configure(config => {\n      config\n        .rejectErrorResponses()\n        .withBaseUrl('')\n        .withDefaults({\n          credentials: 'same-origin',\n          headers: {\n            'Accept': 'application/json',\n            'X-Requested-With': 'Fetch'\n          }\n        })\n    });\n    this.webdavpath = '/files/XufWqKau/';\n    //hold depth of directory structure if cd into them\n    this.dirs=[];\n  }\n\n  setwebdav(webdavurl) {\n    this.webdavpath = webdavurl;\n    //query the directory content\n    this.httpclient.fetch(this.webdavpath, {\n      method: 'PROPFIND',\n      headers: {'Depth': '1'}\n    }).then(response => response.text())\n      .then(str => (new window.DOMParser()).parseFromString(str, \"text/xml\"))\n      .then(data => {\n        //parse structure https://stackoverflow.com/questions/17604071/parse-xml-using-javascript\n        this.files = [];\n        let filesDOM = data.getElementsByTagName(\"D:response\");\n        for (let fileitem of filesDOM) {\n          let filename = this.getFirstElementByTagName(fileitem, \"D:href\");\n          let filedate = this.getFirstElementByTagName(fileitem, \"lp1:creationdate\");\n          let filesize = this.getFirstElementByTagName(fileitem, \"lp1:getcontentlength\");\n          let filetype = this.getFirstElementByTagName(fileitem, \"D:getcontenttype\");\n          if (filename != this.webdavpath) //do not include current dir\n          {\n            let item = {};\n            item.name = filename.replace(this.webdavpath, '')\n            item.date = filedate;\n            item.nicedate = this.formatdate(new Date(filedate));\n            item.isdir= filetype == 'httpd/unix-directory';\n            item.size = filetype == 'httpd/unix-directory' ? 'DIR' : filesize;\n            //convert to 4GB or 30MB or 20kB or 100b\n            item.nicesize = item.isdir ? item.size: ~~(item.size / 1000000000) > 0 ? ~~(item.size / 1000000000) + \"GB\" : (~~(item.size / 1000000) > 0 ? ~~(item.size / 1000000) + \"MB\" : (~~(item.size / 1000) > 0 ? ~~(item.size / 1000) + \"kB\" : item.size + \" b\"));\n            item.type = filetype;\n            item.webdavurl=this.webdavpath+item.name;\n            //directory first, files after that\n            if (item.isdir) this.files.unshift(item);\n            else this.files.push(item);\n          }\n\n        }\n        //adds first row with '..' to cd to parent directory\n        if (this.dirs.length>0) this.files.unshift({name:'..',isdir:true,size:'DIR',date:''});\n      }).catch(error => {\n      console.log(\"selectDataset() error\");\n      console.log(error);\n    });\n  }\n\n  getFirstElementByTagName(fileitem,tag) {\n    //console.log(tag);\n    let elements =fileitem.getElementsByTagName(tag);\n    //console.log(elements);\n    return elements.length>0?elements[0].textContent:'';\n  }\n\n  selectFile(file){\n    //file.webdavurl = this.webdavpath+file.name;\n    if (file.isdir) {\n      let newdir= '';\n      if (file.name =='..') {\n        newdir = this.dirs.pop();\n      } else {\n        this.dirs.push(this.webdavpath);\n        newdir = this.webdavpath+file.name;\n      }\n      this.setwebdav(newdir);\n    }\n    else  this.ea.publish(new Editfile(file));\n  }\n\n  formatdate(date) {\n      let diff = new Date() - date; // the difference in milliseconds\n\n      if (diff < 1000) { // less than 1 second\n        return 'right now';\n      }\n\n      let sec = Math.floor(diff / 1000); // convert diff to seconds\n\n      if (sec < 60) {\n        return sec + ' sec. ago';\n      }\n\n      let min = Math.floor(diff / 60000); // convert diff to minutes\n      if (min < 60) {\n        return min + ' min. ago';\n      }\n\n      // format the date\n      // add leading zeroes to single-digit day/month/hours/minutes\n      let d = date;\n      d = [\n        '0' + d.getDate(),\n        '0' + (d.getMonth() + 1),\n        '' + d.getFullYear(),\n        '0' + d.getHours(),\n        '0' + d.getMinutes()\n      ].map(component => component.slice(-2)); // take last 2 digits of every component\n\n      // join the components into date\n      return d.slice(0, 3).join('.') + ' ' + d.slice(3).join(':');\n    }\n}\n","import {bindable} from 'aurelia-framework';\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {Uploaddir} from '../components/messages';\n\nexport class Pickerclient {\n  static inject = [EventAggregator];\n  @bindable mode;\n\n  constructor(ea) {\n    this.ea=ea;\n    this.href=\"https://portal.west-life.eu/virtualfolder/filepickercomponent.html\";\n    this.href2=\"https://portal.west-life.eu/virtualfolder/uploaddirpickercomponent.html\";\n    this.vfurl=\"\";\n    //receives message from popup window, fills target element with the data received\n    let th2= this\n    this.receiveMessage = e => {\n      console.log(\"received event\");\n      console.log(e);\n      th2.vfurl=e.data;\n      console.log(\"publishing event\");\n      th2.ea.publish(new Uploaddir(th2.vfurl))\n    }\n    console.log(\"Pickerclient()\");\n    console.log(this.mode)\n  }\n\n  attached() {\n    //registers itself to receive message from popup window\n    window.addEventListener(\"message\", this.receiveMessage);\n    console.log(\"Pickerclient attached()\");\n    console.log(this.mode);\n    this.filepicker = (this.mode === \"file\")\n  }\n\n  detached() {\n    window.removeEventListener(\"message\", this.receiveMessage)\n  }\n\n//opens popup window in defined location, sets the target element id.\n  openfilewindow() {\n    this.popup=window.open(this.href, 'newwindow', 'width=640, height=480');\n  }\n  opendirwindow() {\n    this.popup=window.open(this.href2, 'newwindow', 'width=640, height=480');\n  }\n}\n","import {bindable} from 'aurelia-framework';\n/** Icopy - <icopy href=\"link-reference\"></icopy>\n * element to create a link icon which on click will copy the url into the clipboard\n * using the browser capability document.execCommand(\"copy\")\n */\n\nexport class Icopy {\n  @bindable href;\n\n  attached() {\n    //set value of referenced input\n    // href is relative - thus adding protocol and hostname, port\n    let port = (window.location.port == \"\" || window.location.port==\"80\" || window.location.port == \"443\")? \"\" :\":\"+window.location.port;\n    this.hrefid.value = window.location.protocol+ '//'+window.location.hostname+port+this.href;\n  }\n\n  copyclipboard() {\n    let inputElement = this.hrefid;\n    inputElement.select();\n    document.execCommand(\"copy\");\n    console.log(inputElement.value);\n    alert(\"Copied the url to clipboard: \" + inputElement.value);\n  }\n}\n","export function configure(config) {\n  //config.globalResources([]);\n  config.globalResources([\n    './irep.html',\n    './irepdemo.html',\n    './iadmin.html',\n    './istaff.html',\n    './ifile.html',\n    './ilink.html',\n    './icopy',\n    './ifolder.html',\n    './idata.html',\n    './iproject.html',\n    './itable.html'\n  ]);\n\n}\n","\n/* Dashboard receives list of projects and list of datasets, in case the project or dataset is selected either by click or within url it is filtered */\nexport class Dashboard {\n\n}\n","import {Webdavresource} from \"../components/messages\";\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {ProjectApi} from '../components/projectapi';\n\n/* Dashboarddetails shows details of projects/datasets */\nexport class Dashboarddetail {\n  static inject = [EventAggregator,ProjectApi];\n\n  constructor(ea,pa) {\n    this.ea = ea;\n    this.pa=pa;\n\n    this.projects = [];\n\n    this.files=[];\n    this.datasets = [];\n    this.alldatasets = [];\n    this.showProposals=true;\n    this.showDatasets=true;\n    this.dataseturl=\"\";\n    this.selectedProjectId=0;\n    this.selectedDatasetId=0;\n    this.selectedProject={};\n  }\n\n  /* it is triggered in first click on project - url is generated\n  * or when url is submitted directly to browser */\n  activate(params, routeConfig, navigationInstruction){\n    console.log(\"Visitingscientist activate()\")\n    if (params && params.projectid) {\n      this.filterSelectedProposal(params.projectid);\n    }\n    if (params && params.datasetid) {\n      this.filterSelectedDataset(params.datasetid);\n    }\n  }\n\n  /* triggered when the view is shown to user - it requests projects and dataset\n  * available for user from REST api*/\n  attached() {\n    console.log(\"Dashboard.attached(): pa:\")\n    console.log(this.pa);\n    this.pa.getProjects().then(data => {\n          this.projects = data;//this.proposalsall.slice(0,3);\n          if (this.selectedProjectId>0) {this.filterProject()}\n      });\n    this.pa.getDatasets().then(data => {\n          this.alldatasets = data;       \n          if (this.selectedDatasetId>0) {this.filterMyDataset()} //triggered when accessed by url dashboard/dataset/1\n          else \n          if (this.selectedProjectId>0) {this.filterDataset()}  //triggered when accessed by url dashboard/project/1\n          //  this.datasets = this.alldatasets.filter(filtereditem => filtereditem.projectId == this.selectedProjectId);\n    });\n  }\n\n  //triggered when a project is clicked -\n  // if the same project is selected activate() is not launched - enough to hide all other projects\n  selectProposal(id) {\n    this.showProposals=false;\n    this.showDatasets=true;\n    return true;\n  }\n\n  /* this is used when new project proposal is selected - it filters project by id and datasets by id*/\n  filterSelectedProposal(id) {\n    //this.selectedProposal=item;\n    this.selectedProjectId=id;\n    this.filterProject();\n    this.filterDataset();\n  }\n\n  filterSelectedDataset(id) {\n    //this.selectedProposal=item;\n    this.selectedDatasetId=id;\n    //this.filterMyProject();\n    this.filterMyDataset();\n  }\n  \n  //expects that selectedDatasetId contains dataset which should be viewed, based on it it selects projectid\n  //filters project which is owning the dataset and publish webdavresource event with dataset webdavurl\n  filterMyDataset(){\n    //get the selected dataset\n    console.log(\"filterMyDataset()\");\n    console.log(this.alldatasets);\n    let mydataset= this.alldatasets.filter(i=> i.id == this.selectedDatasetId);\n    console.log(mydataset);\n    if (mydataset.length>0){\n      //get project related to dataset\n      this.selectedProjectId=mydataset[0].projectId;\n      console.log(this.selectedProjectId);\n      //filter datasets of the project\n      this.datasets=this.alldatasets.filter(i => i.projectId == this.selectedProjectId);\n      console.log(\"datasets:\");\n      console.log(this.datasets);\n      this.showProposals=false;\n      this.filterProject();\n      this.selectDataset(mydataset[0]);\n    }\n  }\n\n  /* helper class called from filterSelecterProposal - or when attached() so activate() call before didn't have\n  * the projects and datasets sets from REST api*/\n  filterProject(){\n    console.log(\"filterProject()\");\n    console.log(this.projects);\n    if (this.projects.length>0) {\n      this.selectedProject = this.projects.filter(i => i.id == this.selectedProjectId)[0];\n      this.showProposals = false;\n    }\n    console.log(this.selectedProject.summary);\n  }\n\n  //filters dataset based on selectedProjectId\n  filterDataset(){\n    this.datasets = this.alldatasets.filter(filtereditem => filtereditem.projectId === this.selectedProjectId);\n    console.log(this.datasets);\n  }\n\n  //deselect project proposal, shows all proposals and datasets\n  deselectProposal() {\n    //this.selectedProposal=item;\n    this.datasets = this.alldatasets;\n    this.showProposals = true;\n    this.showDatasets = true;\n    //return true; //continues to process <a href>\n  }\n\n  //shows only one dataset and publish webdavresource with dataset's url\n  selectDataset(item) {\n    console.log(\"selectDataset\");\n    console.log(item);\n    this.showDatasets=false;\n    this.selectedDataset=item;\n\n    //TODO replace URL by the one obtained from API\n    this.dataseturl=item.webdavurl;\n    this.ea.publish(new Webdavresource(item.webdavurl))\n    return true; //continues to process <a href>\n  }\n\n  deselectDataset() {\n    console.log(\"deselectDataset()\");\n    console.log(this.datasets);\n    console.log(this.alldatasets);\n    this.showDatasets=true;\n  }\n\n  selectFile(file){\n    console.log(\"SelectFile()\");\n    console.log(file);\n  }\n}\n","\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {Uploaddir} from '../components/messages';\n\nexport class Repositorytovf {\n  static inject = [EventAggregator]\n  constructor(ea) {\n    this.ea = ea;\n    console.log(\"Repositorytovf()\");\n\n\n    this.datasets=[{name:\"sucrose.t1\",size:133511,date:\"18/06/2001\"},\n      {name:\"hetcor.2d\",size:525832,date:\"18/06/2001\"},\n      {name:\"menth.c13\",size:132108,date:\"18/06/2001\"},\n      {name:\"noesy.fid\",size:1640436,date:\"18/06/2001\"},\n      {name:\"hsqc.fid\",size:2098448,date:\"18/06/2001\"},\n      {name:\"hmbc.fid\",size:2098448,date:\"18/06/2001\"}];\n    this.filestoupload=[];\n    this.uploadfiles=[];\n    this.uploaddir=\"\";\n    this.selectingfiles=true;\n    this.ea.subscribe(Uploaddir,msg =>this.setuploaddir(msg.webdavurl))\n    this.copyinprogress=false;\n  }\n\n  attached() {\n\n  }\n\n  setuploaddir(url) {\n    console.log(\"setuploaddir()\");\n    console.log(url)\n    this.uploaddir=url;\n    this.selectedUploadDir = true;\n  }\n\n  selectitem(item) {\n    console.log(\"Selected\",item)\n  }\n\n  submitfiles() {\n    this.selectingfiles=false;\n  }\n\n  unsubmitfiles(){\n    this.selectingfiles=true;\n  }\n  deleteitem(item){\n    let indexremoved = this.datasets.indexOf(item);\n    if (indexremoved >=0 ) this.datasets.splice(indexremoved,1);\n  }\n\n  selectItemToUpload(item) {\n    console.log(\"selected item\");\n    console.log(item);\n  }\n\n  removeItemToUpload(item){\n    console.log(\"selected item\");\n    console.log(item);\n    let i = this.filestoupload.indexOf(item);\n    this.filestoupload.splice(i,1);\n  }\n\n  dropped(event){\n    console.log(\"Dropped\")\n    console.log(event.dataTransfer.files);\n    event.stopPropagation();\n    event.preventDefault();\n    this.filestoupload.unshift(...event.dataTransfer.files);\n    return true;\n  }\n\n  dragged(event){\n    return true;//event.preventDefault(); event.dataTransfer.dropEffect = 'copy';\n  }\n\n  appendFiles(event){\n    console.log(\"appendFiles()\");\n    console.log(event.target.files);\n    //this.uploadfiles=event.target.files;\n    this.filestoupload.unshift(...event.target.files);\n    //else this.filestoupload.unshift(event.target.files);\n  }\n\n  appendDir(event) {\n    console.log(\"appendDir\")\n    console.log(event.target.files);\n    this.filestoupload.unshift(...event.target.files)\n  }\n\n  submitUpload(){\n    //TODO fake implementation\n    this.datasets.unshift(...this.filestoupload);\n    this.filestoupload=[];\n  }\n  copy(){\n    this.copyinprogress=true;\n  }\n\n}\n","import {ProjectApi} from '../components/projectapi';\n\nexport class Dataupload {\n  static inject = [ProjectApi];\n  constructor(pa) {\n    this.pa = pa;\n  }\n\n}\n","import {ProjectApi} from '../components/projectapi';\n\nexport class Repositorystaff {\n  static inject = [ProjectApi];\n  constructor(pa) {\n    console.log(\"Repositorystaff()\");\n    this.visitors = [];//\"Tomas Kulhanek\",\"Andrea Giacchieti\",\"Antonio Rosatto\"];\n    this.datasets=[];\n    this.filestoupload=[];\n    this.uploadfiles=[];\n    this.uploaddir=\"\";\n    this.selectinguser=true;\n    this.selectedvisitor=\"\";\n    this.pa = pa;\n  }\n\n  attached() {\n    this.pa.getUsers()\n      .then(data => { this.visitors = data });\n  }\n\n  selectitem(item) {\n    console.log(\"Selected\",item)\n  }\n\n  selectvisitor(visitor) {\n    this.selectinguser=false;\n    this.selectedvisitor = visitor;\n  }\n  deselectvisitor(){\n    this.selectinguser=true;\n  }\n  deleteitem(item){\n    let indexremoved = this.datasets.indexOf(item);\n    if (indexremoved >=0 ) this.datasets.splice(indexremoved,1);\n  }\n  \n    selectItemToUpload(item) {\n    console.log(\"selected item\");\n    console.log(item);\n  }\n\n  removeItemToUpload(item){\n    console.log(\"selected item\");\n    console.log(item);\n  let i = this.filestoupload.indexOf(item);\n    this.filestoupload.splice(i,1);\n  }\n\n  dropped(event){\n    console.log(\"Dropped\");\n    console.log(event.dataTransfer.files);\n    event.stopPropagation();\n    event.preventDefault();\n    this.filestoupload.unshift(...event.dataTransfer.files);\n    return true;\n  }\n\n  dragged(event){\n    return true;//event.preventDefault(); event.dataTransfer.dropEffect = 'copy';\n  }\n\n  appendFiles(event){\n    console.log(\"appendFiles()\");\n    console.log(event.target.files);\n    //this.uploadfiles=event.target.files;\n    this.filestoupload.unshift(...event.target.files);\n    //else this.filestoupload.unshift(event.target.files);\n  }\n\n  appendDir(event) {\n    console.log(\"appendDir\");\n    console.log(event.target.files);\n    this.filestoupload.unshift(...event.target.files)\n  }\n\n  submitUpload(){\n    //TODO fake implementation\n    this.datasets.unshift(...this.filestoupload);\n    this.filestoupload=[];\n  }\n\n}\n"],"sourceRoot":"../src"}